<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>coptionsdialog.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>coptionsdialog.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                          coptionsdialog.cpp  -  description</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Wed Jan 19 2000</font>
00005 <font class="comment">    copyright            : (C) 2000 by The BibleTime Team</font>
00006 <font class="comment">    email                : Info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="preprocessor">#include "coptionsdialog.h"</font>
00019 <font class="preprocessor">#include "cprofile.h"</font>
00020 <font class="preprocessor">#include "ctoolclass.h"</font>
00021 <font class="preprocessor">#include "frontend/displaywindow/cbiblereadwindow.h"</font>
00022 <font class="preprocessor">#include "frontend/displaywindow/ccommentaryreadwindow.h"</font>
00023 <font class="preprocessor">#include "frontend/displaywindow/clexiconreadwindow.h"</font>
00024 <font class="preprocessor">#include "frontend/displaywindow/cbookreadwindow.h"</font>
00025 <font class="preprocessor">#include "frontend/displaywindow/creadwindow.h"</font>
00026 <font class="comment">//#include "presenters/cswordpresenter.h"</font>
00027 <font class="comment">//#include "presenters/cbiblepresenter.h"</font>
00028 <font class="comment">//#include "presenters/ccommentarypresenter.h"</font>
00029 <font class="comment">//#include "presenters/clexiconpresenter.h"</font>
00030 <font class="comment">//#include "presenters/cbookpresenter.h"</font>
00031 <font class="preprocessor">#include "resource.h"</font>
00032 <font class="preprocessor">#include "whatsthisdef.h"</font>
00033 <font class="preprocessor">#include "backend/cswordbackend.h"</font>
00034 <font class="preprocessor">#include "backend/cswordmoduleinfo.h"</font>
00035 <font class="preprocessor">#include "cbtconfig.h"</font>
00036 
00037 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00038 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00039 
00040 <font class="comment">//QT includes</font>
00041 <font class="preprocessor">#include &lt;qhbox.h&gt;</font>
00042 <font class="preprocessor">#include &lt;qlayout.h&gt;</font>
00043 <font class="preprocessor">#include &lt;qvbox.h&gt;</font>
00044 <font class="preprocessor">#include &lt;qdict.h&gt;</font>
00045 <font class="preprocessor">#include &lt;qcheckbox.h&gt;</font>
00046 <font class="preprocessor">#include &lt;qbuttongroup.h&gt;</font>
00047 <font class="preprocessor">#include &lt;qhbuttongroup.h&gt;</font>
00048 <font class="preprocessor">#include &lt;qradiobutton.h&gt;</font>
00049 <font class="preprocessor">#include &lt;qcolor.h&gt;</font>
00050 <font class="preprocessor">#include &lt;qtooltip.h&gt;</font>
00051 <font class="preprocessor">#include &lt;qwhatsthis.h&gt;</font>
00052 <font class="preprocessor">#include &lt;qstringlist.h&gt;</font>
00053 <font class="preprocessor">#include &lt;qinputdialog.h&gt;</font>
00054 <font class="preprocessor">#include &lt;qdir.h&gt;</font>
00055 
00056 
00057 <font class="comment">//KDE includes</font>
00058 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00059 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00060 <font class="preprocessor">#include &lt;kglobal.h&gt;</font>
00061 <font class="preprocessor">#include &lt;kstandarddirs.h&gt;</font>
00062 <font class="preprocessor">#include &lt;kkeydialog.h&gt;</font>
00063 <font class="preprocessor">#include &lt;kiconloader.h&gt;</font>
00064 <font class="preprocessor">#include &lt;ktabctl.h&gt;</font>
00065 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00066 <font class="preprocessor">#include &lt;klistbox.h&gt;</font>
00067 <font class="preprocessor">#include &lt;kkeydialog.h&gt;</font>
00068 <font class="preprocessor">#include &lt;kaction.h&gt;</font>
00069 <font class="preprocessor">#include &lt;kconfigbase.h&gt;</font>
00070 <font class="preprocessor">#include &lt;kconfig.h&gt;</font>
00071 
00072 <font class="comment">//Sword includes</font>
00073 <font class="preprocessor">#include &lt;localemgr.h&gt;</font>
00074 
00075 COptionsDialog::COptionsDialog(QWidget *parent, <font class="keyword">const</font> <font class="keywordtype">char</font> *name, KAccel* accel )
00076     : KDialogBase(IconList, i18n("Optionsdialog"), Ok | Cancel | Apply, Ok, parent, name, true, true, QString::null, QString::null, QString::null) {
00077 
00078     m_settings.keys.application.accel = accel;
00079     setIconListAllVisible(<font class="keyword">true</font>);
00080 
00081     initStartup();      
00082     initFonts();
00083     initColors();   
00084     initProfiles();
00085     initSword();
00086     initAccelerators();
00087 <font class="comment">//  qWarning("ICON THEME: %s",KGlobal::instance()-&gt;iconLoader()-&gt;theme()-&gt;name().latin1());</font>
00088 }
00089 
<a name="l00091"></a><a class="code" href="class_c_options_dialog.html#h1">00091</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h1">COptionsDialog::newDisplayWindowFontSelected</a>(<font class="keyword">const</font> QFont &amp;newFont){
00092     m_settings.fonts.fontMap.replace(m_settings.fonts.usage-&gt;currentText(), newFont);       
00093 }
00094 
<a name="l00096"></a><a class="code" href="class_c_options_dialog.html#h2">00096</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h2">COptionsDialog::newDisplayWindowFontAreaSelected</a>(<font class="keyword">const</font> QString&amp; usage){
00097     m_settings.fonts.fontChooser-&gt;setFont( m_settings.fonts.fontMap[usage] );
00098 }
00099 
<a name="l00101"></a><a class="code" href="class_c_options_dialog.html#h3">00101</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h3">COptionsDialog::slotOk</a>(){
00102     saveAccelerators();
00103     <a class="code" href="class_c_options_dialog.html#b7">saveColors</a>();
00104     <a class="code" href="class_c_options_dialog.html#b8">saveFonts</a>();
00105     <a class="code" href="class_c_options_dialog.html#b11">saveSword</a>();
00106     <a class="code" href="class_c_options_dialog.html#b10">saveStartup</a>();
00107     <a class="code" href="class_c_options_dialog.html#b9">saveProfiles</a>();
00108     
00109     KDialogBase::slotOk();
00110 
00111   emit signalSettingsChanged( );
00112 }
00113 
00114 <font class="comment">/*called if the apply button was clicked*/</font>
<a name="l00115"></a><a class="code" href="class_c_options_dialog.html#h4">00115</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h4">COptionsDialog::slotApply</a>(){
00116     saveAccelerators();
00117     <a class="code" href="class_c_options_dialog.html#b7">saveColors</a>();
00118     <a class="code" href="class_c_options_dialog.html#b8">saveFonts</a>();
00119     <a class="code" href="class_c_options_dialog.html#b11">saveSword</a>();
00120     <a class="code" href="class_c_options_dialog.html#b10">saveStartup</a>();
00121     <a class="code" href="class_c_options_dialog.html#b9">saveProfiles</a>();
00122     
00123     KDialogBase::slotApply();
00124 
00125   emit signalSettingsChanged( );
00126 }
00127 
<a name="l00129"></a><a class="code" href="class_c_options_dialog.html#h0">00129</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h0">COptionsDialog::addNewProfile</a>(){
00130     <font class="keywordtype">bool</font> ok = <font class="keyword">false</font>;
00131     QString name = QInputDialog::getText(i18n(<font class="stringliteral">"Create new profile"</font>), i18n(<font class="stringliteral">"Please enter the name of the new profile"</font>), QLineEdit::Normal, QString::null, &amp;ok);
00132     <font class="keywordflow">if</font> (ok &amp;&amp; !name.isEmpty()) {
00133         m_settings.profiles.mgr.create(name);
00134         m_settings.profiles.profiles-&gt;insertItem(name);             
00135         <font class="keywordflow">if</font> (m_settings.profiles.profiles-&gt;count() == 1)
00136             m_settings.profiles.profiles-&gt;setEnabled(<font class="keyword">true</font>);     
00137     }
00138 }
00139 
<a name="l00141"></a><a class="code" href="class_c_options_dialog.html#h6">00141</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h6">COptionsDialog::deleteProfile</a>(){
00142     <font class="keyword">const</font> QString profile = m_settings.profiles.profiles-&gt;currentText();
00143     m_settings.profiles.mgr.remove(profile);
00144     m_settings.profiles.profiles-&gt;removeItem( m_settings.profiles.profiles-&gt;currentItem() );
00145 }
00146 
<a name="l00148"></a><a class="code" href="class_c_options_dialog.html#h5">00148</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h5">COptionsDialog::renameProfile</a>(){
00149     <font class="keywordtype">bool</font> ok = <font class="keyword">false</font>;
00150     <font class="keyword">const</font> QString currentProfile = m_settings.profiles.profiles-&gt;currentText(); 
00151     <a class="code" href="class_c_profile.html">CProfile</a>* profile = m_settings.profiles.mgr.profile(currentProfile);
00152     <font class="keywordflow">if</font> (!profile)
00153         <font class="keywordflow">return</font>;
00154     <font class="keyword">const</font> QString newName = QInputDialog::getText(i18n(<font class="stringliteral">"Rename profile"</font>), i18n(<font class="stringliteral">"Please enter the new name of the profile"</font>), QLineEdit::Normal, profile-&gt;<a class="code" href="class_c_profile.html#a5">name</a>(), &amp;ok);
00155     <font class="keywordflow">if</font> (ok &amp;&amp; !newName.isEmpty()) {
00156         profile-&gt;<a class="code" href="class_c_profile.html#a8">setName</a>(newName);
00157         m_settings.profiles.profiles-&gt;changeItem(newName, m_settings.profiles.profiles-&gt;currentItem());
00158     }   
00159 }
00160 
<a name="l00162"></a><a class="code" href="class_c_options_dialog.html#a1">00162</a> <font class="keyword">const</font> <font class="keywordtype">bool</font> <a class="code" href="class_c_options_dialog.html#a1">COptionsDialog::showPart</a>(  COptionsDialog::Parts ID ){
00163     <font class="keywordtype">bool</font> ret = <font class="keyword">false</font>;
00164     <font class="keywordflow">switch</font> (ID) {
00165         <font class="keywordflow">case</font> COptionsDialog::ViewProfiles:
00166             <font class="keywordflow">if</font>(showPage(pageIndex(
00167                     m_settings.profiles.profiles-&gt;parentWidget()) ))
00168                 ret = <font class="keyword">true</font>;
00169             <font class="keywordflow">break</font>;
00170         <font class="keywordflow">default</font>:
00171             <font class="keywordflow">break</font>;
00172     }
00173     <font class="keywordflow">return</font> ret;
00174 }
00175 
<a name="l00177"></a><a class="code" href="class_c_options_dialog.html#b5">00177</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b5">COptionsDialog::initStartup</a>(){
00178     QFrame* page = addPage(i18n(<font class="stringliteral">"Startup"</font>), QString::null, OD_ICON_GENERAL);
00179     QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(page,5);
00180     {<font class="comment">//daily tips</font>
00181         m_settings.startup.showTips = <font class="keyword">new</font> QCheckBox(page);
00182         m_settings.startup.showTips-&gt;setText(i18n(<font class="stringliteral">"Show tip of the day"</font>));
00183         QToolTip::add(m_settings.startup.showTips, TT_OD_GENERAL_DAILY_TIP);    
00184         QWhatsThis::add(m_settings.startup.showTips, WT_OD_GENERAL_DAILY_TIP);
00185         
00186         m_settings.startup.showTips-&gt;setChecked( CBTConfig::get(CBTConfig::tips) );
00187     }
00188     layout-&gt;addWidget(m_settings.startup.showTips);
00189     
00190     { <font class="comment">//startup logo</font>
00191         m_settings.startup.showLogo = <font class="keyword">new</font> QCheckBox(page);
00192         m_settings.startup.showLogo-&gt;setText(i18n(<font class="stringliteral">"Show startuplogo"</font>));
00193         QWhatsThis::add(m_settings.startup.showLogo, WT_OD_GENERAL_SHOW_STARTUPLOGO);
00194         QToolTip::add(m_settings.startup.showLogo, TT_OD_GENERAL_SHOW_STARTUPLOGO);     
00195         
00196         m_settings.startup.showLogo-&gt;setChecked(CBTConfig::get(CBTConfig::logo));           
00197     }       
00198     layout-&gt;addWidget(m_settings.startup.showLogo);
00199     { <font class="comment">//workspace</font>
00200         m_settings.startup.restoreWorkspace = <font class="keyword">new</font> QCheckBox(page);
00201         m_settings.startup.restoreWorkspace-&gt;setText(i18n(<font class="stringliteral">"Restore windows in workspace area"</font>));
00202         QToolTip::add(m_settings.startup.restoreWorkspace, TT_OD_GENERAL_RESTORE_WORKSPACE);        
00203         QWhatsThis::add(m_settings.startup.restoreWorkspace, WT_OD_GENERAL_RESTORE_WORKSPACE);
00204         
00205         m_settings.startup.restoreWorkspace-&gt;setChecked(CBTConfig::get(CBTConfig::restoreWorkspace));           
00206     }       
00207     layout-&gt;addWidget(m_settings.startup.restoreWorkspace);         
00208     
00209     layout-&gt;addStretch(4);
00210 }
00211 
<a name="l00213"></a><a class="code" href="class_c_options_dialog.html#b2">00213</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b2">COptionsDialog::initFonts</a>(){
00214     QFrame* page = addPage(i18n(<font class="stringliteral">"Fonts"</font>), QString::null, OD_ICON_FONTS);
00215     QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(page,5);
00216     
00217 
00218     layout-&gt;addWidget( CToolClass::explanationLabel(page, i18n(<font class="stringliteral">"Choose fonts"</font>), i18n(<font class="stringliteral">"The fonts you can choose here are used in the display windows. Use the drop-down box below to choose the area of application. Then select a font for it. Make sure the charset \"iso10646-1\" is available for the selected Unicode font.!"</font>)) );
00219   layout-&gt;addSpacing(5);
00220                     
00221     m_settings.fonts.usage = <font class="keyword">new</font> QComboBox(page);       
00222     QToolTip::add(m_settings.fonts.usage, TT_OD_FONTS_TYPE_CHOOSER);        
00223     QWhatsThis::add(m_settings.fonts.usage, WT_OD_FONTS_TYPE_CHOOSER);  
00224     layout-&gt;addWidget(m_settings.fonts.usage);
00225         
00226     m_settings.fonts.fontMap.insert(i18n(<font class="stringliteral">"Standard"</font>), CBTConfig::get(CBTConfig::standard));
00227     m_settings.fonts.fontMap.insert(i18n(<font class="stringliteral">"Unicode"</font>),  CBTConfig::get(CBTConfig::unicode));
00228 
00229     <font class="keywordflow">for</font>( QMap&lt;QString, QFont&gt;::Iterator it = m_settings.fonts.fontMap.begin(); it != m_settings.fonts.fontMap.end(); ++it )
00230         m_settings.fonts.usage-&gt;insertItem(it.key());
00231         
00232     m_settings.fonts.fontChooser = <font class="keyword">new</font> KFontChooser(page, <font class="stringliteral">"fonts"</font>, <font class="keyword">false</font>, QStringList(), <font class="keyword">true</font>, 5);
00233     m_settings.fonts.fontChooser-&gt;setSampleText(i18n(<font class="stringliteral">"The quick brown fox jumps over the lazy dog"</font>));
00234     layout-&gt;addWidget(m_settings.fonts.fontChooser);
00235         
00236   connect(m_settings.fonts.fontChooser, SIGNAL(fontSelected(<font class="keyword">const</font> QFont&amp;)), SLOT(<a class="code" href="class_c_options_dialog.html#h1">newDisplayWindowFontSelected</a>(<font class="keyword">const</font> QFont&amp;)));
00237   connect(m_settings.fonts.usage, SIGNAL(activated(<font class="keyword">const</font> QString&amp;)), SLOT(<a class="code" href="class_c_options_dialog.html#h2">newDisplayWindowFontAreaSelected</a>(<font class="keyword">const</font> QString&amp;)));
00238     QWhatsThis::add(m_settings.fonts.fontChooser, WT_OD_FONTS_CHOOSER);
00239             
00240     m_settings.fonts.fontChooser-&gt;setFont( m_settings.fonts.fontMap[m_settings.fonts.usage-&gt;currentText()] );
00241     m_settings.fonts.fontChooser-&gt;setMinimumSize(m_settings.fonts.fontChooser-&gt;sizeHint());     
00242 }
00243 
<a name="l00245"></a><a class="code" href="class_c_options_dialog.html#b4">00245</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b4">COptionsDialog::initColors</a>(){
00246     QFrame* page = addPage(i18n(<font class="stringliteral">"Colors"</font>), QString::null, OD_ICON_COLORS);
00247 <font class="comment">//  QVBoxLayout* layout = new QVBoxLayout(page);</font>
00248     QGridLayout* gridLayout = <font class="keyword">new</font> QGridLayout(page,5,5,5,5);
00249   gridLayout-&gt;setResizeMode(QLayout::Minimum);
00250         
00251   gridLayout-&gt;addMultiCellWidget(
00252     CToolClass::explanationLabel(page,
00253         i18n(<font class="stringliteral">"Choose colors"</font>),
00254         i18n(<font class="stringliteral">"Choose the colors to change the look of the display windows to your own preferences. Some options like \"Words of Jesus\" do only apply to texts which support this special feature."</font>)
00255     ),      
00256     0,0,0,-1
00257   );
00258         
00259     m_settings.colors.text = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::textColor), page);      
00260     QLabel* label = <font class="keyword">new</font> QLabel(m_settings.colors.text, i18n(<font class="stringliteral">"Text"</font>), page);         
00261     gridLayout-&gt;addWidget(label,1,0);
00262     gridLayout-&gt;addWidget(m_settings.colors.text,1,1);
00263     
00264     m_settings.colors.background = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::backgroundColor), page);          
00265     label = <font class="keyword">new</font> QLabel(m_settings.colors.background, i18n(<font class="stringliteral">"Background"</font>), page);     
00266     gridLayout-&gt;addWidget(label,1,3);
00267     gridLayout-&gt;addWidget(m_settings.colors.background,1,4);
00268         
00269     m_settings.colors.highlightedVerse = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::highlightedVerseColor), page);
00270     label = <font class="keyword">new</font> QLabel(m_settings.colors.highlightedVerse, i18n(<font class="stringliteral">"Highlighted verse"</font>), page);
00271     gridLayout-&gt;addWidget(label,2,0);
00272     gridLayout-&gt;addWidget(m_settings.colors.highlightedVerse,2,1);
00273 
00274     m_settings.colors.swordrefs = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::swordRefColor), page);
00275     label = <font class="keyword">new</font> QLabel(m_settings.colors.swordrefs,i18n(<font class="stringliteral">"Hyperlinks"</font>), page);
00276     gridLayout-&gt;addWidget(label,2,3);
00277     gridLayout-&gt;addWidget(m_settings.colors.swordrefs,2,4);
00278 
00279     m_settings.colors.footnotes = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::footnotesColor), page);        
00280     label = <font class="keyword">new</font> QLabel(m_settings.colors.footnotes,i18n(<font class="stringliteral">"Footnotes"</font>), page);            
00281     gridLayout-&gt;addWidget(label,3,0);
00282     gridLayout-&gt;addWidget(m_settings.colors.footnotes,3,1);
00283 
00284     m_settings.colors.strongs = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::strongsColor), page);        
00285     label = <font class="keyword">new</font> QLabel(m_settings.colors.strongs, i18n(<font class="stringliteral">"Strong's numbers"</font>), page);          
00286     gridLayout-&gt;addWidget(label,3,3);
00287     gridLayout-&gt;addWidget(m_settings.colors.strongs,3,4);
00288 
00289     m_settings.colors.morph = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::morphsColor), page);       
00290     label = <font class="keyword">new</font> QLabel(m_settings.colors.morph, i18n(<font class="stringliteral">"Morphologic tags"</font>), page);            
00291     gridLayout-&gt;addWidget(label,4,0);
00292     gridLayout-&gt;addWidget(m_settings.colors.morph,4,1);
00293 
00294     m_settings.colors.jesuswords = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::jesuswordsColor), page);      
00295     label = <font class="keyword">new</font> QLabel(m_settings.colors.jesuswords, i18n(<font class="stringliteral">"Words of Jesus"</font>), page);         
00296     gridLayout-&gt;addWidget(label,4,3);
00297     gridLayout-&gt;addWidget(m_settings.colors.jesuswords,4,4);
00298     
00299     gridLayout-&gt;setRowStretch(5, 5);
00300     gridLayout-&gt;addColSpacing(3, 5);
00301 }
00302 
<a name="l00304"></a><a class="code" href="class_c_options_dialog.html#b3">00304</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b3">COptionsDialog::initProfiles</a>(){
00305     QFrame* page = addPage(i18n(<font class="stringliteral">"Profiles"</font>),QString::null, OD_ICON_PROFILES);
00306     QGridLayout* gridLayout = <font class="keyword">new</font> QGridLayout(page, 3,3,5,5);
00307 
00308     gridLayout-&gt;addMultiCellWidget(
00309         CToolClass::explanationLabel(page,
00310             i18n(<font class="stringliteral">"Manage your profiles"</font>),
00311             i18n(<font class="stringliteral">"Profiles define the appereance of the work area, \</font>
00312 <font class="stringliteral">for example which windows are open and which texts should displayed in these windows. \</font>
00313 <font class="stringliteral">Don't forget that new profiles only work after you've saved something in them."</font>)
00314         ),
00315         0,0,0,-1
00316     );
00317     
00318     m_settings.profiles.profiles = <font class="keyword">new</font> QListBox(page);                  
00319     gridLayout-&gt;addMultiCellWidget(m_settings.profiles.profiles, 1,1,0,-1);
00320     gridLayout-&gt;setRowStretch(1,10);
00321     
00322     m_settings.profiles.createProfile = <font class="keyword">new</font> QPushButton(i18n(<font class="stringliteral">"Create new profile"</font>), page);
00323     connect(m_settings.profiles.createProfile, SIGNAL(clicked()), SLOT(<a class="code" href="class_c_options_dialog.html#h0">addNewProfile</a>()));
00324   gridLayout-&gt;addWidget(m_settings.profiles.createProfile,2,0);
00325         
00326     m_settings.profiles.deleteProfile = <font class="keyword">new</font> QPushButton(i18n(<font class="stringliteral">"Delete selected profile"</font>), page); 
00327     connect(m_settings.profiles.deleteProfile, SIGNAL(clicked()), SLOT(<a class="code" href="class_c_options_dialog.html#h6">deleteProfile</a>()));
00328   gridLayout-&gt;addWidget(m_settings.profiles.deleteProfile,2,1);
00329         
00330     m_settings.profiles.renameProfile = <font class="keyword">new</font> QPushButton(i18n(<font class="stringliteral">"Rename selected profile"</font>), page);     
00331     connect(m_settings.profiles.renameProfile, SIGNAL(clicked()), SLOT(<a class="code" href="class_c_options_dialog.html#h5">renameProfile</a>()));
00332   gridLayout-&gt;addWidget(m_settings.profiles.renameProfile,2,2); 
00333 
00334   <font class="comment">//fill the profile list box</font>
00335     QPtrList&lt;CProfile&gt; profiles = m_settings.profiles.mgr.profiles();
00336     <font class="keywordflow">if</font> (profiles.count()) {
00337         <font class="keywordflow">for</font> (<a class="code" href="class_c_profile.html">CProfile</a>* p = profiles.first(); p; p = profiles.next()) {
00338             m_settings.profiles.profiles-&gt;insertItem(p-&gt;<a class="code" href="class_c_profile.html#a5">name</a>());
00339         }   
00340     }
00341     <font class="keywordflow">else</font> {
00342         m_settings.profiles.profiles-&gt;setEnabled(<font class="keyword">false</font>);
00343     }
00344 }
00345 
<a name="l00347"></a><a class="code" href="class_c_options_dialog.html#b1">00347</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b1">COptionsDialog::initAccelerators</a>(){
00348   QVBox* page = addVBoxPage(i18n(<font class="stringliteral">"Accelerators"</font>),QString::null, OD_ICON_KEY_BINDINGS);
00349 
00350   KTabCtl* tabCtl = <font class="keyword">new</font> KTabCtl(page);
00351 
00352 <font class="comment">// ----- new tab: All display windows ------ //</font>
00353   QFrame* currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00354     currentTab-&gt;setMargin(3);   
00355   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Application wide"</font>));
00356 
00357     CBTConfig::setupAccel( CBTConfig::application, m_settings.keys.application.accel  );
00358 <font class="comment">//  CSwordPresenter::insertKeyboardActions( m_settings.keys.application.accel );    </font>
00359     m_settings.keys.application.accel-&gt;readSettings();      
00360 
00361     m_settings.keys.application.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.application.accel, currentTab, <font class="keyword">false</font> );   
00362     QToolTip::add(m_settings.keys.application.keyChooser, TT_OD_KEYS_CHOOSER);
00363     QWhatsThis::add(m_settings.keys.application.keyChooser, WT_OD_KEYS_CHOOSER);    
00364 
00365 <font class="comment">// ----- new tab: All display windows ------ //</font>
00366     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00367     currentTab-&gt;setMargin(3);   
00368     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"All display windows"</font>));
00369     
00370     m_settings.keys.general.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00371     CBTConfig::setupAccel( CBTConfig::readWindow, m_settings.keys.general.accel  ); 
00372     <a class="code" href="class_c_read_window.html#d0">CReadWindow::insertKeyboardActions</a>( m_settings.keys.general.accel );
00373     m_settings.keys.general.accel-&gt;readSettings();
00374 
00375     m_settings.keys.general.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.general.accel, currentTab );  
00376     QToolTip::add(m_settings.keys.general.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_GENERAL);
00377     QWhatsThis::add(m_settings.keys.general.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_GENERAL);
00378 
00379 <font class="comment">// ----- new tab: Bible windows ------ //</font>
00380     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00381     currentTab-&gt;setMargin(3);   
00382     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Bible windows"</font>));
00383 
00384     m_settings.keys.bible.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00385     CBTConfig::setupAccel( CBTConfig::bibleWindow, m_settings.keys.bible.accel  );  
00386     <a class="code" href="class_c_bible_read_window.html#d0">CBibleReadWindow::insertKeyboardActions</a>( m_settings.keys.bible.accel );
00387     m_settings.keys.bible.accel-&gt;readSettings();
00388 
00389     m_settings.keys.bible.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.bible.accel, currentTab<font class="comment">/*, false*/</font> );   
00390     QToolTip::add(m_settings.keys.bible.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_BIBLE);
00391     QWhatsThis::add(m_settings.keys.bible.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_BIBLE);
00392 
00393 <font class="comment">// ----- new tab: Commentary windows ------ //</font>
00394     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00395     currentTab-&gt;setMargin(3);   
00396     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Commentary windows"</font>));
00397 
00398     m_settings.keys.commentary.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00399     CBTConfig::setupAccel( CBTConfig::commentaryWindow, m_settings.keys.commentary.accel  );    
00400     <a class="code" href="class_c_bible_read_window.html#d0">CCommentaryReadWindow::insertKeyboardActions</a>( m_settings.keys.commentary.accel );       
00401 <font class="comment">//  m_settings.keys.commentary.accel-&gt;setConfigGroup("Lexicon shortcuts");  </font>
00402     m_settings.keys.commentary.accel-&gt;readSettings();   
00403         
00404     m_settings.keys.commentary.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.commentary.accel, currentTab, <font class="keyword">false</font> ); 
00405     QToolTip::add(m_settings.keys.commentary.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_COMMENTARY);
00406     QWhatsThis::add(m_settings.keys.commentary.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_COMMENTARY);
00407 
00408 <font class="comment">// ----- new tab: Lexicon windows ------ //</font>
00409     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00410     currentTab-&gt;setMargin(3);   
00411     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Lexicon windows"</font>));
00412 
00413     m_settings.keys.lexicon.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00414     CBTConfig::setupAccel( CBTConfig::lexiconWindow, m_settings.keys.lexicon.accel  );  
00415     <a class="code" href="class_c_lexicon_read_window.html#d0">CLexiconReadWindow::insertKeyboardActions</a>( m_settings.keys.lexicon.accel );     
00416 <font class="comment">//  m_settings.keys.lexicon.accel-&gt;setConfigGroup("Lexicon shortcuts"); </font>
00417     m_settings.keys.lexicon.accel-&gt;readSettings();      
00418     
00419     m_settings.keys.lexicon.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.lexicon.accel, currentTab, <font class="keyword">false</font> );   
00420     QToolTip::add(m_settings.keys.lexicon.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_LEXICON);
00421     QWhatsThis::add(m_settings.keys.lexicon.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_LEXICON);
00422 
00423     
00424 <font class="comment">// ----- new tab: Book windows ------ //</font>
00425     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00426     currentTab-&gt;setMargin(3);   
00427     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Book windows"</font>));
00428 
00429     m_settings.keys.book.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00430     CBTConfig::setupAccel( CBTConfig::bookWindow, m_settings.keys.book.accel  );    
00431     <a class="code" href="class_c_book_read_window.html#d0">CBookReadWindow::insertKeyboardActions</a>( m_settings.keys.book.accel );       
00432 <font class="comment">//  m_settings.keys.book.accel-&gt;setConfigGroup("Book shortcuts");       </font>
00433     m_settings.keys.book.accel-&gt;readSettings();     
00434     
00435     m_settings.keys.book.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.book.accel, currentTab, <font class="keyword">false</font> ); 
00436     QToolTip::add(m_settings.keys.book.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_LEXICON);
00437     QWhatsThis::add(m_settings.keys.book.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_LEXICON);                        
00438 }
00439 
<a name="l00441"></a><a class="code" href="class_c_options_dialog.html#b0">00441</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b0">COptionsDialog::initSword</a>(){
00442     QVBox* page = addVBoxPage(i18n(<font class="stringliteral">"Sword"</font>),QString::null, OD_ICON_SWORD);
00443   KTabCtl* tabCtl = <font class="keyword">new</font> KTabCtl(page);
00444   QFrame* currentTab = <font class="keyword">new</font> QFrame(tabCtl);
00445   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"General"</font>));
00446 
00447   QGridLayout* gridLayout = <font class="keyword">new</font> QGridLayout(currentTab,7,2,5,5);
00448     gridLayout-&gt;setResizeMode(QLayout::Minimum);
00449     
00450   gridLayout-&gt;addMultiCellWidget(
00451     CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Use key cache for lexicons"</font>),
00452             i18n(<font class="stringliteral">"BibleTime can create a key cache for lexicons, which speeds up opening large lexicon modules a lot. \</font>
00453 <font class="stringliteral">However these files consume some disk space (usually not much), and reside in \</font>
00454 <font class="stringliteral">$KDEHOME/share/apps/bibletime/cache."</font>)),
00455         0,0,0,-1
00456   );
00457     
00458     m_settings.sword.lexiconCache = <font class="keyword">new</font> QCheckBox(currentTab);
00459     m_settings.sword.lexiconCache-&gt;setText(i18n(<font class="stringliteral">"Use key cache for lexicons"</font>));
00460     QToolTip::add(m_settings.sword.lexiconCache, TT_OD_SWORD_USE_LEXICON_CACHE);    
00461     QWhatsThis::add(m_settings.sword.lexiconCache, WT_OD_SWORD_USE_LEXICON_CACHE);
00462         
00463     m_settings.sword.lexiconCache-&gt;setChecked( CBTConfig::get(CBTConfig::lexiconCache) );
00464     gridLayout-&gt;addMultiCellWidget(m_settings.sword.lexiconCache,1,1,0,-1);
00465 
00466   gridLayout-&gt;addMultiCellWidget(
00467     CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Scrolling behaviour"</font>),
00468             i18n(<font class="stringliteral">"The down arrow moves to the &lt;i&gt;next&lt;/i&gt; verse by default. Uncheck this box \</font>
00469 <font class="stringliteral">if you want it to move to the &lt;i&gt;previous&lt;/i&gt; verse."</font>)),
00470         2,2,0,-1
00471   );
00472         
00473     m_settings.sword.useDownArrow = <font class="keyword">new</font> QCheckBox(currentTab);
00474     m_settings.sword.useDownArrow-&gt;setText(i18n(<font class="stringliteral">"Use down arrow to scroll to next verse"</font>));
00475     m_settings.sword.useDownArrow-&gt;setChecked(CBTConfig::get(CBTConfig::scroll));       
00476     QWhatsThis::add(m_settings.sword.useDownArrow, WT_OD_GENERAL_SCROLL_PREVIOUS);
00477     QToolTip::add(m_settings.sword.useDownArrow, TT_OD_GENERAL_SCROLL_PREVIOUS);
00478     gridLayout-&gt;addMultiCellWidget(m_settings.sword.useDownArrow,3,3,0,-1);
00479 
00480   gridLayout-&gt;addMultiCellWidget(
00481     CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Specify a language for biblical booknames"</font>),
00482             i18n(<font class="stringliteral">"Sword has a number of locales available which can be used to internationalize the \</font>
00483 <font class="stringliteral">booknames of the bible. You can specify which locale to choose. If you want to \</font>
00484 <font class="stringliteral">create a new locale, see http://www.crosswire.org/sword/develop for details."</font>)),
00485         4,4,0,-1
00486   );
00487         
00488     m_settings.sword.localeCombo = <font class="keyword">new</font> QComboBox(currentTab);
00489     QLabel* label = <font class="keyword">new</font> QLabel(m_settings.sword.localeCombo, i18n(<font class="stringliteral">"Language for booknames"</font>), currentTab);   
00490     QToolTip::add(m_settings.sword.localeCombo, TT_OD_GENERAL_INTERNATIONAL_BOOKNAMES);             
00491     QWhatsThis::add(m_settings.sword.localeCombo, WT_OD_GENERAL_INTERNATIONAL_BOOKNAMES);       
00492     gridLayout-&gt;addWidget(label, 5,0);
00493     gridLayout-&gt;addWidget(m_settings.sword.localeCombo, 5,1);
00494 
00495     gridLayout-&gt;setRowStretch(6,5); <font class="comment">//eat up remaining space :)</font>
00496                                                 
00497     m_settings.sword.localeCombo-&gt;insertItem( i18n(<font class="stringliteral">"English"</font>) );
00498     list &lt;string&gt; locales = LocaleMgr::systemLocaleMgr.getAvailableLocales();
00499     <font class="keywordflow">for</font> (list &lt;string&gt;::iterator it = locales.begin(); it != locales.end(); it++) {
00500         m_settings.sword.localeCombo-&gt;insertItem( i18n(LocaleMgr::systemLocaleMgr.getLocale((*it).c_str())-&gt;getDescription()) );
00501     }
00502 
00503     <font class="keywordtype">int</font> current_item = -1;
00504     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> test_item = 0; test_item &lt; m_settings.sword.localeCombo-&gt;count(); test_item++) {
00505         SWLocale* locale = LocaleMgr::systemLocaleMgr.getLocale(CBTConfig::get(CBTConfig::language).local8Bit());
00506         <font class="keywordflow">if</font> (locale &amp;&amp; m_settings.sword.localeCombo-&gt;text(test_item).contains(i18n(locale-&gt;getDescription())) )
00507             current_item = test_item;
00508     }
00509     <font class="keywordflow">if</font> (current_item!=-1)
00510         m_settings.sword.localeCombo-&gt;setCurrentItem(current_item);
00511 
00512 
00513 <font class="comment">// ---------- new tab: Default modules -------- //</font>
00514   currentTab = <font class="keyword">new</font> QFrame(tabCtl);
00515   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Default modules"</font>));
00516     gridLayout = <font class="keyword">new</font> QGridLayout(currentTab,9,2, 5,5); <font class="comment">//the last row is for stretching available space</font>
00517     gridLayout-&gt;setResizeMode(QLayout::Minimum);
00518 
00519   gridLayout-&gt;addMultiCellWidget(
00520     CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Default modules"</font>), i18n(<font class="stringliteral">"Default modules are used, when no module is specified. This may happen with references into modules like Bibles or Lexicons."</font>)),
00521     0,0,0,-1 <font class="comment">/*fill the horizontal space*/</font>
00522   );
00523     
00524     m_settings.sword.standardBible = <font class="keyword">new</font> QComboBox(currentTab);
00525   label = <font class="keyword">new</font> QLabel(m_settings.sword.standardBible, i18n(<font class="stringliteral">"Default Bible"</font>), currentTab);
00526   label-&gt;setAutoResize(<font class="keyword">true</font>);
00527     QToolTip::add(m_settings.sword.standardBible, TT_OD_SWORD_STANDARD_BIBLE);  
00528     QWhatsThis::add(m_settings.sword.standardBible, WT_OD_SWORD_STANDARD_BIBLE);        
00529     gridLayout-&gt;addWidget(label,1,0);   
00530     gridLayout-&gt;addWidget(m_settings.sword.standardBible,1,1);
00531         
00532     m_settings.sword.standardCommentary = <font class="keyword">new</font> QComboBox(currentTab);
00533     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardCommentary, i18n(<font class="stringliteral">"Default Commentary"</font>), currentTab);
00534   label-&gt;setAutoResize(<font class="keyword">true</font>);   
00535     QToolTip::add(m_settings.sword.standardCommentary, TT_OD_SWORD_STANDARD_COMMENTARY);    
00536     QWhatsThis::add(m_settings.sword.standardCommentary, WT_OD_SWORD_STANDARD_COMMENTARY);      
00537     gridLayout-&gt;addWidget(label,2,0);
00538     gridLayout-&gt;addWidget(m_settings.sword.standardCommentary,2,1);
00539 
00540 
00541     m_settings.sword.standardLexicon = <font class="keyword">new</font> QComboBox(currentTab);
00542     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardLexicon, i18n(<font class="stringliteral">"Default Lexicon"</font>), currentTab);
00543   label-&gt;setAutoResize(<font class="keyword">true</font>);   
00544     QToolTip::add(m_settings.sword.standardLexicon, TT_OD_SWORD_STANDARD_LEXICON);  
00545     QWhatsThis::add(m_settings.sword.standardLexicon, WT_OD_SWORD_STANDARD_LEXICON);        
00546     gridLayout-&gt;addWidget(label,3,0);   
00547     gridLayout-&gt;addWidget(m_settings.sword.standardLexicon,3,1);    
00548         
00549     m_settings.sword.standardHebrewStrong = <font class="keyword">new</font> QComboBox(currentTab);
00550     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardHebrewStrong, i18n(<font class="stringliteral">"Default Hebrew Strong's Lexicon"</font>), currentTab);
00551   label-&gt;setAutoResize(<font class="keyword">true</font>);       
00552     QToolTip::add(m_settings.sword.standardHebrewStrong, TT_OD_SWORD_STANDARD_HEBREW_STRONG);
00553     QWhatsThis::add(m_settings.sword.standardHebrewStrong, WT_OD_SWORD_STANDARD_HEBREW_STRONG);
00554     gridLayout-&gt;addWidget(label,4,0);
00555     gridLayout-&gt;addWidget(m_settings.sword.standardHebrewStrong,4,1);
00556         
00557     m_settings.sword.standardGreekStrong = <font class="keyword">new</font> QComboBox(currentTab);
00558     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardGreekStrong, i18n(<font class="stringliteral">"Default Greek Strong's Lexicon"</font>), currentTab);
00559   label-&gt;setAutoResize(<font class="keyword">true</font>);       
00560     QToolTip::add(m_settings.sword.standardGreekStrong, TT_OD_SWORD_STANDARD_GREEK_STRONG);     
00561     QWhatsThis::add(m_settings.sword.standardGreekStrong, WT_OD_SWORD_STANDARD_GREEK_STRONG);
00562     gridLayout-&gt;addWidget(label,5,0);
00563     gridLayout-&gt;addWidget(m_settings.sword.standardGreekStrong,5,1);
00564         
00565     m_settings.sword.standardHebrewMorph = <font class="keyword">new</font> QComboBox(currentTab);
00566     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardHebrewMorph, i18n(<font class="stringliteral">"Default Hebrew Morphological Lexicon"</font>), currentTab);
00567     QToolTip::add(m_settings.sword.standardHebrewMorph, TT_OD_SWORD_STANDARD_HEBREW_MORPH);
00568     QWhatsThis::add(m_settings.sword.standardHebrewMorph, WT_OD_SWORD_STANDARD_HEBREW_MORPH);
00569     gridLayout-&gt;addWidget(label,6,0);
00570     gridLayout-&gt;addWidget(m_settings.sword.standardHebrewMorph,6,1);
00571 
00572     m_settings.sword.standardGreekMorph = <font class="keyword">new</font> QComboBox(currentTab);
00573     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardGreekMorph, i18n(<font class="stringliteral">"Default Greek Morphological Lexicon"</font>), currentTab);
00574   label-&gt;setAutoResize(<font class="keyword">true</font>);       
00575     QToolTip::add(m_settings.sword.standardGreekMorph, TT_OD_SWORD_STANDARD_GREEK_MORPH);
00576     QWhatsThis::add(m_settings.sword.standardGreekMorph, WT_OD_SWORD_STANDARD_GREEK_MORPH);
00577     gridLayout-&gt;addWidget(label,7,0);
00578     gridLayout-&gt;addWidget(m_settings.sword.standardGreekMorph,7,1);
00579 
00580     gridLayout-&gt;setRowStretch(8,5);                         
00581         
00582     <font class="comment">//fill the comboboxes with the right modules</font>
00583     ListCSwordModuleInfo&amp; modules = <a class="code" href="class_c_pointers.html#d1">backend</a>()-&gt;<a class="code" href="class_c_sword_backend.html#a2">moduleList</a>();
00584     QString modDescript;
00585   <font class="keywordflow">for</font> ( modules.first(); modules.current(); modules.next() ) {
00586         modDescript = modules.current()-&gt;config(CSwordModuleInfo::Description);
00587         <font class="keywordflow">switch</font> (modules.current()-&gt;type()) {
00588             <font class="keywordflow">case</font> CSwordModuleInfo::Bible:
00589                 m_settings.sword.standardBible-&gt;insertItem(modDescript);
00590                 <font class="keywordflow">break</font>;
00591             <font class="keywordflow">case</font> CSwordModuleInfo::Commentary:
00592                 m_settings.sword.standardCommentary-&gt;insertItem(modDescript);               
00593                 <font class="keywordflow">break</font>;
00594             <font class="keywordflow">case</font> CSwordModuleInfo::Lexicon:
00595             {
00596                 m_settings.sword.standardLexicon-&gt;insertItem(modDescript);
00597                 <font class="keywordflow">if</font> (modules.current()-&gt;has(CSwordModuleInfo::HebrewDef)) {
00598                     m_settings.sword.standardHebrewStrong-&gt;insertItem(modDescript);             
00599                 }
00600                 <font class="keywordflow">if</font> (modules.current()-&gt;has(CSwordModuleInfo::GreekDef)) {
00601                     m_settings.sword.standardGreekStrong-&gt;insertItem(modDescript);              
00602                 }
00603                 <font class="keywordflow">if</font> (modules.current()-&gt;has(CSwordModuleInfo::HebrewParse)) {
00604                     m_settings.sword.standardHebrewMorph-&gt;insertItem(modDescript);              
00605                 }
00606                 <font class="keywordflow">if</font> (modules.current()-&gt;has(CSwordModuleInfo::GreekParse)) {
00607                     m_settings.sword.standardGreekMorph-&gt;insertItem(modDescript);               
00608                 }
00609                 <font class="keywordflow">break</font>;
00610             }               
00611             <font class="keywordflow">default</font>:<font class="comment">//unknown type                  </font>
00612                 <font class="keywordflow">break</font>;
00613         }
00614   }
00615 
00616 <font class="comment">//using two lists and one loop is better than six loops with almost the same code :)</font>
00617     QPtrList&lt;QComboBox&gt; comboList;
00618     comboList.setAutoDelete(<font class="keyword">false</font>);<font class="comment">//don't delete the combos accidentally</font>
00619     comboList.append(m_settings.sword.standardBible);
00620     comboList.append(m_settings.sword.standardCommentary);
00621     comboList.append(m_settings.sword.standardLexicon);
00622     comboList.append(m_settings.sword.standardHebrewStrong);
00623     comboList.append(m_settings.sword.standardGreekStrong);
00624     comboList.append(m_settings.sword.standardHebrewMorph);
00625     comboList.append(m_settings.sword.standardGreekMorph);
00626 
00627     QStringList moduleList;
00628     moduleList
00629         &lt;&lt; CBTConfig::get(CBTConfig::standardBible)
00630         &lt;&lt; CBTConfig::get(CBTConfig::standardCommentary)
00631         &lt;&lt; CBTConfig::get(CBTConfig::standardLexicon)
00632         &lt;&lt; CBTConfig::get(CBTConfig::standardHebrewStrongsLexicon)
00633         &lt;&lt; CBTConfig::get(CBTConfig::standardGreekStrongsLexicon)
00634         &lt;&lt; CBTConfig::get(CBTConfig::standardHebrewMorphLexicon)
00635         &lt;&lt; CBTConfig::get(CBTConfig::standardGreekMorphLexicon);
00636 
00637     QString module = QString::null;
00638     <font class="keywordtype">int</font> item = 0;
00639     <font class="keywordtype">int</font> count = 0;  
00640     <font class="keywordflow">for</font> (QComboBox* combo = comboList.first(); combo; combo = comboList.next() ) {      
00641         module = moduleList[comboList.at()];
00642         count = combo-&gt;count();
00643       combo-&gt;setMaximumWidth(300);
00644         <font class="keywordflow">for</font> (item = 0; item &lt; count; item++) {
00645             <font class="keywordflow">if</font> (combo-&gt;text(item) == module ) {
00646               combo-&gt;setCurrentItem(item);
00647               <font class="keywordflow">break</font>;
00648             }
00649         }
00650     }
00651 
00652     
00653 
00654 <font class="comment">// ---------- new tab: filters -------- //</font>
00655   currentTab = <font class="keyword">new</font> QFrame(tabCtl);
00656   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Filter settings"</font>));
00657   QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(currentTab,5);
00658 
00659   layout-&gt;addWidget( CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Filter settings"</font>), i18n(<font class="stringliteral">"Filters control the appereance of the text in the display windows. Here you can choose the default settings of the various filter settings. You can change the settings in each display window, too."</font>)) );
00660   layout-&gt;addSpacing(5);
00661         
00662     m_settings.sword.lineBreaks = <font class="keyword">new</font> QCheckBox(currentTab);
00663     m_settings.sword.lineBreaks-&gt;setText(i18n(<font class="stringliteral">"Show line break after each verse"</font>));
00664     m_settings.sword.lineBreaks-&gt;setChecked(CBTConfig::get(CBTConfig::lineBreaks));     
00665     layout-&gt;addWidget(m_settings.sword.lineBreaks);
00666 
00667     m_settings.sword.verseNumbers = <font class="keyword">new</font> QCheckBox(currentTab);
00668     m_settings.sword.verseNumbers-&gt;setText(i18n(<font class="stringliteral">"Show verse numbers"</font>));
00669     m_settings.sword.verseNumbers-&gt;setChecked(CBTConfig::get(CBTConfig::verseNumbers));     
00670     layout-&gt;addWidget(m_settings.sword.verseNumbers);
00671 
00672     m_settings.sword.footnotes = <font class="keyword">new</font> QCheckBox(currentTab);
00673     m_settings.sword.footnotes-&gt;setText(i18n(<font class="stringliteral">"Show footnotes"</font>));
00674     m_settings.sword.footnotes-&gt;setChecked(CBTConfig::get(CBTConfig::footnotes));       
00675     layout-&gt;addWidget(m_settings.sword.footnotes);
00676 
00677     m_settings.sword.strongNumbers = <font class="keyword">new</font> QCheckBox(currentTab);
00678     m_settings.sword.strongNumbers-&gt;setText(i18n(<font class="stringliteral">"Show Strong's Numbers"</font>));
00679     m_settings.sword.strongNumbers-&gt;setChecked(CBTConfig::get(CBTConfig::strongNumbers));       
00680     layout-&gt;addWidget(m_settings.sword.strongNumbers);
00681 
00682     m_settings.sword.headings = <font class="keyword">new</font> QCheckBox(currentTab);
00683     m_settings.sword.headings-&gt;setText(i18n(<font class="stringliteral">"Show headings"</font>));
00684     m_settings.sword.headings-&gt;setChecked(CBTConfig::get(CBTConfig::headings));     
00685     layout-&gt;addWidget(m_settings.sword.headings);
00686 
00687     m_settings.sword.morphTags = <font class="keyword">new</font> QCheckBox(currentTab);
00688     m_settings.sword.morphTags-&gt;setText(i18n(<font class="stringliteral">"Show morphologic tags"</font>));
00689     m_settings.sword.morphTags-&gt;setChecked(CBTConfig::get(CBTConfig::morphTags));       
00690     layout-&gt;addWidget(m_settings.sword.morphTags);
00691 
00692     m_settings.sword.lemmas = <font class="keyword">new</font> QCheckBox(currentTab);
00693     m_settings.sword.lemmas-&gt;setText(i18n(<font class="stringliteral">"Show lemmas"</font>));
00694     m_settings.sword.lemmas-&gt;setChecked(CBTConfig::get(CBTConfig::lemmas));     
00695     layout-&gt;addWidget(m_settings.sword.lemmas);
00696         
00697     m_settings.sword.hebrewPoints = <font class="keyword">new</font> QCheckBox(currentTab);
00698     m_settings.sword.hebrewPoints-&gt;setText(i18n(<font class="stringliteral">"Show Hebrew vowel points"</font>));
00699     m_settings.sword.hebrewPoints-&gt;setChecked(CBTConfig::get(CBTConfig::hebrewPoints));     
00700     layout-&gt;addWidget(m_settings.sword.hebrewPoints);
00701 
00702     m_settings.sword.hebrewCantillation = <font class="keyword">new</font> QCheckBox(currentTab);
00703     m_settings.sword.hebrewCantillation-&gt;setText(i18n(<font class="stringliteral">"Show Hebrew cantillation marks"</font>));
00704     m_settings.sword.hebrewCantillation-&gt;setChecked(CBTConfig::get(CBTConfig::hebrewCantillation));     
00705     layout-&gt;addWidget(m_settings.sword.hebrewCantillation);
00706 
00707     m_settings.sword.greekAccents = <font class="keyword">new</font> QCheckBox(currentTab);
00708     m_settings.sword.greekAccents-&gt;setText(i18n(<font class="stringliteral">"Show Greek accents"</font>));
00709     m_settings.sword.greekAccents-&gt;setChecked(CBTConfig::get(CBTConfig::greekAccents));     
00710     layout-&gt;addWidget(m_settings.sword.greekAccents);
00711 
00712     m_settings.sword.textualVariants = <font class="keyword">new</font> QCheckBox(currentTab);
00713     m_settings.sword.textualVariants-&gt;setText(i18n(<font class="stringliteral">"Use textual variants"</font>));
00714     m_settings.sword.textualVariants-&gt;setChecked(CBTConfig::get(CBTConfig::textualVariants));       
00715     layout-&gt;addWidget(m_settings.sword.textualVariants);
00716         
00717     layout-&gt;addStretch(4);  
00718 }
00719 
00720 <font class="keywordtype">void</font> COptionsDialog::saveAccelerators(){
00721 <font class="preprocessor">#warning check</font>
00722 <font class="preprocessor"></font><font class="comment">//  m_settings.keys.application.accel-&gt;writeSettings();</font>
00723 <font class="comment">//  m_settings.keys.application.keyChooser-&gt;save();</font>
00724     m_settings.keys.application.keyChooser-&gt;commitChanges();
00725     m_settings.keys.application.accel-&gt;writeSettings();     
00726 
00727 <font class="comment">//  m_settings.keys.general.accel-&gt;writeSettings();</font>
00728 <font class="comment">//      </font>
00729 <font class="comment">//  m_settings.keys.bible.accel-&gt;writeSettings();       </font>
00730 <font class="comment">//  m_settings.keys.bible.keyChooser-&gt;save();</font>
00731     m_settings.keys.bible.keyChooser-&gt;commitChanges();
00732     m_settings.keys.bible.accel-&gt;writeSettings();
00733 
00734 <font class="comment">//      </font>
00735 <font class="comment">//  m_settings.keys.commentary.accel-&gt;writeSettings();</font>
00736 <font class="comment">//  m_settings.keys.commentary.keyChooser-&gt;save();</font>
00737     m_settings.keys.commentary.keyChooser-&gt;commitChanges();
00738     m_settings.keys.commentary.accel-&gt;writeSettings();  
00739 
00740         
00741 <font class="comment">//  m_settings.keys.lexicon.accel-&gt;writeSettings();</font>
00742 <font class="comment">//  m_settings.keys.lexicon.keyChooser-&gt;save();</font>
00743     m_settings.keys.lexicon.keyChooser-&gt;commitChanges();
00744     m_settings.keys.lexicon.accel-&gt;writeSettings();     
00745 
00746 <font class="comment">//  m_settings.keys.book.accel-&gt;writeSettings();        </font>
00747 <font class="comment">//  m_settings.keys.book.keyChooser-&gt;save();</font>
00748     m_settings.keys.book.keyChooser-&gt;commitChanges();
00749     m_settings.keys.book.accel-&gt;writeSettings();
00750 }
00751 
<a name="l00753"></a><a class="code" href="class_c_options_dialog.html#b7">00753</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b7">COptionsDialog::saveColors</a>(){
00754     CBTConfig::set(CBTConfig::textColor, m_settings.colors.text-&gt;color().name());   
00755     CBTConfig::set(CBTConfig::backgroundColor, m_settings.colors.background-&gt;color().name());   
00756     CBTConfig::set(CBTConfig::highlightedVerseColor, m_settings.colors.highlightedVerse-&gt;color().name());       
00757     CBTConfig::set(CBTConfig::swordRefColor, m_settings.colors.swordrefs-&gt;color().name());      
00758     CBTConfig::set(CBTConfig::footnotesColor, m_settings.colors.footnotes-&gt;color().name());     
00759     CBTConfig::set(CBTConfig::strongsColor, m_settings.colors.strongs-&gt;color().name());     
00760     CBTConfig::set(CBTConfig::morphsColor, m_settings.colors.morph-&gt;color().name());        
00761     CBTConfig::set(CBTConfig::jesuswordsColor, m_settings.colors.jesuswords-&gt;color().name());       
00762 }
00763 
<a name="l00765"></a><a class="code" href="class_c_options_dialog.html#b8">00765</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b8">COptionsDialog::saveFonts</a>(){
00766     <font class="keywordflow">for</font>(QMap&lt;QString, QFont&gt;::Iterator it = m_settings.fonts.fontMap.begin(); it != m_settings.fonts.fontMap.end(); ++it ){
00767         <font class="keywordflow">if</font> (it.key() == i18n(<font class="stringliteral">"Standard"</font>)) {
00768             CBTConfig::set(CBTConfig::standard, it.data());
00769         }
00770         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (it.key() == i18n(<font class="stringliteral">"Unicode"</font>)) {
00771             QFont font = it.data();
00772 <font class="comment">//          font.setCharSet(QFont::Unicode); //try to set the unicode charset</font>
00773             CBTConfig::set(CBTConfig::unicode, font);
00774         }
00775     }
00776 }
00777 
<a name="l00779"></a><a class="code" href="class_c_options_dialog.html#b9">00779</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b9">COptionsDialog::saveProfiles</a>(){
00780 }
00781 
<a name="l00783"></a><a class="code" href="class_c_options_dialog.html#b10">00783</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b10">COptionsDialog::saveStartup</a>(){
00784     CBTConfig::set( CBTConfig::logo, m_settings.startup.showLogo-&gt;isChecked() );    
00785     CBTConfig::set( CBTConfig::tips, m_settings.startup.showTips-&gt;isChecked() );                
00786     CBTConfig::set( CBTConfig::restoreWorkspace, m_settings.startup.restoreWorkspace-&gt;isChecked() );    
00787 }
00788 
<a name="l00790"></a><a class="code" href="class_c_options_dialog.html#b11">00790</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b11">COptionsDialog::saveSword</a>(){
00791   <font class="keywordtype">bool</font> old_lexiconCache = CBTConfig::get(CBTConfig::lexiconCache);
00792   <font class="keywordtype">bool</font> new_lexiconCache = m_settings.sword.lexiconCache-&gt;isChecked();
00793         
00794   CBTConfig::set( CBTConfig::lexiconCache, new_lexiconCache );  
00795 
00796   <font class="keywordflow">if</font> (old_lexiconCache &amp;&amp; !new_lexiconCache){  <font class="comment">//delete cache files</font>
00797     QString dirname = KGlobal::dirs()-&gt;saveLocation(<font class="stringliteral">"data"</font>, <font class="stringliteral">"bibletime/cache/"</font>);
00798     QDir dir = QDir(dirname);
00799     QStringList files = QStringList( dir.entryList() );
00800     <font class="keywordflow">for</font> (QStringList::Iterator it = files.begin(); it != files.end(); ++it)
00801         dir.remove((*it),<font class="keyword">false</font>);            
00802   }
00803         
00804   CBTConfig::set(CBTConfig::standardBible, m_settings.sword.standardBible-&gt;currentText());
00805   CBTConfig::set(CBTConfig::standardCommentary, m_settings.sword.standardCommentary-&gt;currentText());
00806   CBTConfig::set(CBTConfig::standardLexicon, m_settings.sword.standardLexicon-&gt;currentText());
00807   CBTConfig::set(CBTConfig::standardHebrewStrongsLexicon, m_settings.sword.standardHebrewStrong-&gt;currentText());
00808   CBTConfig::set(CBTConfig::standardGreekStrongsLexicon, m_settings.sword.standardGreekStrong-&gt;currentText() );     
00809   CBTConfig::set(CBTConfig::standardHebrewMorphLexicon, m_settings.sword.standardHebrewMorph-&gt;currentText());
00810   CBTConfig::set(CBTConfig::standardGreekMorphLexicon, m_settings.sword.standardGreekMorph-&gt;currentText() );    
00811 
00812     <font class="keyword">const</font> QString currentText = m_settings.sword.localeCombo-&gt;currentText();
00813     list &lt;string&gt; locales = LocaleMgr::systemLocaleMgr.getAvailableLocales();
00814     QString localeName = QString::null;
00815     <font class="keywordflow">for</font> (list &lt;string&gt;::iterator it = locales.begin(); it != locales.end(); it++) {
00816         <font class="keywordflow">if</font> ( i18n(LocaleMgr::systemLocaleMgr.getLocale((*it).c_str())-&gt;getDescription()) == currentText ) {
00817             localeName = (*it).c_str(); <font class="comment">//we found the abbrevation for the current language</font>
00818             <font class="keywordflow">break</font>;
00819         }
00820     }
00821     <font class="keywordflow">if</font> (!localeName.isEmpty())
00822         CBTConfig::set(CBTConfig::language, localeName);
00823     <font class="keywordflow">else</font>
00824         CBTConfig::set(CBTConfig::language, currentText);
00825 
00826     CBTConfig::set(CBTConfig::scroll, m_settings.sword.useDownArrow-&gt;isChecked());
00827     CBTConfig::set(CBTConfig::lineBreaks, m_settings.sword.lineBreaks-&gt;isChecked());
00828     CBTConfig::set(CBTConfig::verseNumbers, m_settings.sword.verseNumbers-&gt;isChecked());
00829     CBTConfig::set(CBTConfig::footnotes, m_settings.sword.footnotes-&gt;isChecked());
00830     CBTConfig::set(CBTConfig::strongNumbers, m_settings.sword.strongNumbers-&gt;isChecked());
00831     CBTConfig::set(CBTConfig::headings, m_settings.sword.headings-&gt;isChecked());
00832     CBTConfig::set(CBTConfig::morphTags, m_settings.sword.morphTags-&gt;isChecked());
00833     CBTConfig::set(CBTConfig::lemmas, m_settings.sword.lemmas-&gt;isChecked());
00834     CBTConfig::set(CBTConfig::hebrewPoints, m_settings.sword.hebrewPoints-&gt;isChecked());
00835     CBTConfig::set(CBTConfig::hebrewCantillation, m_settings.sword.hebrewCantillation-&gt;isChecked());
00836     CBTConfig::set(CBTConfig::greekAccents, m_settings.sword.greekAccents-&gt;isChecked());
00837     CBTConfig::set(CBTConfig::textualVariants, m_settings.sword.textualVariants-&gt;isChecked());          
00838 }
</pre></div><hr><address align="right"><small>Generated on Sun May 12 20:27:13 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
