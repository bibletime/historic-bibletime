<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>coptionsdialog.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>coptionsdialog.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                          coptionsdialog.cpp  -  description</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Wed Jan 19 2000</font>
00005 <font class="comment">    copyright            : (C) 2000 by The BibleTime Team</font>
00006 <font class="comment">    email                : Info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="preprocessor">#include "coptionsdialog.h"</font>
00019 <font class="preprocessor">#include "cprofile.h"</font>
00020 <font class="preprocessor">#include "ctoolclass.h"</font>
00021 <font class="preprocessor">#include "frontend/displaywindow/cbiblereadwindow.h"</font>
00022 <font class="preprocessor">#include "frontend/displaywindow/ccommentaryreadwindow.h"</font>
00023 <font class="preprocessor">#include "frontend/displaywindow/clexiconreadwindow.h"</font>
00024 <font class="preprocessor">#include "frontend/displaywindow/cbookreadwindow.h"</font>
00025 <font class="preprocessor">#include "frontend/displaywindow/creadwindow.h"</font>
00026 <font class="comment">//#include "presenters/cswordpresenter.h"</font>
00027 <font class="comment">//#include "presenters/cbiblepresenter.h"</font>
00028 <font class="comment">//#include "presenters/ccommentarypresenter.h"</font>
00029 <font class="comment">//#include "presenters/clexiconpresenter.h"</font>
00030 <font class="comment">//#include "presenters/cbookpresenter.h"</font>
00031 <font class="preprocessor">#include "resource.h"</font>
00032 <font class="preprocessor">#include "whatsthisdef.h"</font>
00033 <font class="preprocessor">#include "backend/cswordbackend.h"</font>
00034 <font class="preprocessor">#include "backend/cswordmoduleinfo.h"</font>
00035 <font class="preprocessor">#include "cbtconfig.h"</font>
00036 
00037 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00038 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00039 
00040 <font class="comment">//QT includes</font>
00041 <font class="preprocessor">#include &lt;qhbox.h&gt;</font>
00042 <font class="preprocessor">#include &lt;qlayout.h&gt;</font>
00043 <font class="preprocessor">#include &lt;qvbox.h&gt;</font>
00044 <font class="preprocessor">#include &lt;qdict.h&gt;</font>
00045 <font class="preprocessor">#include &lt;qcheckbox.h&gt;</font>
00046 <font class="preprocessor">#include &lt;qbuttongroup.h&gt;</font>
00047 <font class="preprocessor">#include &lt;qhbuttongroup.h&gt;</font>
00048 <font class="preprocessor">#include &lt;qradiobutton.h&gt;</font>
00049 <font class="preprocessor">#include &lt;qcolor.h&gt;</font>
00050 <font class="preprocessor">#include &lt;qtooltip.h&gt;</font>
00051 <font class="preprocessor">#include &lt;qwhatsthis.h&gt;</font>
00052 <font class="preprocessor">#include &lt;qstringlist.h&gt;</font>
00053 <font class="preprocessor">#include &lt;qinputdialog.h&gt;</font>
00054 <font class="preprocessor">#include &lt;qdir.h&gt;</font>
00055 
00056 
00057 <font class="comment">//KDE includes</font>
00058 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00059 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00060 <font class="preprocessor">#include &lt;kglobal.h&gt;</font>
00061 <font class="preprocessor">#include &lt;kstandarddirs.h&gt;</font>
00062 <font class="preprocessor">#include &lt;kkeydialog.h&gt;</font>
00063 <font class="preprocessor">#include &lt;kiconloader.h&gt;</font>
00064 <font class="preprocessor">#include &lt;ktabctl.h&gt;</font>
00065 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00066 <font class="preprocessor">#include &lt;klistbox.h&gt;</font>
00067 <font class="preprocessor">#include &lt;kkeydialog.h&gt;</font>
00068 <font class="preprocessor">#include &lt;kaction.h&gt;</font>
00069 <font class="preprocessor">#include &lt;kconfigbase.h&gt;</font>
00070 <font class="preprocessor">#include &lt;kconfig.h&gt;</font>
00071 
00072 <font class="comment">//Sword includes</font>
00073 <font class="preprocessor">#include &lt;localemgr.h&gt;</font>
00074 
00075 COptionsDialog::COptionsDialog(QWidget *parent, <font class="keyword">const</font> <font class="keywordtype">char</font> *name, KAccel* accel )
00076     : KDialogBase(IconList, i18n("Optionsdialog"), Ok | Cancel | Apply, Ok, parent, name, true, true, QString::null, QString::null, QString::null) {
00077 
00078     m_settings.keys.application.accel = accel;
00079     setIconListAllVisible(<font class="keyword">true</font>);
00080 
00081     initStartup();      
00082     initFonts();
00083     initColors();   
00084     initProfiles();
00085     initSword();
00086     initAccelerators();
00087 <font class="comment">//  qWarning("ICON THEME: %s",KGlobal::instance()-&gt;iconLoader()-&gt;theme()-&gt;name().latin1());</font>
00088 }
00089 
<a name="l00091"></a><a class="code" href="class_c_options_dialog.html#h1">00091</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h1">COptionsDialog::newDisplayWindowFontSelected</a>(<font class="keyword">const</font> QFont &amp;newFont){
00092     m_settings.fonts.fontMap.replace(m_settings.fonts.usage-&gt;currentText(), newFont);       
00093 }
00094 
<a name="l00096"></a><a class="code" href="class_c_options_dialog.html#h2">00096</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h2">COptionsDialog::newDisplayWindowFontAreaSelected</a>(<font class="keyword">const</font> QString&amp; usage){
00097     m_settings.fonts.fontChooser-&gt;setFont( m_settings.fonts.fontMap[usage] );
00098 }
00099 
<a name="l00101"></a><a class="code" href="class_c_options_dialog.html#h3">00101</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h3">COptionsDialog::slotOk</a>(){
00102     saveAccelerators();
00103     <a class="code" href="class_c_options_dialog.html#b7">saveColors</a>();
00104     <a class="code" href="class_c_options_dialog.html#b8">saveFonts</a>();
00105     <a class="code" href="class_c_options_dialog.html#b11">saveSword</a>();
00106     <a class="code" href="class_c_options_dialog.html#b10">saveStartup</a>();
00107     <a class="code" href="class_c_options_dialog.html#b9">saveProfiles</a>();
00108     
00109     KDialogBase::slotOk();
00110 
00111   emit signalSettingsChanged( );
00112 }
00113 
00114 <font class="comment">/*called if the apply button was clicked*/</font>
<a name="l00115"></a><a class="code" href="class_c_options_dialog.html#h4">00115</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h4">COptionsDialog::slotApply</a>(){
00116     saveAccelerators();
00117     <a class="code" href="class_c_options_dialog.html#b7">saveColors</a>();
00118     <a class="code" href="class_c_options_dialog.html#b8">saveFonts</a>();
00119     <a class="code" href="class_c_options_dialog.html#b11">saveSword</a>();
00120     <a class="code" href="class_c_options_dialog.html#b10">saveStartup</a>();
00121     <a class="code" href="class_c_options_dialog.html#b9">saveProfiles</a>();
00122     
00123     KDialogBase::slotApply();
00124 
00125   emit signalSettingsChanged( );
00126 }
00127 
<a name="l00129"></a><a class="code" href="class_c_options_dialog.html#h0">00129</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h0">COptionsDialog::addNewProfile</a>(){
00130     <font class="keywordtype">bool</font> ok = <font class="keyword">false</font>;
00131     QString name = QInputDialog::getText(i18n(<font class="stringliteral">"Create new profile"</font>), i18n(<font class="stringliteral">"Please enter the name of the new profile"</font>), QLineEdit::Normal, QString::null, &amp;ok);
00132     <font class="keywordflow">if</font> (ok &amp;&amp; !name.isEmpty()) {
00133         m_settings.profiles.mgr.create(name);
00134         m_settings.profiles.profiles-&gt;insertItem(name);             
00135         <font class="keywordflow">if</font> (m_settings.profiles.profiles-&gt;count() == 1)
00136             m_settings.profiles.profiles-&gt;setEnabled(<font class="keyword">true</font>);     
00137     }
00138 }
00139 
<a name="l00141"></a><a class="code" href="class_c_options_dialog.html#h6">00141</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h6">COptionsDialog::deleteProfile</a>(){
00142     <font class="keyword">const</font> QString profile = m_settings.profiles.profiles-&gt;currentText();
00143     m_settings.profiles.mgr.remove(profile);
00144     m_settings.profiles.profiles-&gt;removeItem( m_settings.profiles.profiles-&gt;currentItem() );
00145 }
00146 
<a name="l00148"></a><a class="code" href="class_c_options_dialog.html#h5">00148</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h5">COptionsDialog::renameProfile</a>(){
00149     <font class="keywordtype">bool</font> ok = <font class="keyword">false</font>;
00150     <font class="keyword">const</font> QString currentProfile = m_settings.profiles.profiles-&gt;currentText(); 
00151     <a class="code" href="class_c_profile.html">CProfile</a>* profile = m_settings.profiles.mgr.profile(currentProfile);
00152     <font class="keywordflow">if</font> (!profile)
00153         <font class="keywordflow">return</font>;
00154     <font class="keyword">const</font> QString newName = QInputDialog::getText(i18n(<font class="stringliteral">"Rename profile"</font>), i18n(<font class="stringliteral">"Please enter the new name of the profile"</font>), QLineEdit::Normal, profile-&gt;<a class="code" href="class_c_profile.html#a5">name</a>(), &amp;ok);
00155     <font class="keywordflow">if</font> (ok &amp;&amp; !newName.isEmpty()) {
00156         profile-&gt;<a class="code" href="class_c_profile.html#a8">setName</a>(newName);
00157         m_settings.profiles.profiles-&gt;changeItem(newName, m_settings.profiles.profiles-&gt;currentItem());
00158     }   
00159 }
00160 
<a name="l00162"></a><a class="code" href="class_c_options_dialog.html#a1">00162</a> <font class="keyword">const</font> <font class="keywordtype">bool</font> <a class="code" href="class_c_options_dialog.html#a1">COptionsDialog::showPart</a>(  COptionsDialog::Parts ID ){
00163     <font class="keywordtype">bool</font> ret = <font class="keyword">false</font>;
00164     <font class="keywordflow">switch</font> (ID) {
00165         <font class="keywordflow">case</font> COptionsDialog::ViewProfiles:
00166             <font class="keywordflow">if</font>(showPage(pageIndex(
00167                     m_settings.profiles.profiles-&gt;parentWidget()) ))
00168                 ret = <font class="keyword">true</font>;
00169             <font class="keywordflow">break</font>;
00170         <font class="keywordflow">default</font>:
00171             <font class="keywordflow">break</font>;
00172     }
00173     <font class="keywordflow">return</font> ret;
00174 }
00175 
<a name="l00177"></a><a class="code" href="class_c_options_dialog.html#b5">00177</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b5">COptionsDialog::initStartup</a>(){
00178     QFrame* page = addPage(i18n(<font class="stringliteral">"Startup"</font>), QString::null, OD_ICON_GENERAL);
00179     QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(page,5);
00180     {<font class="comment">//daily tips</font>
00181         m_settings.startup.showTips = <font class="keyword">new</font> QCheckBox(page);
00182         m_settings.startup.showTips-&gt;setText(i18n(<font class="stringliteral">"Show tip of the day"</font>));
00183         QToolTip::add(m_settings.startup.showTips, TT_OD_GENERAL_DAILY_TIP);    
00184         QWhatsThis::add(m_settings.startup.showTips, WT_OD_GENERAL_DAILY_TIP);
00185         
00186         m_settings.startup.showTips-&gt;setChecked( CBTConfig::get(CBTConfig::tips) );
00187     }
00188     layout-&gt;addWidget(m_settings.startup.showTips);
00189     
00190     { <font class="comment">//startup logo</font>
00191         m_settings.startup.showLogo = <font class="keyword">new</font> QCheckBox(page);
00192         m_settings.startup.showLogo-&gt;setText(i18n(<font class="stringliteral">"Show startuplogo"</font>));
00193         QWhatsThis::add(m_settings.startup.showLogo, WT_OD_GENERAL_SHOW_STARTUPLOGO);
00194         QToolTip::add(m_settings.startup.showLogo, TT_OD_GENERAL_SHOW_STARTUPLOGO);     
00195         
00196         m_settings.startup.showLogo-&gt;setChecked(CBTConfig::get(CBTConfig::logo));           
00197     }       
00198     layout-&gt;addWidget(m_settings.startup.showLogo);
00199     { <font class="comment">//workspace</font>
00200         m_settings.startup.restoreWorkspace = <font class="keyword">new</font> QCheckBox(page);
00201         m_settings.startup.restoreWorkspace-&gt;setText(i18n(<font class="stringliteral">"Restore windows in workspace area"</font>));
00202         QToolTip::add(m_settings.startup.restoreWorkspace, TT_OD_GENERAL_RESTORE_WORKSPACE);        
00203         QWhatsThis::add(m_settings.startup.restoreWorkspace, WT_OD_GENERAL_RESTORE_WORKSPACE);
00204         
00205         m_settings.startup.restoreWorkspace-&gt;setChecked(CBTConfig::get(CBTConfig::restoreWorkspace));           
00206     }       
00207     layout-&gt;addWidget(m_settings.startup.restoreWorkspace);         
00208     
00209     layout-&gt;addStretch(4);
00210 }
00211 
<a name="l00213"></a><a class="code" href="class_c_options_dialog.html#b2">00213</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b2">COptionsDialog::initFonts</a>(){
00214     QFrame* page = addPage(i18n(<font class="stringliteral">"Fonts"</font>), QString::null, OD_ICON_FONTS);
00215     QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(page,5);
00216     
00217     layout-&gt;addWidget( CToolClass::explanationLabel(page, i18n(<font class="stringliteral">"Choose fonts"</font>), i18n(<font class="stringliteral">"The fonts you can choose here are used in the display windows. Use the drop-down box below to choose the area of application. Then select a font for it. Make sure the font contains the characters of the modules you use!"</font>)) );
00218   layout-&gt;addSpacing(5);
00219                     
00220     m_settings.fonts.usage = <font class="keyword">new</font> QComboBox(page);       
00221     QToolTip::add(m_settings.fonts.usage, TT_OD_FONTS_TYPE_CHOOSER);        
00222     QWhatsThis::add(m_settings.fonts.usage, WT_OD_FONTS_TYPE_CHOOSER);  
00223     layout-&gt;addWidget(m_settings.fonts.usage);
00224         
00225     m_settings.fonts.fontMap.insert(i18n(<font class="stringliteral">"Standard"</font>), CBTConfig::get(CBTConfig::standard));
00226     m_settings.fonts.fontMap.insert(i18n(<font class="stringliteral">"Unicode"</font>),  CBTConfig::get(CBTConfig::unicode));
00227 
00228     <font class="keywordflow">for</font>( QMap&lt;QString, QFont&gt;::Iterator it = m_settings.fonts.fontMap.begin(); it != m_settings.fonts.fontMap.end(); ++it )
00229         m_settings.fonts.usage-&gt;insertItem(it.key());
00230         
00231     m_settings.fonts.fontChooser = <font class="keyword">new</font> KFontChooser(page, <font class="stringliteral">"fonts"</font>, <font class="keyword">false</font>, QStringList(), <font class="keyword">true</font>, 5);
00232     m_settings.fonts.fontChooser-&gt;setSampleText(i18n(<font class="stringliteral">"The quick brown fox jumps over the lazy dog"</font>));
00233     layout-&gt;addWidget(m_settings.fonts.fontChooser);
00234         
00235   connect(m_settings.fonts.fontChooser, SIGNAL(fontSelected(<font class="keyword">const</font> QFont&amp;)), SLOT(<a class="code" href="class_c_options_dialog.html#h1">newDisplayWindowFontSelected</a>(<font class="keyword">const</font> QFont&amp;)));
00236   connect(m_settings.fonts.usage, SIGNAL(activated(<font class="keyword">const</font> QString&amp;)), SLOT(<a class="code" href="class_c_options_dialog.html#h2">newDisplayWindowFontAreaSelected</a>(<font class="keyword">const</font> QString&amp;)));
00237     QWhatsThis::add(m_settings.fonts.fontChooser, WT_OD_FONTS_CHOOSER);
00238             
00239     m_settings.fonts.fontChooser-&gt;setFont( m_settings.fonts.fontMap[m_settings.fonts.usage-&gt;currentText()] );
00240     m_settings.fonts.fontChooser-&gt;setMinimumSize(m_settings.fonts.fontChooser-&gt;sizeHint());     
00241 }
00242 
<a name="l00244"></a><a class="code" href="class_c_options_dialog.html#b4">00244</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b4">COptionsDialog::initColors</a>(){
00245     QFrame* page = addPage(i18n(<font class="stringliteral">"Colors"</font>), QString::null, OD_ICON_COLORS);
00246 <font class="comment">//  QVBoxLayout* layout = new QVBoxLayout(page);</font>
00247     QGridLayout* gridLayout = <font class="keyword">new</font> QGridLayout(page,8,5,5,5);
00248   gridLayout-&gt;setResizeMode(QLayout::Minimum);
00249         
00250   gridLayout-&gt;addMultiCellWidget(
00251     CToolClass::explanationLabel(page,
00252         i18n(<font class="stringliteral">"Choose colors"</font>),
00253         i18n(<font class="stringliteral">"Choose the colors to change the look of the display windows to your own preferences. Some options like \"Words of Jesus\" do only apply to texts which support this special feature."</font>)
00254     ),      
00255     0,0,0,-1
00256   );
00257         
00258     m_settings.colors.text = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::textColor), page);      
00259     QLabel* label = <font class="keyword">new</font> QLabel(m_settings.colors.text, i18n(<font class="stringliteral">"Text"</font>), page);         
00260     gridLayout-&gt;addWidget(label,1,0);
00261     gridLayout-&gt;addWidget(m_settings.colors.text,1,1);
00262     
00263     m_settings.colors.highlightedVerse = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::highlightedVerseColor), page);
00264     label = <font class="keyword">new</font> QLabel(m_settings.colors.highlightedVerse, i18n(<font class="stringliteral">"Highlighted verse"</font>), page);
00265     gridLayout-&gt;addWidget(label,1,3);
00266     gridLayout-&gt;addWidget(m_settings.colors.highlightedVerse,1,4);
00267 
00268     m_settings.colors.background = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::backgroundColor), page);          
00269     label = <font class="keyword">new</font> QLabel(m_settings.colors.background, i18n(<font class="stringliteral">"Background"</font>), page);     
00270     gridLayout-&gt;addWidget(label,2,0);
00271     gridLayout-&gt;addWidget(m_settings.colors.background,2,1);
00272 
00273 <font class="comment">//  m_settings.colors.background2 = new KColorButton(CBTConfig::get(CBTConfig::background2Color), page);            </font>
00274 <font class="comment">//  label = new QLabel(m_settings.colors.background2, i18n("Background 2 (in tables)"), page);      </font>
00275 <font class="comment">//  gridLayout-&gt;addWidget(label,2,3);</font>
00276 <font class="comment">//  gridLayout-&gt;addWidget(m_settings.colors.background2,2,4);</font>
00277 
00278     m_settings.colors.swordrefs = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::swordRefColor), page);
00279     label = <font class="keyword">new</font> QLabel(m_settings.colors.swordrefs,i18n(<font class="stringliteral">"Hyperlinks"</font>), page);
00280     gridLayout-&gt;addWidget(label,4,0);
00281     gridLayout-&gt;addWidget(m_settings.colors.swordrefs,4,1);
00282 
00283     m_settings.colors.footnotes = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::footnotesColor), page);        
00284     label = <font class="keyword">new</font> QLabel(m_settings.colors.footnotes,i18n(<font class="stringliteral">"Footnotes"</font>), page);            
00285     gridLayout-&gt;addWidget(label,6,0);
00286     gridLayout-&gt;addWidget(m_settings.colors.footnotes,6,1);
00287 
00288     m_settings.colors.jesuswords = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::jesuswordsColor), page);      
00289     label = <font class="keyword">new</font> QLabel(m_settings.colors.jesuswords, i18n(<font class="stringliteral">"Words of Jesus"</font>), page);         
00290     gridLayout-&gt;addWidget(label,6,3);
00291     gridLayout-&gt;addWidget(m_settings.colors.jesuswords,6,4);
00292 
00293     m_settings.colors.strongs = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::strongsColor), page);        
00294     label = <font class="keyword">new</font> QLabel(m_settings.colors.strongs, i18n(<font class="stringliteral">"Strong's numbers"</font>), page);          
00295     gridLayout-&gt;addWidget(label,7,0);
00296     gridLayout-&gt;addWidget(m_settings.colors.strongs,7,1);
00297 
00298     m_settings.colors.morph = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::morphsColor), page);       
00299     label = <font class="keyword">new</font> QLabel(m_settings.colors.morph, i18n(<font class="stringliteral">"Morphologic tags"</font>), page);            
00300     gridLayout-&gt;addWidget(label,7,3);
00301     gridLayout-&gt;addWidget(m_settings.colors.morph,7,4);
00302 
00303     gridLayout-&gt;setRowStretch(9, 5);
00304     gridLayout-&gt;addColSpacing(3, 5);
00305     gridLayout-&gt;addRowSpacing(3, 10);
00306     gridLayout-&gt;addRowSpacing(5, 10);
00307 }
00308 
<a name="l00310"></a><a class="code" href="class_c_options_dialog.html#b3">00310</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b3">COptionsDialog::initProfiles</a>(){
00311     QFrame* page = addPage(i18n(<font class="stringliteral">"Profiles"</font>),QString::null, OD_ICON_PROFILES);
00312     QGridLayout* gridLayout = <font class="keyword">new</font> QGridLayout(page, 3,3,5,5);
00313 
00314     gridLayout-&gt;addMultiCellWidget(
00315         CToolClass::explanationLabel(page,
00316             i18n(<font class="stringliteral">"Manage your profiles"</font>),
00317             i18n(<font class="stringliteral">"Profiles define the appereance of the work area, \</font>
00318 <font class="stringliteral">for example which windows are open and which texts should displayed in these windows. \</font>
00319 <font class="stringliteral">Don't forget that new profiles only work after you've saved something in them."</font>)
00320         ),
00321         0,0,0,-1
00322     );
00323     
00324     m_settings.profiles.profiles = <font class="keyword">new</font> QListBox(page);                  
00325     gridLayout-&gt;addMultiCellWidget(m_settings.profiles.profiles, 1,1,0,-1);
00326     gridLayout-&gt;setRowStretch(1,10);
00327     
00328     m_settings.profiles.createProfile = <font class="keyword">new</font> QPushButton(i18n(<font class="stringliteral">"Create new profile"</font>), page);
00329     connect(m_settings.profiles.createProfile, SIGNAL(clicked()), SLOT(<a class="code" href="class_c_options_dialog.html#h0">addNewProfile</a>()));
00330   gridLayout-&gt;addWidget(m_settings.profiles.createProfile,2,0);
00331         
00332     m_settings.profiles.deleteProfile = <font class="keyword">new</font> QPushButton(i18n(<font class="stringliteral">"Delete selected profile"</font>), page); 
00333     connect(m_settings.profiles.deleteProfile, SIGNAL(clicked()), SLOT(<a class="code" href="class_c_options_dialog.html#h6">deleteProfile</a>()));
00334   gridLayout-&gt;addWidget(m_settings.profiles.deleteProfile,2,1);
00335         
00336     m_settings.profiles.renameProfile = <font class="keyword">new</font> QPushButton(i18n(<font class="stringliteral">"Rename selected profile"</font>), page);     
00337     connect(m_settings.profiles.renameProfile, SIGNAL(clicked()), SLOT(<a class="code" href="class_c_options_dialog.html#h5">renameProfile</a>()));
00338   gridLayout-&gt;addWidget(m_settings.profiles.renameProfile,2,2); 
00339 
00340   <font class="comment">//fill the profile list box</font>
00341     QPtrList&lt;CProfile&gt; profiles = m_settings.profiles.mgr.profiles();
00342     <font class="keywordflow">if</font> (profiles.count()) {
00343         <font class="keywordflow">for</font> (<a class="code" href="class_c_profile.html">CProfile</a>* p = profiles.first(); p; p = profiles.next()) {
00344             m_settings.profiles.profiles-&gt;insertItem(p-&gt;<a class="code" href="class_c_profile.html#a5">name</a>());
00345         }   
00346     }
00347     <font class="keywordflow">else</font> {
00348         m_settings.profiles.profiles-&gt;setEnabled(<font class="keyword">false</font>);
00349     }
00350 }
00351 
<a name="l00353"></a><a class="code" href="class_c_options_dialog.html#b1">00353</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b1">COptionsDialog::initAccelerators</a>(){
00354   QVBox* page = addVBoxPage(i18n(<font class="stringliteral">"Accelerators"</font>),QString::null, OD_ICON_KEY_BINDINGS);
00355 
00356   KTabCtl* tabCtl = <font class="keyword">new</font> KTabCtl(page);
00357 
00358 <font class="comment">// ----- new tab: All display windows ------ //</font>
00359   QFrame* currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00360     currentTab-&gt;setMargin(3);   
00361   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Application wide"</font>));
00362 
00363     CBTConfig::setupAccel( CBTConfig::application, m_settings.keys.application.accel  );
00364 <font class="comment">//  CSwordPresenter::insertKeyboardActions( m_settings.keys.application.accel );    </font>
00365     m_settings.keys.application.accel-&gt;readSettings();      
00366 
00367     m_settings.keys.application.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.application.accel, currentTab, <font class="keyword">false</font> );   
00368     QToolTip::add(m_settings.keys.application.keyChooser, TT_OD_KEYS_CHOOSER);
00369     QWhatsThis::add(m_settings.keys.application.keyChooser, WT_OD_KEYS_CHOOSER);    
00370 
00371 <font class="comment">// ----- new tab: All display windows ------ //</font>
00372     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00373     currentTab-&gt;setMargin(3);   
00374     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"All display windows"</font>));
00375     
00376     m_settings.keys.general.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00377     CBTConfig::setupAccel( CBTConfig::readWindow, m_settings.keys.general.accel  ); 
00378     <a class="code" href="class_c_read_window.html#d0">CReadWindow::insertKeyboardActions</a>( m_settings.keys.general.accel );
00379     m_settings.keys.general.accel-&gt;readSettings();
00380 
00381     m_settings.keys.general.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.general.accel, currentTab );  
00382     QToolTip::add(m_settings.keys.general.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_GENERAL);
00383     QWhatsThis::add(m_settings.keys.general.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_GENERAL);
00384 
00385 <font class="comment">// ----- new tab: Bible windows ------ //</font>
00386     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00387     currentTab-&gt;setMargin(3);   
00388     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Bible windows"</font>));
00389 
00390     m_settings.keys.bible.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00391     CBTConfig::setupAccel( CBTConfig::bibleWindow, m_settings.keys.bible.accel  );  
00392     <a class="code" href="class_c_bible_read_window.html#d0">CBibleReadWindow::insertKeyboardActions</a>( m_settings.keys.bible.accel );
00393     m_settings.keys.bible.accel-&gt;readSettings();
00394 
00395     m_settings.keys.bible.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.bible.accel, currentTab<font class="comment">/*, false*/</font> );   
00396     QToolTip::add(m_settings.keys.bible.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_BIBLE);
00397     QWhatsThis::add(m_settings.keys.bible.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_BIBLE);
00398 
00399 <font class="comment">// ----- new tab: Commentary windows ------ //</font>
00400     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00401     currentTab-&gt;setMargin(3);   
00402     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Commentary windows"</font>));
00403 
00404     m_settings.keys.commentary.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00405     CBTConfig::setupAccel( CBTConfig::commentaryWindow, m_settings.keys.commentary.accel  );    
00406     <a class="code" href="class_c_lexicon_read_window.html#d0">CCommentaryReadWindow::insertKeyboardActions</a>( m_settings.keys.commentary.accel );       
00407 <font class="comment">//  m_settings.keys.commentary.accel-&gt;setConfigGroup("Lexicon shortcuts");  </font>
00408     m_settings.keys.commentary.accel-&gt;readSettings();   
00409         
00410     m_settings.keys.commentary.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.commentary.accel, currentTab, <font class="keyword">false</font> ); 
00411     QToolTip::add(m_settings.keys.commentary.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_COMMENTARY);
00412     QWhatsThis::add(m_settings.keys.commentary.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_COMMENTARY);
00413 
00414 <font class="comment">// ----- new tab: Lexicon windows ------ //</font>
00415     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00416     currentTab-&gt;setMargin(3);   
00417     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Lexicon windows"</font>));
00418 
00419     m_settings.keys.lexicon.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00420     CBTConfig::setupAccel( CBTConfig::lexiconWindow, m_settings.keys.lexicon.accel  );  
00421     <a class="code" href="class_c_lexicon_read_window.html#d0">CLexiconReadWindow::insertKeyboardActions</a>( m_settings.keys.lexicon.accel );     
00422 <font class="comment">//  m_settings.keys.lexicon.accel-&gt;setConfigGroup("Lexicon shortcuts"); </font>
00423     m_settings.keys.lexicon.accel-&gt;readSettings();      
00424     
00425     m_settings.keys.lexicon.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.lexicon.accel, currentTab, <font class="keyword">false</font> );   
00426     QToolTip::add(m_settings.keys.lexicon.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_LEXICON);
00427     QWhatsThis::add(m_settings.keys.lexicon.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_LEXICON);
00428 
00429     
00430 <font class="comment">// ----- new tab: Book windows ------ //</font>
00431     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00432     currentTab-&gt;setMargin(3);   
00433     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Book windows"</font>));
00434 
00435     m_settings.keys.book.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00436     CBTConfig::setupAccel( CBTConfig::bookWindow, m_settings.keys.book.accel  );    
00437     <a class="code" href="class_c_book_read_window.html#d0">CBookReadWindow::insertKeyboardActions</a>( m_settings.keys.book.accel );       
00438 <font class="comment">//  m_settings.keys.book.accel-&gt;setConfigGroup("Book shortcuts");       </font>
00439     m_settings.keys.book.accel-&gt;readSettings();     
00440     
00441     m_settings.keys.book.keyChooser = <font class="keyword">new</font> KKeyChooser( m_settings.keys.book.accel, currentTab, <font class="keyword">false</font> ); 
00442     QToolTip::add(m_settings.keys.book.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_LEXICON);
00443     QWhatsThis::add(m_settings.keys.book.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_LEXICON);                        
00444 }
00445 
<a name="l00447"></a><a class="code" href="class_c_options_dialog.html#b0">00447</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b0">COptionsDialog::initSword</a>(){
00448     QVBox* page = addVBoxPage(i18n(<font class="stringliteral">"Sword"</font>),QString::null, OD_ICON_SWORD);
00449   KTabCtl* tabCtl = <font class="keyword">new</font> KTabCtl(page);
00450   QFrame* currentTab = <font class="keyword">new</font> QFrame(tabCtl);
00451   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"General"</font>));
00452 
00453   QGridLayout* gridLayout = <font class="keyword">new</font> QGridLayout(currentTab,7,2,5,5);
00454     gridLayout-&gt;setResizeMode(QLayout::Minimum);
00455     
00456   gridLayout-&gt;addMultiCellWidget(
00457     CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Use key cache for lexicons"</font>),
00458             i18n(<font class="stringliteral">"BibleTime can create a key cache for lexicons, which speeds up opening large lexicon modules a lot. \</font>
00459 <font class="stringliteral">However these files consume some disk space (usually not much), and reside in \</font>
00460 <font class="stringliteral">$KDEHOME/share/apps/bibletime/cache."</font>)),
00461         0,0,0,-1
00462   );
00463     
00464     m_settings.sword.lexiconCache = <font class="keyword">new</font> QCheckBox(currentTab);
00465     m_settings.sword.lexiconCache-&gt;setText(i18n(<font class="stringliteral">"Use key cache for lexicons"</font>));
00466     QToolTip::add(m_settings.sword.lexiconCache, TT_OD_SWORD_USE_LEXICON_CACHE);    
00467     QWhatsThis::add(m_settings.sword.lexiconCache, WT_OD_SWORD_USE_LEXICON_CACHE);
00468         
00469     m_settings.sword.lexiconCache-&gt;setChecked( CBTConfig::get(CBTConfig::lexiconCache) );
00470     gridLayout-&gt;addMultiCellWidget(m_settings.sword.lexiconCache,1,1,0,-1);
00471 
00472   gridLayout-&gt;addMultiCellWidget(
00473     CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Scrolling behaviour"</font>),
00474             i18n(<font class="stringliteral">"The down arrow moves to the &lt;i&gt;next&lt;/i&gt; verse by default. Uncheck this box \</font>
00475 <font class="stringliteral">if you want it to move to the &lt;i&gt;previous&lt;/i&gt; verse."</font>)),
00476         2,2,0,-1
00477   );
00478         
00479     m_settings.sword.useDownArrow = <font class="keyword">new</font> QCheckBox(currentTab);
00480     m_settings.sword.useDownArrow-&gt;setText(i18n(<font class="stringliteral">"Use down arrow to scroll to next verse"</font>));
00481     m_settings.sword.useDownArrow-&gt;setChecked(CBTConfig::get(CBTConfig::scroll));       
00482     QWhatsThis::add(m_settings.sword.useDownArrow, WT_OD_GENERAL_SCROLL_PREVIOUS);
00483     QToolTip::add(m_settings.sword.useDownArrow, TT_OD_GENERAL_SCROLL_PREVIOUS);
00484     gridLayout-&gt;addMultiCellWidget(m_settings.sword.useDownArrow,3,3,0,-1);
00485 
00486   gridLayout-&gt;addMultiCellWidget(
00487     CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Specify a language for biblical booknames"</font>),
00488             i18n(<font class="stringliteral">"Sword has a number of locales available which can be used to internationalize the \</font>
00489 <font class="stringliteral">booknames of the bible. You can specify which locale to choose. If you want to \</font>
00490 <font class="stringliteral">create a new locale, see http://www.crosswire.org/sword/develop for details."</font>)),
00491         4,4,0,-1
00492   );
00493         
00494     m_settings.sword.localeCombo = <font class="keyword">new</font> QComboBox(currentTab);
00495     QLabel* label = <font class="keyword">new</font> QLabel(m_settings.sword.localeCombo, i18n(<font class="stringliteral">"Language for booknames"</font>), currentTab);   
00496     QToolTip::add(m_settings.sword.localeCombo, TT_OD_GENERAL_INTERNATIONAL_BOOKNAMES);             
00497     QWhatsThis::add(m_settings.sword.localeCombo, WT_OD_GENERAL_INTERNATIONAL_BOOKNAMES);       
00498     gridLayout-&gt;addWidget(label, 5,0);
00499     gridLayout-&gt;addWidget(m_settings.sword.localeCombo, 5,1);
00500 
00501     gridLayout-&gt;setRowStretch(6,5); <font class="comment">//eat up remaining space :)</font>
00502                                                 
00503     m_settings.sword.localeCombo-&gt;insertItem( i18n(<font class="stringliteral">"English"</font>) );
00504     list &lt;string&gt; locales = LocaleMgr::systemLocaleMgr.getAvailableLocales();
00505     <font class="keywordflow">for</font> (list &lt;string&gt;::iterator it = locales.begin(); it != locales.end(); it++) {
00506         m_settings.sword.localeCombo-&gt;insertItem( i18n(LocaleMgr::systemLocaleMgr.getLocale((*it).c_str())-&gt;getDescription()) );
00507     }
00508 
00509     <font class="keywordtype">int</font> current_item = -1;
00510     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> test_item = 0; test_item &lt; m_settings.sword.localeCombo-&gt;count(); test_item++) {
00511         SWLocale* locale = LocaleMgr::systemLocaleMgr.getLocale(CBTConfig::get(CBTConfig::language).local8Bit());
00512         <font class="keywordflow">if</font> (locale &amp;&amp; m_settings.sword.localeCombo-&gt;text(test_item).contains(i18n(locale-&gt;getDescription())) )
00513             current_item = test_item;
00514     }
00515     <font class="keywordflow">if</font> (current_item!=-1)
00516         m_settings.sword.localeCombo-&gt;setCurrentItem(current_item);
00517 
00518 
00519 <font class="comment">// ---------- new tab: Default modules -------- //</font>
00520   currentTab = <font class="keyword">new</font> QFrame(tabCtl);
00521   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Default modules"</font>));
00522     gridLayout = <font class="keyword">new</font> QGridLayout(currentTab,9,2, 5,5); <font class="comment">//the last row is for stretching available space</font>
00523     gridLayout-&gt;setResizeMode(QLayout::Minimum);
00524 
00525   gridLayout-&gt;addMultiCellWidget(
00526     CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Default modules"</font>), i18n(<font class="stringliteral">"Default modules are used, when no module is specified. This may happen with references into modules like Bibles or Lexicons."</font>)),
00527     0,0,0,-1 <font class="comment">/*fill the horizontal space*/</font>
00528   );
00529     
00530     m_settings.sword.standardBible = <font class="keyword">new</font> QComboBox(currentTab);
00531   label = <font class="keyword">new</font> QLabel(m_settings.sword.standardBible, i18n(<font class="stringliteral">"Default Bible"</font>), currentTab);
00532   label-&gt;setAutoResize(<font class="keyword">true</font>);
00533     QToolTip::add(m_settings.sword.standardBible, TT_OD_SWORD_STANDARD_BIBLE);  
00534     QWhatsThis::add(m_settings.sword.standardBible, WT_OD_SWORD_STANDARD_BIBLE);        
00535     gridLayout-&gt;addWidget(label,1,0);   
00536     gridLayout-&gt;addWidget(m_settings.sword.standardBible,1,1);
00537         
00538     m_settings.sword.standardCommentary = <font class="keyword">new</font> QComboBox(currentTab);
00539     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardCommentary, i18n(<font class="stringliteral">"Default Commentary"</font>), currentTab);
00540   label-&gt;setAutoResize(<font class="keyword">true</font>);   
00541     QToolTip::add(m_settings.sword.standardCommentary, TT_OD_SWORD_STANDARD_COMMENTARY);    
00542     QWhatsThis::add(m_settings.sword.standardCommentary, WT_OD_SWORD_STANDARD_COMMENTARY);      
00543     gridLayout-&gt;addWidget(label,2,0);
00544     gridLayout-&gt;addWidget(m_settings.sword.standardCommentary,2,1);
00545 
00546 
00547     m_settings.sword.standardLexicon = <font class="keyword">new</font> QComboBox(currentTab);
00548     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardLexicon, i18n(<font class="stringliteral">"Default Lexicon"</font>), currentTab);
00549   label-&gt;setAutoResize(<font class="keyword">true</font>);   
00550     QToolTip::add(m_settings.sword.standardLexicon, TT_OD_SWORD_STANDARD_LEXICON);  
00551     QWhatsThis::add(m_settings.sword.standardLexicon, WT_OD_SWORD_STANDARD_LEXICON);        
00552     gridLayout-&gt;addWidget(label,3,0);   
00553     gridLayout-&gt;addWidget(m_settings.sword.standardLexicon,3,1);    
00554         
00555     m_settings.sword.standardHebrewStrong = <font class="keyword">new</font> QComboBox(currentTab);
00556     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardHebrewStrong, i18n(<font class="stringliteral">"Default Hebrew Strong's Lexicon"</font>), currentTab);
00557   label-&gt;setAutoResize(<font class="keyword">true</font>);       
00558     QToolTip::add(m_settings.sword.standardHebrewStrong, TT_OD_SWORD_STANDARD_HEBREW_STRONG);
00559     QWhatsThis::add(m_settings.sword.standardHebrewStrong, WT_OD_SWORD_STANDARD_HEBREW_STRONG);
00560     gridLayout-&gt;addWidget(label,4,0);
00561     gridLayout-&gt;addWidget(m_settings.sword.standardHebrewStrong,4,1);
00562         
00563     m_settings.sword.standardGreekStrong = <font class="keyword">new</font> QComboBox(currentTab);
00564     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardGreekStrong, i18n(<font class="stringliteral">"Default Greek Strong's Lexicon"</font>), currentTab);
00565   label-&gt;setAutoResize(<font class="keyword">true</font>);       
00566     QToolTip::add(m_settings.sword.standardGreekStrong, TT_OD_SWORD_STANDARD_GREEK_STRONG);     
00567     QWhatsThis::add(m_settings.sword.standardGreekStrong, WT_OD_SWORD_STANDARD_GREEK_STRONG);
00568     gridLayout-&gt;addWidget(label,5,0);
00569     gridLayout-&gt;addWidget(m_settings.sword.standardGreekStrong,5,1);
00570         
00571     m_settings.sword.standardHebrewMorph = <font class="keyword">new</font> QComboBox(currentTab);
00572     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardHebrewMorph, i18n(<font class="stringliteral">"Default Hebrew Morphological Lexicon"</font>), currentTab);
00573     QToolTip::add(m_settings.sword.standardHebrewMorph, TT_OD_SWORD_STANDARD_HEBREW_MORPH);
00574     QWhatsThis::add(m_settings.sword.standardHebrewMorph, WT_OD_SWORD_STANDARD_HEBREW_MORPH);
00575     gridLayout-&gt;addWidget(label,6,0);
00576     gridLayout-&gt;addWidget(m_settings.sword.standardHebrewMorph,6,1);
00577 
00578     m_settings.sword.standardGreekMorph = <font class="keyword">new</font> QComboBox(currentTab);
00579     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardGreekMorph, i18n(<font class="stringliteral">"Default Greek Morphological Lexicon"</font>), currentTab);
00580   label-&gt;setAutoResize(<font class="keyword">true</font>);       
00581     QToolTip::add(m_settings.sword.standardGreekMorph, TT_OD_SWORD_STANDARD_GREEK_MORPH);
00582     QWhatsThis::add(m_settings.sword.standardGreekMorph, WT_OD_SWORD_STANDARD_GREEK_MORPH);
00583     gridLayout-&gt;addWidget(label,7,0);
00584     gridLayout-&gt;addWidget(m_settings.sword.standardGreekMorph,7,1);
00585 
00586     gridLayout-&gt;setRowStretch(8,5);                         
00587         
00588     <font class="comment">//fill the comboboxes with the right modules</font>
00589     ListCSwordModuleInfo&amp; modules = <a class="code" href="class_c_pointers.html#d1">backend</a>()-&gt;<a class="code" href="class_c_sword_backend.html#a2">moduleList</a>();
00590     QString modDescript;
00591   <font class="keywordflow">for</font> ( modules.first(); modules.current(); modules.next() ) {
00592         modDescript = modules.current()-&gt;config(CSwordModuleInfo::Description);
00593         <font class="keywordflow">switch</font> (modules.current()-&gt;type()) {
00594             <font class="keywordflow">case</font> CSwordModuleInfo::Bible:
00595                 m_settings.sword.standardBible-&gt;insertItem(modDescript);
00596                 <font class="keywordflow">break</font>;
00597             <font class="keywordflow">case</font> CSwordModuleInfo::Commentary:
00598                 m_settings.sword.standardCommentary-&gt;insertItem(modDescript);               
00599                 <font class="keywordflow">break</font>;
00600             <font class="keywordflow">case</font> CSwordModuleInfo::Lexicon:
00601             {
00602                 m_settings.sword.standardLexicon-&gt;insertItem(modDescript);
00603                 <font class="keywordflow">if</font> (modules.current()-&gt;has(CSwordModuleInfo::HebrewDef)) {
00604                     m_settings.sword.standardHebrewStrong-&gt;insertItem(modDescript);             
00605                 }
00606                 <font class="keywordflow">if</font> (modules.current()-&gt;has(CSwordModuleInfo::GreekDef)) {
00607                     m_settings.sword.standardGreekStrong-&gt;insertItem(modDescript);              
00608                 }
00609                 <font class="keywordflow">if</font> (modules.current()-&gt;has(CSwordModuleInfo::HebrewParse)) {
00610                     m_settings.sword.standardHebrewMorph-&gt;insertItem(modDescript);              
00611                 }
00612                 <font class="keywordflow">if</font> (modules.current()-&gt;has(CSwordModuleInfo::GreekParse)) {
00613                     m_settings.sword.standardGreekMorph-&gt;insertItem(modDescript);               
00614                 }
00615                 <font class="keywordflow">break</font>;
00616             }               
00617             <font class="keywordflow">default</font>:<font class="comment">//unknown type                  </font>
00618                 <font class="keywordflow">break</font>;
00619         }
00620   }
00621 
00622 <font class="comment">//using two lists and one loop is better than six loops with almost the same code :)</font>
00623     QPtrList&lt;QComboBox&gt; comboList;
00624     comboList.setAutoDelete(<font class="keyword">false</font>);<font class="comment">//don't delete the combos accidentally</font>
00625     comboList.append(m_settings.sword.standardBible);
00626     comboList.append(m_settings.sword.standardCommentary);
00627     comboList.append(m_settings.sword.standardLexicon);
00628     comboList.append(m_settings.sword.standardHebrewStrong);
00629     comboList.append(m_settings.sword.standardGreekStrong);
00630     comboList.append(m_settings.sword.standardHebrewMorph);
00631     comboList.append(m_settings.sword.standardGreekMorph);
00632 
00633     QStringList moduleList;
00634     moduleList
00635         &lt;&lt; CBTConfig::get(CBTConfig::standardBible)
00636         &lt;&lt; CBTConfig::get(CBTConfig::standardCommentary)
00637         &lt;&lt; CBTConfig::get(CBTConfig::standardLexicon)
00638         &lt;&lt; CBTConfig::get(CBTConfig::standardHebrewStrongsLexicon)
00639         &lt;&lt; CBTConfig::get(CBTConfig::standardGreekStrongsLexicon)
00640         &lt;&lt; CBTConfig::get(CBTConfig::standardHebrewMorphLexicon)
00641         &lt;&lt; CBTConfig::get(CBTConfig::standardGreekMorphLexicon);
00642 
00643     QString module = QString::null;
00644     <font class="keywordtype">int</font> item = 0;
00645     <font class="keywordtype">int</font> count = 0;  
00646     <font class="keywordflow">for</font> (QComboBox* combo = comboList.first(); combo; combo = comboList.next() ) {      
00647         module = moduleList[comboList.at()];
00648         count = combo-&gt;count();
00649       combo-&gt;setMaximumWidth(300);
00650         <font class="keywordflow">for</font> (item = 0; item &lt; count; item++) {
00651             <font class="keywordflow">if</font> (combo-&gt;text(item) == module ) {
00652               combo-&gt;setCurrentItem(item);
00653               <font class="keywordflow">break</font>;
00654             }
00655         }
00656     }
00657 
00658     
00659 
00660 <font class="comment">// ---------- new tab: filters -------- //</font>
00661   currentTab = <font class="keyword">new</font> QFrame(tabCtl);
00662   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Filter settings"</font>));
00663   QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(currentTab,5);
00664 
00665   layout-&gt;addWidget( CToolClass::explanationLabel(currentTab, i18n(<font class="stringliteral">"Filter settings"</font>), i18n(<font class="stringliteral">"Filters control the appereance of the text in the display windows. Here you can choose the default settings of the various filter settings. You can change the settings in each display window, too."</font>)) );
00666   layout-&gt;addSpacing(5);
00667         
00668     m_settings.sword.lineBreaks = <font class="keyword">new</font> QCheckBox(currentTab);
00669     m_settings.sword.lineBreaks-&gt;setText(i18n(<font class="stringliteral">"Show line break after each verse"</font>));
00670     m_settings.sword.lineBreaks-&gt;setChecked(CBTConfig::get(CBTConfig::lineBreaks));     
00671     layout-&gt;addWidget(m_settings.sword.lineBreaks);
00672 
00673     m_settings.sword.verseNumbers = <font class="keyword">new</font> QCheckBox(currentTab);
00674     m_settings.sword.verseNumbers-&gt;setText(i18n(<font class="stringliteral">"Show verse numbers"</font>));
00675     m_settings.sword.verseNumbers-&gt;setChecked(CBTConfig::get(CBTConfig::verseNumbers));     
00676     layout-&gt;addWidget(m_settings.sword.verseNumbers);
00677 
00678     m_settings.sword.footnotes = <font class="keyword">new</font> QCheckBox(currentTab);
00679     m_settings.sword.footnotes-&gt;setText(i18n(<font class="stringliteral">"Show footnotes"</font>));
00680     m_settings.sword.footnotes-&gt;setChecked(CBTConfig::get(CBTConfig::footnotes));       
00681     layout-&gt;addWidget(m_settings.sword.footnotes);
00682 
00683     m_settings.sword.strongNumbers = <font class="keyword">new</font> QCheckBox(currentTab);
00684     m_settings.sword.strongNumbers-&gt;setText(i18n(<font class="stringliteral">"Show Strong's Numbers"</font>));
00685     m_settings.sword.strongNumbers-&gt;setChecked(CBTConfig::get(CBTConfig::strongNumbers));       
00686     layout-&gt;addWidget(m_settings.sword.strongNumbers);
00687 
00688     m_settings.sword.headings = <font class="keyword">new</font> QCheckBox(currentTab);
00689     m_settings.sword.headings-&gt;setText(i18n(<font class="stringliteral">"Show headings"</font>));
00690     m_settings.sword.headings-&gt;setChecked(CBTConfig::get(CBTConfig::headings));     
00691     layout-&gt;addWidget(m_settings.sword.headings);
00692 
00693     m_settings.sword.morphTags = <font class="keyword">new</font> QCheckBox(currentTab);
00694     m_settings.sword.morphTags-&gt;setText(i18n(<font class="stringliteral">"Show morphologic tags"</font>));
00695     m_settings.sword.morphTags-&gt;setChecked(CBTConfig::get(CBTConfig::morphTags));       
00696     layout-&gt;addWidget(m_settings.sword.morphTags);
00697 
00698     m_settings.sword.lemmas = <font class="keyword">new</font> QCheckBox(currentTab);
00699     m_settings.sword.lemmas-&gt;setText(i18n(<font class="stringliteral">"Show lemmas"</font>));
00700     m_settings.sword.lemmas-&gt;setChecked(CBTConfig::get(CBTConfig::lemmas));     
00701     layout-&gt;addWidget(m_settings.sword.lemmas);
00702         
00703     m_settings.sword.hebrewPoints = <font class="keyword">new</font> QCheckBox(currentTab);
00704     m_settings.sword.hebrewPoints-&gt;setText(i18n(<font class="stringliteral">"Show Hebrew vowel points"</font>));
00705     m_settings.sword.hebrewPoints-&gt;setChecked(CBTConfig::get(CBTConfig::hebrewPoints));     
00706     layout-&gt;addWidget(m_settings.sword.hebrewPoints);
00707 
00708     m_settings.sword.hebrewCantillation = <font class="keyword">new</font> QCheckBox(currentTab);
00709     m_settings.sword.hebrewCantillation-&gt;setText(i18n(<font class="stringliteral">"Show Hebrew cantillation marks"</font>));
00710     m_settings.sword.hebrewCantillation-&gt;setChecked(CBTConfig::get(CBTConfig::hebrewCantillation));     
00711     layout-&gt;addWidget(m_settings.sword.hebrewCantillation);
00712 
00713     m_settings.sword.greekAccents = <font class="keyword">new</font> QCheckBox(currentTab);
00714     m_settings.sword.greekAccents-&gt;setText(i18n(<font class="stringliteral">"Show Greek accents"</font>));
00715     m_settings.sword.greekAccents-&gt;setChecked(CBTConfig::get(CBTConfig::greekAccents));     
00716     layout-&gt;addWidget(m_settings.sword.greekAccents);
00717 
00718     m_settings.sword.textualVariants = <font class="keyword">new</font> QCheckBox(currentTab);
00719     m_settings.sword.textualVariants-&gt;setText(i18n(<font class="stringliteral">"Use textual variants"</font>));
00720     m_settings.sword.textualVariants-&gt;setChecked(CBTConfig::get(CBTConfig::textualVariants));       
00721     layout-&gt;addWidget(m_settings.sword.textualVariants);
00722         
00723     layout-&gt;addStretch(4);  
00724 }
00725 
00726 <font class="keywordtype">void</font> COptionsDialog::saveAccelerators(){
00727 <font class="preprocessor">#warning check</font>
00728 <font class="preprocessor"></font><font class="comment">//  m_settings.keys.application.accel-&gt;writeSettings();</font>
00729 <font class="comment">//  m_settings.keys.application.keyChooser-&gt;save();</font>
00730     m_settings.keys.application.keyChooser-&gt;commitChanges();
00731     m_settings.keys.application.accel-&gt;writeSettings();     
00732 
00733 <font class="comment">//  m_settings.keys.general.accel-&gt;writeSettings();</font>
00734 <font class="comment">//      </font>
00735 <font class="comment">//  m_settings.keys.bible.accel-&gt;writeSettings();       </font>
00736 <font class="comment">//  m_settings.keys.bible.keyChooser-&gt;save();</font>
00737     m_settings.keys.bible.keyChooser-&gt;commitChanges();
00738     m_settings.keys.bible.accel-&gt;writeSettings();
00739 
00740 <font class="comment">//      </font>
00741 <font class="comment">//  m_settings.keys.commentary.accel-&gt;writeSettings();</font>
00742 <font class="comment">//  m_settings.keys.commentary.keyChooser-&gt;save();</font>
00743     m_settings.keys.commentary.keyChooser-&gt;commitChanges();
00744     m_settings.keys.commentary.accel-&gt;writeSettings();  
00745 
00746         
00747 <font class="comment">//  m_settings.keys.lexicon.accel-&gt;writeSettings();</font>
00748 <font class="comment">//  m_settings.keys.lexicon.keyChooser-&gt;save();</font>
00749     m_settings.keys.lexicon.keyChooser-&gt;commitChanges();
00750     m_settings.keys.lexicon.accel-&gt;writeSettings();     
00751 
00752 <font class="comment">//  m_settings.keys.book.accel-&gt;writeSettings();        </font>
00753 <font class="comment">//  m_settings.keys.book.keyChooser-&gt;save();</font>
00754     m_settings.keys.book.keyChooser-&gt;commitChanges();
00755     m_settings.keys.book.accel-&gt;writeSettings();
00756 }
00757 
<a name="l00759"></a><a class="code" href="class_c_options_dialog.html#b7">00759</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b7">COptionsDialog::saveColors</a>(){
00760     CBTConfig::set(CBTConfig::textColor, m_settings.colors.text-&gt;color().name());   
00761     CBTConfig::set(CBTConfig::backgroundColor, m_settings.colors.background-&gt;color().name());   
00762 <font class="comment">//  CBTConfig::set(CBTConfig::background2Color, m_settings.colors.background2-&gt;color().name()); </font>
00763     CBTConfig::set(CBTConfig::highlightedVerseColor, m_settings.colors.highlightedVerse-&gt;color().name());       
00764     CBTConfig::set(CBTConfig::swordRefColor, m_settings.colors.swordrefs-&gt;color().name());      
00765     CBTConfig::set(CBTConfig::footnotesColor, m_settings.colors.footnotes-&gt;color().name());     
00766     CBTConfig::set(CBTConfig::strongsColor, m_settings.colors.strongs-&gt;color().name());     
00767     CBTConfig::set(CBTConfig::morphsColor, m_settings.colors.morph-&gt;color().name());        
00768     CBTConfig::set(CBTConfig::jesuswordsColor, m_settings.colors.jesuswords-&gt;color().name());       
00769 }
00770 
<a name="l00772"></a><a class="code" href="class_c_options_dialog.html#b8">00772</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b8">COptionsDialog::saveFonts</a>(){
00773     <font class="keywordflow">for</font>(QMap&lt;QString, QFont&gt;::Iterator it = m_settings.fonts.fontMap.begin(); it != m_settings.fonts.fontMap.end(); ++it ){
00774         <font class="keywordflow">if</font> (it.key() == i18n(<font class="stringliteral">"Standard"</font>)) {
00775             CBTConfig::set(CBTConfig::standard, it.data());
00776         }
00777         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (it.key() == i18n(<font class="stringliteral">"Unicode"</font>)) {
00778             QFont font = it.data();
00779 <font class="comment">//          font.setCharSet(QFont::Unicode); //try to set the unicode charset</font>
00780             CBTConfig::set(CBTConfig::unicode, font);
00781         }
00782     }
00783 }
00784 
<a name="l00786"></a><a class="code" href="class_c_options_dialog.html#b9">00786</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b9">COptionsDialog::saveProfiles</a>(){
00787 }
00788 
<a name="l00790"></a><a class="code" href="class_c_options_dialog.html#b10">00790</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b10">COptionsDialog::saveStartup</a>(){
00791     CBTConfig::set( CBTConfig::logo, m_settings.startup.showLogo-&gt;isChecked() );    
00792     CBTConfig::set( CBTConfig::tips, m_settings.startup.showTips-&gt;isChecked() );                
00793     CBTConfig::set( CBTConfig::restoreWorkspace, m_settings.startup.restoreWorkspace-&gt;isChecked() );    
00794 }
00795 
<a name="l00797"></a><a class="code" href="class_c_options_dialog.html#b11">00797</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b11">COptionsDialog::saveSword</a>(){
00798   <font class="keywordtype">bool</font> old_lexiconCache = CBTConfig::get(CBTConfig::lexiconCache);
00799   <font class="keywordtype">bool</font> new_lexiconCache = m_settings.sword.lexiconCache-&gt;isChecked();
00800         
00801   CBTConfig::set( CBTConfig::lexiconCache, new_lexiconCache );  
00802 
00803   <font class="keywordflow">if</font> (old_lexiconCache &amp;&amp; !new_lexiconCache){  <font class="comment">//delete cache files</font>
00804     QString dirname = KGlobal::dirs()-&gt;saveLocation(<font class="stringliteral">"data"</font>, <font class="stringliteral">"bibletime/cache/"</font>);
00805     QDir dir = QDir(dirname);
00806     QStringList files = QStringList( dir.entryList() );
00807     <font class="keywordflow">for</font> (QStringList::Iterator it = files.begin(); it != files.end(); ++it)
00808         dir.remove((*it),<font class="keyword">false</font>);            
00809   }
00810         
00811   CBTConfig::set(CBTConfig::standardBible, m_settings.sword.standardBible-&gt;currentText());
00812   CBTConfig::set(CBTConfig::standardCommentary, m_settings.sword.standardCommentary-&gt;currentText());
00813   CBTConfig::set(CBTConfig::standardLexicon, m_settings.sword.standardLexicon-&gt;currentText());
00814   CBTConfig::set(CBTConfig::standardHebrewStrongsLexicon, m_settings.sword.standardHebrewStrong-&gt;currentText());
00815   CBTConfig::set(CBTConfig::standardGreekStrongsLexicon, m_settings.sword.standardGreekStrong-&gt;currentText() );     
00816   CBTConfig::set(CBTConfig::standardHebrewMorphLexicon, m_settings.sword.standardHebrewMorph-&gt;currentText());
00817   CBTConfig::set(CBTConfig::standardGreekMorphLexicon, m_settings.sword.standardGreekMorph-&gt;currentText() );    
00818 
00819     <font class="keyword">const</font> QString currentText = m_settings.sword.localeCombo-&gt;currentText();
00820     list &lt;string&gt; locales = LocaleMgr::systemLocaleMgr.getAvailableLocales();
00821     QString localeName = QString::null;
00822     <font class="keywordflow">for</font> (list &lt;string&gt;::iterator it = locales.begin(); it != locales.end(); it++) {
00823         <font class="keywordflow">if</font> ( i18n(LocaleMgr::systemLocaleMgr.getLocale((*it).c_str())-&gt;getDescription()) == currentText ) {
00824             localeName = (*it).c_str(); <font class="comment">//we found the abbrevation for the current language</font>
00825             <font class="keywordflow">break</font>;
00826         }
00827     }
00828     <font class="keywordflow">if</font> (!localeName.isEmpty())
00829         CBTConfig::set(CBTConfig::language, localeName);
00830     <font class="keywordflow">else</font>
00831         CBTConfig::set(CBTConfig::language, currentText);
00832 
00833     CBTConfig::set(CBTConfig::scroll, m_settings.sword.useDownArrow-&gt;isChecked());
00834     CBTConfig::set(CBTConfig::lineBreaks, m_settings.sword.lineBreaks-&gt;isChecked());
00835     CBTConfig::set(CBTConfig::verseNumbers, m_settings.sword.verseNumbers-&gt;isChecked());
00836     CBTConfig::set(CBTConfig::footnotes, m_settings.sword.footnotes-&gt;isChecked());
00837     CBTConfig::set(CBTConfig::strongNumbers, m_settings.sword.strongNumbers-&gt;isChecked());
00838     CBTConfig::set(CBTConfig::headings, m_settings.sword.headings-&gt;isChecked());
00839     CBTConfig::set(CBTConfig::morphTags, m_settings.sword.morphTags-&gt;isChecked());
00840     CBTConfig::set(CBTConfig::lemmas, m_settings.sword.lemmas-&gt;isChecked());
00841     CBTConfig::set(CBTConfig::hebrewPoints, m_settings.sword.hebrewPoints-&gt;isChecked());
00842     CBTConfig::set(CBTConfig::hebrewCantillation, m_settings.sword.hebrewCantillation-&gt;isChecked());
00843     CBTConfig::set(CBTConfig::greekAccents, m_settings.sword.greekAccents-&gt;isChecked());
00844     CBTConfig::set(CBTConfig::textualVariants, m_settings.sword.textualVariants-&gt;isChecked());          
00845 }
</pre></div><hr><address align="right"><small>Generated on Tue Jul 16 13:53:09 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
