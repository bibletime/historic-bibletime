<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>coptionsdialog.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>coptionsdialog.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                          coptionsdialog.cpp  -  description</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Wed Jan 19 2000</font>
00005 <font class="comment">    copyright            : (C) 2000 by The BibleTime Team</font>
00006 <font class="comment">    email                : Info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="preprocessor">#include "coptionsdialog.h"</font>
00019 <font class="preprocessor">#include "cprofile.h"</font>
00020 <font class="preprocessor">#include "ctoolclass.h"</font>
00021 <font class="preprocessor">#include "presenters/cswordpresenter.h"</font>
00022 <font class="preprocessor">#include "presenters/cbiblepresenter.h"</font>
00023 <font class="preprocessor">#include "presenters/ccommentarypresenter.h"</font>
00024 <font class="preprocessor">#include "presenters/clexiconpresenter.h"</font>
00025 <font class="preprocessor">#include "presenters/cbookpresenter.h"</font>
00026 <font class="preprocessor">#include "../resource.h"</font>
00027 <font class="preprocessor">#include "../whatsthisdef.h"</font>
00028 <font class="preprocessor">#include "../backend/cswordbackend.h"</font>
00029 <font class="preprocessor">#include "../backend/cswordmoduleinfo.h"</font>
00030 <font class="preprocessor">#include "cbtconfig.h"</font>
00031 
00032 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00033 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00034 
00035 <font class="comment">//QT includes</font>
00036 <font class="preprocessor">#include &lt;qhbox.h&gt;</font>
00037 <font class="preprocessor">#include &lt;qlayout.h&gt;</font>
00038 <font class="preprocessor">#include &lt;qvbox.h&gt;</font>
00039 <font class="preprocessor">#include &lt;qdict.h&gt;</font>
00040 <font class="preprocessor">#include &lt;qcheckbox.h&gt;</font>
00041 <font class="preprocessor">#include &lt;qbuttongroup.h&gt;</font>
00042 <font class="preprocessor">#include &lt;qhbuttongroup.h&gt;</font>
00043 <font class="preprocessor">#include &lt;qradiobutton.h&gt;</font>
00044 <font class="preprocessor">#include &lt;qcolor.h&gt;</font>
00045 <font class="preprocessor">#include &lt;qtooltip.h&gt;</font>
00046 <font class="preprocessor">#include &lt;qwhatsthis.h&gt;</font>
00047 <font class="preprocessor">#include &lt;qstringlist.h&gt;</font>
00048 <font class="preprocessor">#include &lt;qinputdialog.h&gt;</font>
00049 <font class="preprocessor">#include &lt;qdir.h&gt;</font>
00050 
00051 
00052 <font class="comment">//KDE includes</font>
00053 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00054 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00055 <font class="preprocessor">#include &lt;kglobal.h&gt;</font>
00056 <font class="preprocessor">#include &lt;kstddirs.h&gt;</font>
00057 <font class="preprocessor">#include &lt;kkeydialog.h&gt;</font>
00058 <font class="preprocessor">#include &lt;kiconloader.h&gt;</font>
00059 <font class="preprocessor">#include &lt;ktabctl.h&gt;</font>
00060 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00061 <font class="preprocessor">#include &lt;klistbox.h&gt;</font>
00062 <font class="preprocessor">#include &lt;kkeydialog.h&gt;</font>
00063 
00064 <font class="comment">//Sword includes</font>
00065 <font class="preprocessor">#include &lt;localemgr.h&gt;</font>
00066 
00067 COptionsDialog::COptionsDialog(QWidget *parent, <font class="keyword">const</font> <font class="keywordtype">char</font> *name, KAccel* accel )
00068     : KDialogBase(IconList, i18n("Optionsdialog"), Ok | Cancel | Apply, Ok, parent, name, true, true, QString::null, QString::null, QString::null) {
00069 
00070     m_settings.keys.application.accel = accel;
00071     setIconListAllVisible(<font class="keyword">true</font>);
00072 
00073     initStartup();      
00074     initFonts();
00075     initColors();   
00076     initProfiles();
00077     initSword();
00078     initAccelerators();
00079 }
00080 
<a name="l00082"></a><a class="code" href="class_c_options_dialog.html#h1">00082</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h1">COptionsDialog::newDisplayWindowFontSelected</a>(<font class="keyword">const</font> QFont &amp;newFont){
00083     m_settings.fonts.fontMap.replace(m_settings.fonts.usage-&gt;currentText(), newFont);       
00084 }
00085 
<a name="l00087"></a><a class="code" href="class_c_options_dialog.html#h2">00087</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h2">COptionsDialog::newDisplayWindowFontAreaSelected</a>(<font class="keyword">const</font> QString&amp; usage){
00088     m_settings.fonts.fontChooser-&gt;setFont( m_settings.fonts.fontMap[usage] );
00089 }
00090 
<a name="l00092"></a><a class="code" href="class_c_options_dialog.html#h3">00092</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h3">COptionsDialog::slotOk</a>(){
00093     <a class="code" href="class_c_options_dialog.html#b6">saveAccelerators</a>();
00094     <a class="code" href="class_c_options_dialog.html#b7">saveColors</a>();
00095     <a class="code" href="class_c_options_dialog.html#b8">saveFonts</a>();
00096     <a class="code" href="class_c_options_dialog.html#b11">saveSword</a>();
00097     <a class="code" href="class_c_options_dialog.html#b10">saveStartup</a>();
00098     <a class="code" href="class_c_options_dialog.html#b9">saveProfiles</a>();
00099     
00100     KDialogBase::slotOk();
00101 
00102   emit signalSettingsChanged( );
00103 }
00104 
00105 <font class="comment">/*called if the apply button was clicked*/</font>
<a name="l00106"></a><a class="code" href="class_c_options_dialog.html#h4">00106</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h4">COptionsDialog::slotApply</a>(){
00107     <a class="code" href="class_c_options_dialog.html#b6">saveAccelerators</a>();
00108     <a class="code" href="class_c_options_dialog.html#b7">saveColors</a>();
00109     <a class="code" href="class_c_options_dialog.html#b8">saveFonts</a>();
00110     <a class="code" href="class_c_options_dialog.html#b11">saveSword</a>();
00111     <a class="code" href="class_c_options_dialog.html#b10">saveStartup</a>();
00112     <a class="code" href="class_c_options_dialog.html#b9">saveProfiles</a>();
00113     
00114     KDialogBase::slotApply();
00115 
00116   emit signalSettingsChanged( );
00117 }
00118 
<a name="l00120"></a><a class="code" href="class_c_options_dialog.html#h0">00120</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h0">COptionsDialog::addNewProfile</a>(){
00121     <font class="keywordtype">bool</font> ok = <font class="keyword">false</font>;
00122     QString name = QInputDialog::getText(i18n(<font class="stringliteral">"Create new profile"</font>), i18n(<font class="stringliteral">"Please enter the name of the new profile"</font>), QString::null, &amp;ok);
00123     <font class="keywordflow">if</font> (ok &amp;&amp; !name.isEmpty()) {
00124         m_settings.profiles.mgr.create(name);
00125         m_settings.profiles.profiles-&gt;insertItem(name);             
00126         <font class="keywordflow">if</font> (m_settings.profiles.profiles-&gt;count() == 1)
00127             m_settings.profiles.profiles-&gt;setEnabled(<font class="keyword">true</font>);     
00128     }
00129 }
00130 
<a name="l00132"></a><a class="code" href="class_c_options_dialog.html#h6">00132</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h6">COptionsDialog::deleteProfile</a>(){
00133     <font class="keyword">const</font> QString profile = m_settings.profiles.profiles-&gt;currentText();
00134     m_settings.profiles.mgr.remove(profile);
00135     m_settings.profiles.profiles-&gt;removeItem( m_settings.profiles.profiles-&gt;currentItem() );
00136 }
00137 
<a name="l00139"></a><a class="code" href="class_c_options_dialog.html#h5">00139</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#h5">COptionsDialog::renameProfile</a>(){
00140     <font class="keywordtype">bool</font> ok = <font class="keyword">false</font>;
00141     <font class="keyword">const</font> QString currentProfile = m_settings.profiles.profiles-&gt;currentText(); 
00142     <a class="code" href="class_c_profile.html">CProfile</a>* profile = m_settings.profiles.mgr.profile(currentProfile);
00143     <font class="keywordflow">if</font> (!profile)
00144         <font class="keywordflow">return</font>;
00145         
00146     <font class="keyword">const</font> QString newName = QInputDialog::getText(i18n(<font class="stringliteral">"Rename profile"</font>), i18n(<font class="stringliteral">"Please enter the new name of the profile"</font>),profile-&gt;<a class="code" href="class_c_profile.html#a5">name</a>(), &amp;ok);
00147     <font class="keywordflow">if</font> (ok &amp;&amp; !newName.isEmpty()) {
00148         profile-&gt;<a class="code" href="class_c_profile.html#a8">setName</a>(newName);
00149         m_settings.profiles.profiles-&gt;changeItem(newName, m_settings.profiles.profiles-&gt;currentItem());
00150     }   
00151 }
00152 
<a name="l00154"></a><a class="code" href="class_c_options_dialog.html#a1">00154</a> <font class="keyword">const</font> <font class="keywordtype">bool</font> <a class="code" href="class_c_options_dialog.html#a1">COptionsDialog::showPart</a>(  COptionsDialog::Parts ID ){
00155 <font class="preprocessor">#warning "Add the necessary case statements"</font>
00156 <font class="preprocessor"></font>    <font class="keywordtype">bool</font> ret = <font class="keyword">false</font>;
00157     <font class="keywordflow">switch</font> (ID) {
00158         <font class="keywordflow">case</font> COptionsDialog::ViewProfiles:
00159             <font class="keywordflow">if</font>(showPage(pageIndex(
00160                     m_settings.profiles.profiles-&gt;parentWidget()) ))
00161                 ret = <font class="keyword">true</font>;
00162             <font class="keywordflow">break</font>;
00163         <font class="keywordflow">default</font>:
00164             <font class="keywordflow">break</font>;
00165     }
00166 }
00167 
<a name="l00169"></a><a class="code" href="class_c_options_dialog.html#b5">00169</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b5">COptionsDialog::initStartup</a>(){
00170     QFrame* page = addPage(i18n(<font class="stringliteral">"Startup"</font>), QString::null, OD_ICON_GENERAL);
00171     QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(page,5);
00172     {<font class="comment">//daily tips</font>
00173         m_settings.startup.showTips = <font class="keyword">new</font> QCheckBox(page);
00174         m_settings.startup.showTips-&gt;setText(i18n(<font class="stringliteral">"Show tip of the day"</font>));
00175         QToolTip::add(m_settings.startup.showTips, TT_OD_GENERAL_DAILY_TIP);    
00176         QWhatsThis::add(m_settings.startup.showTips, WT_OD_GENERAL_DAILY_TIP);
00177         
00178         m_settings.startup.showTips-&gt;setChecked( CBTConfig::get(CBTConfig::tips) );
00179     }
00180     layout-&gt;addWidget(m_settings.startup.showTips);
00181     
00182     { <font class="comment">//startup logo</font>
00183         m_settings.startup.showLogo = <font class="keyword">new</font> QCheckBox(page);
00184         m_settings.startup.showLogo-&gt;setText(i18n(<font class="stringliteral">"Show startuplogo"</font>));
00185         QWhatsThis::add(m_settings.startup.showLogo, WT_OD_GENERAL_SHOW_STARTUPLOGO);
00186         QToolTip::add(m_settings.startup.showLogo, TT_OD_GENERAL_SHOW_STARTUPLOGO);     
00187         
00188         m_settings.startup.showLogo-&gt;setChecked(CBTConfig::get(CBTConfig::logo));           
00189     }       
00190     layout-&gt;addWidget(m_settings.startup.showLogo);
00191     { <font class="comment">//workspace</font>
00192         m_settings.startup.restoreWorkspace = <font class="keyword">new</font> QCheckBox(page);
00193         m_settings.startup.restoreWorkspace-&gt;setText(i18n(<font class="stringliteral">"Restore windows in workspace area"</font>));
00194         QToolTip::add(m_settings.startup.restoreWorkspace, TT_OD_GENERAL_RESTORE_WORKSPACE);        
00195         QWhatsThis::add(m_settings.startup.restoreWorkspace, WT_OD_GENERAL_RESTORE_WORKSPACE);
00196         
00197         m_settings.startup.restoreWorkspace-&gt;setChecked(CBTConfig::get(CBTConfig::restoreWorkspace));           
00198     }       
00199     layout-&gt;addWidget(m_settings.startup.restoreWorkspace);         
00200     
00201     layout-&gt;addStretch(4);
00202 }
00203 
<a name="l00205"></a><a class="code" href="class_c_options_dialog.html#b2">00205</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b2">COptionsDialog::initFonts</a>(){
00206     QFrame* page = addPage(i18n(<font class="stringliteral">"Fonts"</font>), QString::null, OD_ICON_FONTS);
00207     QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(page,5);
00208     
00209 
00210     layout-&gt;addWidget( <a class="code" href="class_c_tool_class.html#d7">CToolClass::explanationLabel</a>(page, i18n(<font class="stringliteral">"Choose fonts"</font>), i18n(<font class="stringliteral">"The fonts you can choose here are used in the display windows. Use drop-down box below to choose the area of application. Then select a font for it.&lt;BR&gt;Don't forget to choose the right charset, for example \"iso10646-1\" for unicode fonts!"</font>)) );
00211   layout-&gt;addSpacing(5);
00212                     
00213     m_settings.fonts.usage = <font class="keyword">new</font> QComboBox(page);       
00214     QToolTip::add(m_settings.fonts.usage, TT_OD_FONTS_TYPE_CHOOSER);        
00215     QWhatsThis::add(m_settings.fonts.usage, WT_OD_FONTS_TYPE_CHOOSER);  
00216     layout-&gt;addWidget(m_settings.fonts.usage);
00217         
00218     m_settings.fonts.fontMap.insert(i18n(<font class="stringliteral">"Standard"</font>), CBTConfig::get(CBTConfig::standard));
00219     m_settings.fonts.fontMap.insert(i18n(<font class="stringliteral">"Unicode"</font>), CBTConfig::get(CBTConfig::unicode));
00220 
00221     <font class="keywordflow">for</font>( QMap&lt;QString, QFont&gt;::Iterator it = m_settings.fonts.fontMap.begin(); it != m_settings.fonts.fontMap.end(); ++it )
00222         m_settings.fonts.usage-&gt;insertItem(it.key());
00223         
00224     m_settings.fonts.fontChooser = <font class="keyword">new</font> KFontChooser(page, <font class="stringliteral">"fonts"</font>, <font class="keyword">false</font>, QStringList(), <font class="keyword">true</font>, 6);
00225     m_settings.fonts.fontChooser-&gt;setSampleText(i18n(<font class="stringliteral">"The quick brown fox jumps over the lazy dog"</font>));
00226     layout-&gt;addWidget(m_settings.fonts.fontChooser);
00227         
00228   connect(m_settings.fonts.fontChooser, SIGNAL(fontSelected(<font class="keyword">const</font> QFont&amp;)), SLOT(<a class="code" href="class_c_options_dialog.html#h1">newDisplayWindowFontSelected</a>(<font class="keyword">const</font> QFont&amp;)));
00229   connect(m_settings.fonts.usage, SIGNAL(activated(<font class="keyword">const</font> QString&amp;)), SLOT(<a class="code" href="class_c_options_dialog.html#h2">newDisplayWindowFontAreaSelected</a>(<font class="keyword">const</font> QString&amp;)));
00230     QWhatsThis::add(m_settings.fonts.fontChooser, WT_OD_FONTS_CHOOSER);
00231             
00232     m_settings.fonts.fontChooser-&gt;setFont( m_settings.fonts.fontMap[m_settings.fonts.usage-&gt;currentText()] );
00233     m_settings.fonts.fontChooser-&gt;setMinimumSize(m_settings.fonts.fontChooser-&gt;sizeHint());     
00234     
00235 <font class="comment">//  page-&gt;setMinimumHeight(page-&gt;minimumSizeHint().height());</font>
00236 }
00237 
<a name="l00239"></a><a class="code" href="class_c_options_dialog.html#b4">00239</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b4">COptionsDialog::initColors</a>(){
00240     QFrame* page = addPage(i18n(<font class="stringliteral">"Colors"</font>), QString::null, OD_ICON_COLORS);
00241 <font class="comment">//  QVBoxLayout* layout = new QVBoxLayout(page);</font>
00242     QGridLayout* gridLayout = <font class="keyword">new</font> QGridLayout(page,5,5,5,5);
00243   gridLayout-&gt;setResizeMode(QLayout::Minimum);
00244         
00245   gridLayout-&gt;addMultiCellWidget(
00246     <a class="code" href="class_c_tool_class.html#d7">CToolClass::explanationLabel</a>(page,
00247         i18n(<font class="stringliteral">"Choose colors"</font>),
00248         i18n(<font class="stringliteral">"Choose the colors to change the look of the display windows to your own preferences. Some options like \"Words of Jesus\" do only apply to texts which support this special feature."</font>)
00249     ),      
00250     0,0,0,-1
00251   );
00252         
00253     m_settings.colors.text = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::textColor), page);      
00254     QLabel* label = <font class="keyword">new</font> QLabel(m_settings.colors.text, i18n(<font class="stringliteral">"Text"</font>), page);         
00255     gridLayout-&gt;addWidget(label,1,0);
00256     gridLayout-&gt;addWidget(m_settings.colors.text,1,1);
00257     
00258     m_settings.colors.background = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::backgroundColor), page);          
00259     label = <font class="keyword">new</font> QLabel(m_settings.colors.background, i18n(<font class="stringliteral">"Background"</font>), page);     
00260     gridLayout-&gt;addWidget(label,1,3);
00261     gridLayout-&gt;addWidget(m_settings.colors.background,1,4);
00262         
00263     m_settings.colors.highlightedVerse = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::highlightedVerseColor), page);
00264     label = <font class="keyword">new</font> QLabel(m_settings.colors.highlightedVerse, i18n(<font class="stringliteral">"Highlighted verse"</font>), page);
00265     gridLayout-&gt;addWidget(label,2,0);
00266     gridLayout-&gt;addWidget(m_settings.colors.highlightedVerse,2,1);
00267 
00268     m_settings.colors.swordrefs = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::swordRefColor), page);
00269     label = <font class="keyword">new</font> QLabel(m_settings.colors.swordrefs,i18n(<font class="stringliteral">"Hyperlinks"</font>), page);
00270     gridLayout-&gt;addWidget(label,2,3);
00271     gridLayout-&gt;addWidget(m_settings.colors.swordrefs,2,4);
00272 
00273     m_settings.colors.footnotes = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::footnotesColor), page);        
00274     label = <font class="keyword">new</font> QLabel(m_settings.colors.footnotes,i18n(<font class="stringliteral">"Footnotes"</font>), page);            
00275     gridLayout-&gt;addWidget(label,3,0);
00276     gridLayout-&gt;addWidget(m_settings.colors.footnotes,3,1);
00277 
00278     m_settings.colors.strongs = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::strongsColor), page);        
00279     label = <font class="keyword">new</font> QLabel(m_settings.colors.strongs, i18n(<font class="stringliteral">"Strong's numbers"</font>), page);          
00280     gridLayout-&gt;addWidget(label,3,3);
00281     gridLayout-&gt;addWidget(m_settings.colors.strongs,3,4);
00282 
00283     m_settings.colors.morph = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::morphsColor), page);       
00284     label = <font class="keyword">new</font> QLabel(m_settings.colors.morph, i18n(<font class="stringliteral">"Morphologic tags"</font>), page);            
00285     gridLayout-&gt;addWidget(label,4,0);
00286     gridLayout-&gt;addWidget(m_settings.colors.morph,4,1);
00287 
00288     m_settings.colors.jesuswords = <font class="keyword">new</font> KColorButton(CBTConfig::get(CBTConfig::jesuswordsColor), page);      
00289     label = <font class="keyword">new</font> QLabel(m_settings.colors.jesuswords, i18n(<font class="stringliteral">"Words of Jesus"</font>), page);         
00290     gridLayout-&gt;addWidget(label,4,3);
00291     gridLayout-&gt;addWidget(m_settings.colors.jesuswords,4,4);
00292     
00293     gridLayout-&gt;setRowStretch(5, 5);
00294     gridLayout-&gt;addColSpacing(3, 5);
00295 }
00296 
<a name="l00298"></a><a class="code" href="class_c_options_dialog.html#b3">00298</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b3">COptionsDialog::initProfiles</a>(){
00299     QFrame* page = addPage(i18n(<font class="stringliteral">"Profiles"</font>),QString::null, OD_ICON_PROFILES);
00300     QGridLayout* gridLayout = <font class="keyword">new</font> QGridLayout(page, 3,3,5,5);
00301 
00302     gridLayout-&gt;addMultiCellWidget(
00303         <a class="code" href="class_c_tool_class.html#d7">CToolClass::explanationLabel</a>(page,
00304             i18n(<font class="stringliteral">"Manage your profiles"</font>),
00305             i18n(<font class="stringliteral">"Profiles define the appereance of the work area, \</font>
00306 <font class="stringliteral">for example which windows are open and which texts should displayed in these windows. \</font>
00307 <font class="stringliteral">Don't forget that new profiles only work after you've saved something in them."</font>)
00308         ),
00309         0,0,0,-1
00310     );
00311     
00312     m_settings.profiles.profiles = <font class="keyword">new</font> QListBox(page);                  
00313     gridLayout-&gt;addMultiCellWidget(m_settings.profiles.profiles, 1,1,0,-1);
00314     gridLayout-&gt;setRowStretch(1,10);
00315     
00316     m_settings.profiles.createProfile = <font class="keyword">new</font> QPushButton(i18n(<font class="stringliteral">"Create new profile"</font>), page);
00317     connect(m_settings.profiles.createProfile, SIGNAL(clicked()), SLOT(<a class="code" href="class_c_options_dialog.html#h0">addNewProfile</a>()));
00318   gridLayout-&gt;addWidget(m_settings.profiles.createProfile,2,0);
00319         
00320     m_settings.profiles.deleteProfile = <font class="keyword">new</font> QPushButton(i18n(<font class="stringliteral">"Delete selected profile"</font>), page); 
00321     connect(m_settings.profiles.deleteProfile, SIGNAL(clicked()), SLOT(<a class="code" href="class_c_options_dialog.html#h6">deleteProfile</a>()));
00322   gridLayout-&gt;addWidget(m_settings.profiles.deleteProfile,2,1);
00323         
00324     m_settings.profiles.renameProfile = <font class="keyword">new</font> QPushButton(i18n(<font class="stringliteral">"Rename selected profile"</font>), page);     
00325     connect(m_settings.profiles.renameProfile, SIGNAL(clicked()), SLOT(<a class="code" href="class_c_options_dialog.html#h5">renameProfile</a>()));
00326   gridLayout-&gt;addWidget(m_settings.profiles.renameProfile,2,2); 
00327 
00328   <font class="comment">//fill the profile list box</font>
00329     QList&lt;CProfile&gt; profiles = m_settings.profiles.mgr.profiles();
00330     <font class="keywordflow">if</font> (profiles.count()) {
00331         <font class="keywordflow">for</font> (<a class="code" href="class_c_profile.html">CProfile</a>* p = profiles.first(); p; p = profiles.next()) {
00332             m_settings.profiles.profiles-&gt;insertItem(p-&gt;<a class="code" href="class_c_profile.html#a5">name</a>());
00333         }   
00334     }
00335     <font class="keywordflow">else</font> {
00336         m_settings.profiles.profiles-&gt;setEnabled(<font class="keyword">false</font>);
00337     }
00338 }
00339 
<a name="l00341"></a><a class="code" href="class_c_options_dialog.html#b1">00341</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b1">COptionsDialog::initAccelerators</a>(){
00342     QVBox* page = addVBoxPage(i18n(<font class="stringliteral">"Accelerators"</font>),QString::null, OD_ICON_KEY_BINDINGS);
00343 
00344   KTabCtl* tabCtl = <font class="keyword">new</font> KTabCtl(page);
00345   QFrame* currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00346     currentTab-&gt;setMargin(3);   
00347   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Application wide"</font>));
00348 
00349     m_settings.keys.application.dict = m_settings.keys.application.accel-&gt;keyDict();
00350     m_settings.keys.application.keyChooser = <font class="keyword">new</font> KKeyChooser( &amp;m_settings.keys.application.dict, currentTab, <font class="keyword">false</font> );   
00351     QToolTip::add(m_settings.keys.application.keyChooser, TT_OD_KEYS_CHOOSER);
00352     QWhatsThis::add(m_settings.keys.application.keyChooser, WT_OD_KEYS_CHOOSER);    
00353 
00354 <font class="comment">// ----- new tab: All display windows ------ //</font>
00355 <font class="comment">//  currentTab = new QVBox(tabCtl);</font>
00356 <font class="comment">//  currentTab-&gt;setMargin(3);   </font>
00357 <font class="comment">//  tabCtl-&gt;addTab(currentTab, i18n("All display windows"));</font>
00358 <font class="comment">//  </font>
00359 <font class="comment">//  m_settings.keys.general.accel = new KAccel(this); //delete in destructor</font>
00360 <font class="comment">//  CSwordPresenter::insertKeyboardActions( m_settings.keys.general.accel );        </font>
00361 <font class="comment">//  m_settings.keys.general.accel-&gt;readSettings();</font>
00362 <font class="comment">//  m_settings.keys.general.dict = m_settings.keys.general.accel-&gt;keyDict();</font>
00363 <font class="comment">//  m_settings.keys.general.keyChooser = new KKeyChooser( &amp;m_settings.keys.general.dict, currentTab, false );   </font>
00364 <font class="comment">//  QToolTip::add(m_settings.keys.general.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_GENERAL);</font>
00365 <font class="comment">//  QWhatsThis::add(m_settings.keys.general.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_GENERAL);</font>
00366 
00367 <font class="comment">// ----- new tab: Bible windows ------ //</font>
00368     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00369     currentTab-&gt;setMargin(3);   
00370     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Bible windows"</font>));
00371 
00372     m_settings.keys.bible.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00373     <a class="code" href="class_c_bible_presenter.html#d0">CBiblePresenter::insertKeyboardActions</a>( m_settings.keys.bible.accel );
00374     m_settings.keys.bible.accel-&gt;readSettings();        
00375     m_settings.keys.bible.dict = m_settings.keys.bible.accel-&gt;keyDict();
00376     m_settings.keys.bible.keyChooser = <font class="keyword">new</font> KKeyChooser( &amp;m_settings.keys.bible.dict, currentTab, <font class="keyword">false</font> );   
00377     QToolTip::add(m_settings.keys.bible.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_BIBLE);
00378     QWhatsThis::add(m_settings.keys.bible.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_BIBLE);
00379 
00380 <font class="comment">// ----- new tab: Commentary windows ------ //</font>
00381     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00382     currentTab-&gt;setMargin(3);   
00383     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Commentary windows"</font>));
00384 
00385     m_settings.keys.commentary.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00386     <a class="code" href="class_c_commentary_presenter.html#d0">CCommentaryPresenter::insertKeyboardActions</a>( m_settings.keys.commentary.accel );        
00387     m_settings.keys.commentary.accel-&gt;readSettings();   
00388     m_settings.keys.commentary.dict = m_settings.keys.commentary.accel-&gt;keyDict();
00389     m_settings.keys.commentary.keyChooser = <font class="keyword">new</font> KKeyChooser( &amp;m_settings.keys.commentary.dict, currentTab, <font class="keyword">false</font> ); 
00390     QToolTip::add(m_settings.keys.commentary.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_COMMENTARY);
00391     QWhatsThis::add(m_settings.keys.commentary.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_COMMENTARY);
00392 
00393 <font class="comment">// ----- new tab: Lexicon windows ------ //</font>
00394     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00395     currentTab-&gt;setMargin(3);   
00396     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Lexicon windows"</font>));
00397 
00398     m_settings.keys.lexicon.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00399     <a class="code" href="class_c_lexicon_presenter.html#d0">CLexiconPresenter::insertKeyboardActions</a>( m_settings.keys.lexicon.accel );      
00400     m_settings.keys.lexicon.accel-&gt;readSettings();      
00401     m_settings.keys.lexicon.dict = m_settings.keys.lexicon.accel-&gt;keyDict();    
00402     m_settings.keys.lexicon.keyChooser = <font class="keyword">new</font> KKeyChooser( &amp;m_settings.keys.lexicon.dict, currentTab, <font class="keyword">false</font> );   
00403     QToolTip::add(m_settings.keys.lexicon.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_LEXICON);
00404     QWhatsThis::add(m_settings.keys.lexicon.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_LEXICON);
00405 
00406     
00407 <font class="comment">// ----- new tab: Lexicon windows ------ //</font>
00408     currentTab = <font class="keyword">new</font> QVBox(tabCtl);
00409     currentTab-&gt;setMargin(3);   
00410     tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Book windows"</font>));
00411 
00412     m_settings.keys.book.accel = <font class="keyword">new</font> KAccel(<font class="keyword">this</font>); <font class="comment">//delete in destructor</font>
00413     CBookPresenter::insertKeyboardActions( m_settings.keys.book.accel );        
00414     m_settings.keys.book.accel-&gt;readSettings();     
00415     m_settings.keys.book.dict = m_settings.keys.book.accel-&gt;keyDict();  
00416     m_settings.keys.book.keyChooser = <font class="keyword">new</font> KKeyChooser( &amp;m_settings.keys.book.dict, currentTab, <font class="keyword">false</font> ); 
00417 <font class="comment">//  QToolTip::add(m_settings.keys.book.keyChooser, TT_OD_DISPLAY_WINDOW_KEYS_LEXICON);</font>
00418 <font class="comment">//  QWhatsThis::add(m_settings.keys.book.keyChooser, WT_OD_DISPLAY_WINDOW_KEYS_LEXICON);</font>
00419                         
00420 }
00421 
<a name="l00423"></a><a class="code" href="class_c_options_dialog.html#b0">00423</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b0">COptionsDialog::initSword</a>(){
00424     QVBox* page = addVBoxPage(i18n(<font class="stringliteral">"Sword"</font>),QString::null, OD_ICON_SWORD);
00425   KTabCtl* tabCtl = <font class="keyword">new</font> KTabCtl(page);
00426   QFrame* currentTab = <font class="keyword">new</font> QFrame(tabCtl);
00427   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"General"</font>));
00428 
00429   QGridLayout* gridLayout = <font class="keyword">new</font> QGridLayout(currentTab,7,2,5,5);
00430     gridLayout-&gt;setResizeMode(QLayout::Minimum);
00431     
00432   gridLayout-&gt;addMultiCellWidget(
00433     <a class="code" href="class_c_tool_class.html#d7">CToolClass::explanationLabel</a>(currentTab, i18n(<font class="stringliteral">"Use key cache for lexicons"</font>),
00434             i18n(<font class="stringliteral">"BibleTime can create a key cache for lexicons, which speeds up opening large lexicon modules a lot. \</font>
00435 <font class="stringliteral">However these files consume some disk space (usually not much), and reside in \</font>
00436 <font class="stringliteral">$KDEHOME/share/apps/bibletime/cache."</font>)),
00437         0,0,0,-1
00438   );
00439     
00440     m_settings.sword.lexiconCache = <font class="keyword">new</font> QCheckBox(currentTab);
00441     m_settings.sword.lexiconCache-&gt;setText(i18n(<font class="stringliteral">"Use key cache for lexicons"</font>));
00442     QToolTip::add(m_settings.sword.lexiconCache, TT_OD_SWORD_USE_LEXICON_CACHE);    
00443     QWhatsThis::add(m_settings.sword.lexiconCache, WT_OD_SWORD_USE_LEXICON_CACHE);
00444         
00445     m_settings.sword.lexiconCache-&gt;setChecked( CBTConfig::get(CBTConfig::lexiconCache) );
00446     gridLayout-&gt;addMultiCellWidget(m_settings.sword.lexiconCache,1,1,0,-1);
00447 
00448   gridLayout-&gt;addMultiCellWidget(
00449     <a class="code" href="class_c_tool_class.html#d7">CToolClass::explanationLabel</a>(currentTab, i18n(<font class="stringliteral">"Scrolling behaviour"</font>),
00450             i18n(<font class="stringliteral">"The down arrow moves to the &lt;i&gt;next&lt;/i&gt; verse by default. Uncheck this box \</font>
00451 <font class="stringliteral">if you want it to move to the &lt;i&gt;previous&lt;/i&gt; verse."</font>)),
00452         2,2,0,-1
00453   );
00454         
00455     m_settings.sword.useDownArrow = <font class="keyword">new</font> QCheckBox(currentTab);
00456     m_settings.sword.useDownArrow-&gt;setText(i18n(<font class="stringliteral">"Use down arrow to scroll to next verse"</font>));
00457     m_settings.sword.useDownArrow-&gt;setChecked(CBTConfig::get(CBTConfig::scroll));       
00458     QWhatsThis::add(m_settings.sword.useDownArrow, WT_OD_GENERAL_SCROLL_PREVIOUS);
00459     QToolTip::add(m_settings.sword.useDownArrow, TT_OD_GENERAL_SCROLL_PREVIOUS);
00460     gridLayout-&gt;addMultiCellWidget(m_settings.sword.useDownArrow,3,3,0,-1);
00461 
00462   gridLayout-&gt;addMultiCellWidget(
00463     <a class="code" href="class_c_tool_class.html#d7">CToolClass::explanationLabel</a>(currentTab, i18n(<font class="stringliteral">"Specify a language for biblical booknames"</font>),
00464             i18n(<font class="stringliteral">"Sword has a number of locales available which can be used to internationalize the \</font>
00465 <font class="stringliteral">booknames of the bible. You can specify which locale to choose. If you want to \</font>
00466 <font class="stringliteral">create a new locale, see http://www.crosswire.org/sword/develop for details."</font>)),
00467         4,4,0,-1
00468   );
00469         
00470     m_settings.sword.localeCombo = <font class="keyword">new</font> QComboBox(currentTab);
00471     QLabel* label = <font class="keyword">new</font> QLabel(m_settings.sword.localeCombo, i18n(<font class="stringliteral">"Language for booknames"</font>), currentTab);   
00472     QToolTip::add(m_settings.sword.localeCombo, TT_OD_GENERAL_INTERNATIONAL_BOOKNAMES);             
00473     QWhatsThis::add(m_settings.sword.localeCombo, WT_OD_GENERAL_INTERNATIONAL_BOOKNAMES);       
00474     gridLayout-&gt;addWidget(label, 5,0);
00475     gridLayout-&gt;addWidget(m_settings.sword.localeCombo, 5,1);
00476 
00477     gridLayout-&gt;setRowStretch(6,5); <font class="comment">//eat up remaining space :)</font>
00478                                                 
00479     m_settings.sword.localeCombo-&gt;insertItem( i18n(<font class="stringliteral">"English"</font>) );
00480     list &lt;string&gt; locales = LocaleMgr::systemLocaleMgr.getAvailableLocales();
00481     <font class="keywordflow">for</font> (list &lt;string&gt;::iterator it = locales.begin(); it != locales.end(); it++) {
00482         m_settings.sword.localeCombo-&gt;insertItem( i18n(LocaleMgr::systemLocaleMgr.getLocale((*it).c_str())-&gt;getDescription()) );
00483     }
00484 
00485     <font class="keywordtype">int</font> current_item = -1;
00486     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> test_item = 0; test_item &lt; m_settings.sword.localeCombo-&gt;count(); test_item++) {
00487         SWLocale* locale = LocaleMgr::systemLocaleMgr.getLocale(CBTConfig::get(CBTConfig::language).local8Bit());
00488         <font class="keywordflow">if</font> (locale &amp;&amp; m_settings.sword.localeCombo-&gt;text(test_item).contains(i18n(locale-&gt;getDescription())) )
00489             current_item = test_item;
00490     }
00491     <font class="keywordflow">if</font> (current_item!=-1)
00492         m_settings.sword.localeCombo-&gt;setCurrentItem(current_item);
00493 
00494 
00495 <font class="comment">// ---------- new tab: Default modules -------- //</font>
00496   currentTab = <font class="keyword">new</font> QFrame(tabCtl);
00497   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Default modules"</font>));
00498     gridLayout = <font class="keyword">new</font> QGridLayout(currentTab,9,2, 5,5); <font class="comment">//the last row is for stretching available space</font>
00499     gridLayout-&gt;setResizeMode(QLayout::Minimum);
00500 
00501   gridLayout-&gt;addMultiCellWidget(
00502     <a class="code" href="class_c_tool_class.html#d7">CToolClass::explanationLabel</a>(currentTab, i18n(<font class="stringliteral">"Default modules"</font>), i18n(<font class="stringliteral">"Default modules are used, when no module is specified. This may happen with references into modules like Bibles or Lexicons."</font>)),
00503     0,0,0,-1 <font class="comment">/*fill the horizontal space*/</font>
00504   );
00505     
00506     m_settings.sword.standardBible = <font class="keyword">new</font> QComboBox(currentTab);
00507   label = <font class="keyword">new</font> QLabel(m_settings.sword.standardBible, i18n(<font class="stringliteral">"Default Bible"</font>), currentTab);
00508   label-&gt;setAutoResize(<font class="keyword">true</font>);
00509     QToolTip::add(m_settings.sword.standardBible, TT_OD_SWORD_STANDARD_BIBLE);  
00510     QWhatsThis::add(m_settings.sword.standardBible, WT_OD_SWORD_STANDARD_BIBLE);        
00511     gridLayout-&gt;addWidget(label,1,0);   
00512     gridLayout-&gt;addWidget(m_settings.sword.standardBible,1,1);
00513         
00514     m_settings.sword.standardCommentary = <font class="keyword">new</font> QComboBox(currentTab);
00515     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardCommentary, i18n(<font class="stringliteral">"Default Commentary"</font>), currentTab);
00516   label-&gt;setAutoResize(<font class="keyword">true</font>);   
00517     QToolTip::add(m_settings.sword.standardCommentary, TT_OD_SWORD_STANDARD_COMMENTARY);    
00518     QWhatsThis::add(m_settings.sword.standardCommentary, WT_OD_SWORD_STANDARD_COMMENTARY);      
00519     gridLayout-&gt;addWidget(label,2,0);
00520     gridLayout-&gt;addWidget(m_settings.sword.standardCommentary,2,1);
00521 
00522 
00523     m_settings.sword.standardLexicon = <font class="keyword">new</font> QComboBox(currentTab);
00524     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardLexicon, i18n(<font class="stringliteral">"Default Lexicon"</font>), currentTab);
00525   label-&gt;setAutoResize(<font class="keyword">true</font>);   
00526     QToolTip::add(m_settings.sword.standardLexicon, TT_OD_SWORD_STANDARD_LEXICON);  
00527     QWhatsThis::add(m_settings.sword.standardLexicon, WT_OD_SWORD_STANDARD_LEXICON);        
00528     gridLayout-&gt;addWidget(label,3,0);   
00529     gridLayout-&gt;addWidget(m_settings.sword.standardLexicon,3,1);    
00530         
00531     m_settings.sword.standardHebrewStrong = <font class="keyword">new</font> QComboBox(currentTab);
00532     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardHebrewStrong, i18n(<font class="stringliteral">"Default Hebrew Strong's Lexicon"</font>), currentTab);
00533   label-&gt;setAutoResize(<font class="keyword">true</font>);       
00534     QToolTip::add(m_settings.sword.standardHebrewStrong, TT_OD_SWORD_STANDARD_HEBREW_STRONG);
00535     QWhatsThis::add(m_settings.sword.standardHebrewStrong, WT_OD_SWORD_STANDARD_HEBREW_STRONG);
00536     gridLayout-&gt;addWidget(label,4,0);
00537     gridLayout-&gt;addWidget(m_settings.sword.standardHebrewStrong,4,1);
00538         
00539     m_settings.sword.standardGreekStrong = <font class="keyword">new</font> QComboBox(currentTab);
00540     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardGreekStrong, i18n(<font class="stringliteral">"Default Greek Strong's Lexicon"</font>), currentTab);
00541   label-&gt;setAutoResize(<font class="keyword">true</font>);       
00542     QToolTip::add(m_settings.sword.standardGreekStrong, TT_OD_SWORD_STANDARD_GREEK_STRONG);     
00543     QWhatsThis::add(m_settings.sword.standardGreekStrong, WT_OD_SWORD_STANDARD_GREEK_STRONG);
00544     gridLayout-&gt;addWidget(label,5,0);
00545     gridLayout-&gt;addWidget(m_settings.sword.standardGreekStrong,5,1);
00546         
00547     m_settings.sword.standardHebrewMorph = <font class="keyword">new</font> QComboBox(currentTab);
00548     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardHebrewMorph, i18n(<font class="stringliteral">"Default Hebrew Morphological Lexicon"</font>), currentTab);
00549     QToolTip::add(m_settings.sword.standardHebrewMorph, TT_OD_SWORD_STANDARD_HEBREW_MORPH);
00550     QWhatsThis::add(m_settings.sword.standardHebrewMorph, WT_OD_SWORD_STANDARD_HEBREW_MORPH);
00551     gridLayout-&gt;addWidget(label,6,0);
00552     gridLayout-&gt;addWidget(m_settings.sword.standardHebrewMorph,6,1);
00553 
00554     m_settings.sword.standardGreekMorph = <font class="keyword">new</font> QComboBox(currentTab);
00555     label = <font class="keyword">new</font> QLabel(m_settings.sword.standardGreekMorph, i18n(<font class="stringliteral">"Default Greek Morphological Lexicon"</font>), currentTab);
00556   label-&gt;setAutoResize(<font class="keyword">true</font>);       
00557     QToolTip::add(m_settings.sword.standardGreekMorph, TT_OD_SWORD_STANDARD_GREEK_MORPH);
00558     QWhatsThis::add(m_settings.sword.standardGreekMorph, WT_OD_SWORD_STANDARD_GREEK_MORPH);
00559     gridLayout-&gt;addWidget(label,7,0);
00560     gridLayout-&gt;addWidget(m_settings.sword.standardGreekMorph,7,1);
00561 
00562     gridLayout-&gt;setRowStretch(8,5);                         
00563         
00564     <font class="comment">//fill the comboboxes with the right modules</font>
00565     ListCSwordModuleInfo* modules = <a class="code" href="class_c_pointers.html#d1">backend</a>()-&gt;<a class="code" href="class_c_sword_backend.html#a2">moduleList</a>();
00566     QString modDescript;
00567   <font class="keywordflow">for</font> ( modules-&gt;first(); modules-&gt;current(); modules-&gt;next() ) {
00568         modDescript = modules-&gt;current()-&gt;config(CSwordModuleInfo::Description);
00569         <font class="keywordflow">switch</font> (modules-&gt;current()-&gt;type()) {
00570             <font class="keywordflow">case</font> CSwordModuleInfo::Bible:
00571                 m_settings.sword.standardBible-&gt;insertItem(modDescript);
00572                 <font class="keywordflow">break</font>;
00573             <font class="keywordflow">case</font> CSwordModuleInfo::Commentary:
00574                 m_settings.sword.standardCommentary-&gt;insertItem(modDescript);               
00575                 <font class="keywordflow">break</font>;
00576             <font class="keywordflow">case</font> CSwordModuleInfo::Lexicon:
00577             {
00578                 m_settings.sword.standardLexicon-&gt;insertItem(modDescript);
00579                 <font class="keywordflow">if</font> (modules-&gt;current()-&gt;has(CSwordModuleInfo::HebrewDef)) {
00580                     m_settings.sword.standardHebrewStrong-&gt;insertItem(modDescript);             
00581                 }
00582                 <font class="keywordflow">if</font> (modules-&gt;current()-&gt;has(CSwordModuleInfo::GreekDef)) {
00583                     m_settings.sword.standardGreekStrong-&gt;insertItem(modDescript);              
00584                 }
00585                 <font class="keywordflow">if</font> (modules-&gt;current()-&gt;has(CSwordModuleInfo::HebrewParse)) {
00586                     m_settings.sword.standardHebrewMorph-&gt;insertItem(modDescript);              
00587                 }
00588                 <font class="keywordflow">if</font> (modules-&gt;current()-&gt;has(CSwordModuleInfo::GreekParse)) {
00589                     m_settings.sword.standardGreekMorph-&gt;insertItem(modDescript);               
00590                 }
00591                 <font class="keywordflow">break</font>;
00592             }               
00593             <font class="keywordflow">default</font>:<font class="comment">//unknown type                  </font>
00594                 <font class="keywordflow">break</font>;
00595         }
00596   }
00597 
00598 <font class="comment">//using two lists and one loop is better than six loops with almost the same code :)</font>
00599     QList&lt;QComboBox&gt; comboList;
00600     comboList.setAutoDelete(<font class="keyword">false</font>);<font class="comment">//don't delete the combos accidentally</font>
00601     comboList.append(m_settings.sword.standardBible);
00602     comboList.append(m_settings.sword.standardCommentary);
00603     comboList.append(m_settings.sword.standardLexicon);
00604     comboList.append(m_settings.sword.standardHebrewStrong);
00605     comboList.append(m_settings.sword.standardGreekStrong);
00606     comboList.append(m_settings.sword.standardHebrewMorph);
00607     comboList.append(m_settings.sword.standardGreekMorph);
00608 
00609     QStringList moduleList;
00610     moduleList
00611         &lt;&lt; CBTConfig::get(CBTConfig::standardBible)
00612         &lt;&lt; CBTConfig::get(CBTConfig::standardCommentary)
00613         &lt;&lt; CBTConfig::get(CBTConfig::standardLexicon)
00614         &lt;&lt; CBTConfig::get(CBTConfig::standardHebrewStrongsLexicon)
00615         &lt;&lt; CBTConfig::get(CBTConfig::standardGreekStrongsLexicon)
00616         &lt;&lt; CBTConfig::get(CBTConfig::standardHebrewMorphLexicon)
00617         &lt;&lt; CBTConfig::get(CBTConfig::standardGreekMorphLexicon);
00618 
00619     QString module = QString::null;
00620     <font class="keywordtype">int</font> item = 0;
00621     <font class="keywordtype">int</font> count = 0;  
00622     <font class="keywordflow">for</font> (QComboBox* combo = comboList.first(); combo; combo = comboList.next() ) {      
00623         module = moduleList[comboList.at()];
00624         count = combo-&gt;count();
00625       combo-&gt;setMaximumWidth(300);
00626         <font class="keywordflow">for</font> (item = 0; item &lt; count; item++) {
00627             <font class="keywordflow">if</font> (combo-&gt;text(item) == module ) {
00628               combo-&gt;setCurrentItem(item);
00629               <font class="keywordflow">break</font>;
00630             }
00631         }
00632     }
00633 
00634     
00635 
00636 <font class="comment">// ---------- new tab: filters -------- //</font>
00637   currentTab = <font class="keyword">new</font> QFrame(tabCtl);
00638   tabCtl-&gt;addTab(currentTab, i18n(<font class="stringliteral">"Filter settings"</font>));
00639   QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(currentTab,5);
00640 
00641   layout-&gt;addWidget( <a class="code" href="class_c_tool_class.html#d7">CToolClass::explanationLabel</a>(currentTab, i18n(<font class="stringliteral">"Filter settings"</font>), i18n(<font class="stringliteral">"Filters control the appereance of the text in the display windows. Here you can choose the default settings of the various filter settings. You can change the settings in each display window, too."</font>)) );
00642   layout-&gt;addSpacing(5);
00643         
00644     m_settings.sword.lineBreaks = <font class="keyword">new</font> QCheckBox(currentTab);
00645     m_settings.sword.lineBreaks-&gt;setText(i18n(<font class="stringliteral">"Show line break after each verse"</font>));
00646     m_settings.sword.lineBreaks-&gt;setChecked(CBTConfig::get(CBTConfig::lineBreaks));     
00647     layout-&gt;addWidget(m_settings.sword.lineBreaks);
00648 
00649     m_settings.sword.verseNumbers = <font class="keyword">new</font> QCheckBox(currentTab);
00650     m_settings.sword.verseNumbers-&gt;setText(i18n(<font class="stringliteral">"Show verse numbers"</font>));
00651     m_settings.sword.verseNumbers-&gt;setChecked(CBTConfig::get(CBTConfig::verseNumbers));     
00652     layout-&gt;addWidget(m_settings.sword.verseNumbers);
00653 
00654     m_settings.sword.footnotes = <font class="keyword">new</font> QCheckBox(currentTab);
00655     m_settings.sword.footnotes-&gt;setText(i18n(<font class="stringliteral">"Show footnotes"</font>));
00656     m_settings.sword.footnotes-&gt;setChecked(CBTConfig::get(CBTConfig::footnotes));       
00657     layout-&gt;addWidget(m_settings.sword.footnotes);
00658 
00659     m_settings.sword.strongNumbers = <font class="keyword">new</font> QCheckBox(currentTab);
00660     m_settings.sword.strongNumbers-&gt;setText(i18n(<font class="stringliteral">"Show Strong's Numbers"</font>));
00661     m_settings.sword.strongNumbers-&gt;setChecked(CBTConfig::get(CBTConfig::strongNumbers));       
00662     layout-&gt;addWidget(m_settings.sword.strongNumbers);
00663 
00664     m_settings.sword.headings = <font class="keyword">new</font> QCheckBox(currentTab);
00665     m_settings.sword.headings-&gt;setText(i18n(<font class="stringliteral">"Show headings"</font>));
00666     m_settings.sword.headings-&gt;setChecked(CBTConfig::get(CBTConfig::headings));     
00667     layout-&gt;addWidget(m_settings.sword.headings);
00668 
00669     m_settings.sword.morphTags = <font class="keyword">new</font> QCheckBox(currentTab);
00670     m_settings.sword.morphTags-&gt;setText(i18n(<font class="stringliteral">"Show morphologic tags"</font>));
00671     m_settings.sword.morphTags-&gt;setChecked(CBTConfig::get(CBTConfig::morphTags));       
00672     layout-&gt;addWidget(m_settings.sword.morphTags);
00673 
00674     m_settings.sword.lemmas = <font class="keyword">new</font> QCheckBox(currentTab);
00675     m_settings.sword.lemmas-&gt;setText(i18n(<font class="stringliteral">"Show lemmas"</font>));
00676     m_settings.sword.lemmas-&gt;setChecked(CBTConfig::get(CBTConfig::lemmas));     
00677     layout-&gt;addWidget(m_settings.sword.lemmas);
00678         
00679     m_settings.sword.hebrewPoints = <font class="keyword">new</font> QCheckBox(currentTab);
00680     m_settings.sword.hebrewPoints-&gt;setText(i18n(<font class="stringliteral">"Show Hebrew vowel points"</font>));
00681     m_settings.sword.hebrewPoints-&gt;setChecked(CBTConfig::get(CBTConfig::hebrewPoints));     
00682     layout-&gt;addWidget(m_settings.sword.hebrewPoints);
00683 
00684     m_settings.sword.hebrewCantillation = <font class="keyword">new</font> QCheckBox(currentTab);
00685     m_settings.sword.hebrewCantillation-&gt;setText(i18n(<font class="stringliteral">"Show Hebrew cantillation marks"</font>));
00686     m_settings.sword.hebrewCantillation-&gt;setChecked(CBTConfig::get(CBTConfig::hebrewCantillation));     
00687     layout-&gt;addWidget(m_settings.sword.hebrewCantillation);
00688 
00689     m_settings.sword.greekAccents = <font class="keyword">new</font> QCheckBox(currentTab);
00690     m_settings.sword.greekAccents-&gt;setText(i18n(<font class="stringliteral">"Show Greek accents"</font>));
00691     m_settings.sword.greekAccents-&gt;setChecked(CBTConfig::get(CBTConfig::greekAccents));     
00692     layout-&gt;addWidget(m_settings.sword.greekAccents);
00693     
00694     layout-&gt;addStretch(4);  
00695 }
00696 
<a name="l00697"></a><a class="code" href="class_c_options_dialog.html#b6">00697</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b6">COptionsDialog::saveAccelerators</a>(){
00698     m_settings.keys.application.accel-&gt;setKeyDict( m_settings.keys.application.dict );  
00699     m_settings.keys.application.accel-&gt;writeSettings();     
00700     
00701 <font class="comment">//  m_settings.keys.general.accel-&gt;setKeyDict( m_settings.keys.general.dict );          </font>
00702 <font class="comment">//  m_settings.keys.general.accel-&gt;writeSettings();</font>
00703         
00704     m_settings.keys.bible.accel-&gt;setKeyDict( m_settings.keys.bible.dict );                  
00705     m_settings.keys.bible.accel-&gt;writeSettings();       
00706         
00707     m_settings.keys.commentary.accel-&gt;setKeyDict( m_settings.keys.commentary.dict );                    
00708     m_settings.keys.commentary.accel-&gt;writeSettings();
00709         
00710     m_settings.keys.lexicon.accel-&gt;setKeyDict( m_settings.keys.lexicon.dict );                  
00711     m_settings.keys.lexicon.accel-&gt;writeSettings();
00712 
00713     m_settings.keys.book.accel-&gt;setKeyDict( m_settings.keys.book.dict );                    
00714     m_settings.keys.book.accel-&gt;writeSettings();        
00715 }
00716 
<a name="l00718"></a><a class="code" href="class_c_options_dialog.html#b7">00718</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b7">COptionsDialog::saveColors</a>(){
00719     CBTConfig::set(CBTConfig::textColor, m_settings.colors.text-&gt;color().name());   
00720     CBTConfig::set(CBTConfig::backgroundColor, m_settings.colors.background-&gt;color().name());   
00721     CBTConfig::set(CBTConfig::highlightedVerseColor, m_settings.colors.highlightedVerse-&gt;color().name());       
00722     CBTConfig::set(CBTConfig::swordRefColor, m_settings.colors.swordrefs-&gt;color().name());      
00723     CBTConfig::set(CBTConfig::footnotesColor, m_settings.colors.footnotes-&gt;color().name());     
00724     CBTConfig::set(CBTConfig::strongsColor, m_settings.colors.strongs-&gt;color().name());     
00725     CBTConfig::set(CBTConfig::morphsColor, m_settings.colors.morph-&gt;color().name());        
00726     CBTConfig::set(CBTConfig::jesuswordsColor, m_settings.colors.jesuswords-&gt;color().name());       
00727 }
00728 
<a name="l00730"></a><a class="code" href="class_c_options_dialog.html#b8">00730</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b8">COptionsDialog::saveFonts</a>(){
00731     <font class="keywordflow">for</font>(QMap&lt;QString, QFont&gt;::Iterator it = m_settings.fonts.fontMap.begin(); it != m_settings.fonts.fontMap.end(); ++it ){
00732         <font class="keywordflow">if</font> (it.key() == i18n(<font class="stringliteral">"Standard"</font>))
00733             CBTConfig::set(CBTConfig::standard, it.data());
00734         <font class="keywordflow">else</font> <font class="keywordflow">if</font> (it.key() == i18n(<font class="stringliteral">"Unicode"</font>))
00735             CBTConfig::set(CBTConfig::unicode, it.data());
00736     }
00737 }
00738 
<a name="l00740"></a><a class="code" href="class_c_options_dialog.html#b9">00740</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b9">COptionsDialog::saveProfiles</a>(){
00741 }
00742 
<a name="l00744"></a><a class="code" href="class_c_options_dialog.html#b10">00744</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b10">COptionsDialog::saveStartup</a>(){
00745     CBTConfig::set( CBTConfig::logo, m_settings.startup.showLogo-&gt;isChecked() );    
00746     CBTConfig::set( CBTConfig::tips, m_settings.startup.showTips-&gt;isChecked() );                
00747     CBTConfig::set( CBTConfig::restoreWorkspace, m_settings.startup.restoreWorkspace-&gt;isChecked() );    
00748 }
00749 
<a name="l00751"></a><a class="code" href="class_c_options_dialog.html#b11">00751</a> <font class="keywordtype">void</font> <a class="code" href="class_c_options_dialog.html#b11">COptionsDialog::saveSword</a>(){
00752   <font class="keywordtype">bool</font> old_lexiconCache = CBTConfig::get(CBTConfig::lexiconCache);
00753   <font class="keywordtype">bool</font> new_lexiconCache = m_settings.sword.lexiconCache-&gt;isChecked();
00754         
00755   CBTConfig::set( CBTConfig::lexiconCache, new_lexiconCache );  
00756 
00757   <font class="keywordflow">if</font> (old_lexiconCache &amp;&amp; !new_lexiconCache){  <font class="comment">//delete cache files</font>
00758     QString dirname = KGlobal::dirs()-&gt;saveLocation(<font class="stringliteral">"data"</font>, <font class="stringliteral">"bibletime/cache/"</font>);
00759     QDir dir = QDir(dirname);
00760     QStringList files = QStringList( dir.entryList() );
00761     <font class="keywordflow">for</font> (QStringList::Iterator it = files.begin(); it != files.end(); ++it)
00762         dir.remove((*it),<font class="keyword">false</font>);            
00763   }
00764         
00765   CBTConfig::set(CBTConfig::standardBible, m_settings.sword.standardBible-&gt;currentText());
00766   CBTConfig::set(CBTConfig::standardCommentary, m_settings.sword.standardCommentary-&gt;currentText());
00767   CBTConfig::set(CBTConfig::standardLexicon, m_settings.sword.standardLexicon-&gt;currentText());
00768   CBTConfig::set(CBTConfig::standardHebrewStrongsLexicon, m_settings.sword.standardHebrewStrong-&gt;currentText());
00769   CBTConfig::set(CBTConfig::standardGreekStrongsLexicon, m_settings.sword.standardGreekStrong-&gt;currentText() );     
00770   CBTConfig::set(CBTConfig::standardHebrewMorphLexicon, m_settings.sword.standardHebrewMorph-&gt;currentText());
00771   CBTConfig::set(CBTConfig::standardGreekMorphLexicon, m_settings.sword.standardGreekMorph-&gt;currentText() );    
00772 
00773     <font class="keyword">const</font> QString currentText = m_settings.sword.localeCombo-&gt;currentText();
00774     list &lt;string&gt; locales = LocaleMgr::systemLocaleMgr.getAvailableLocales();
00775     QString localeName = QString::null;
00776     <font class="keywordflow">for</font> (list &lt;string&gt;::iterator it = locales.begin(); it != locales.end(); it++) {
00777         <font class="keywordflow">if</font> ( i18n(LocaleMgr::systemLocaleMgr.getLocale((*it).c_str())-&gt;getDescription()) == currentText ) {
00778             localeName = (*it).c_str(); <font class="comment">//we found the abbrevation for the current language</font>
00779             <font class="keywordflow">break</font>;
00780         }
00781     }
00782     <font class="keywordflow">if</font> (!localeName.isEmpty())
00783         CBTConfig::set(CBTConfig::language, localeName);
00784     <font class="keywordflow">else</font>
00785         CBTConfig::set(CBTConfig::language, currentText);
00786 
00787     CBTConfig::set(CBTConfig::scroll, m_settings.sword.useDownArrow-&gt;isChecked());
00788     CBTConfig::set(CBTConfig::lineBreaks, m_settings.sword.lineBreaks-&gt;isChecked());
00789     CBTConfig::set(CBTConfig::verseNumbers, m_settings.sword.verseNumbers-&gt;isChecked());
00790     CBTConfig::set(CBTConfig::footnotes, m_settings.sword.footnotes-&gt;isChecked());
00791     CBTConfig::set(CBTConfig::strongNumbers, m_settings.sword.strongNumbers-&gt;isChecked());
00792     CBTConfig::set(CBTConfig::headings, m_settings.sword.headings-&gt;isChecked());
00793     CBTConfig::set(CBTConfig::morphTags, m_settings.sword.morphTags-&gt;isChecked());
00794     CBTConfig::set(CBTConfig::lemmas, m_settings.sword.lemmas-&gt;isChecked());
00795     CBTConfig::set(CBTConfig::hebrewPoints, m_settings.sword.hebrewPoints-&gt;isChecked());
00796     CBTConfig::set(CBTConfig::hebrewCantillation, m_settings.sword.hebrewCantillation-&gt;isChecked());
00797     CBTConfig::set(CBTConfig::greekAccents, m_settings.sword.greekAccents-&gt;isChecked());        
00798 }
</pre></div><hr><address><small>Generated on Sun Mar 10 22:12:46 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
