<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>csearchdialog.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>csearchdialog.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                       csearchdialog.cpp  -  description</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Wed Jan 19 2000</font>
00005 <font class="comment">    copyright            : (C) 2000 by The BibleTime Team</font>
00006 <font class="comment">    email                : Info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="preprocessor">#include "csearchdialog.h"</font>
00019 <font class="preprocessor">#include "csearchdialogmodulechooser.h"</font>
00020 <font class="preprocessor">#include "csearchdialogtext.h"</font>
00021 <font class="preprocessor">#include "csearchdialogresult.h"</font>
00022 <font class="preprocessor">#include "csearchdialoganalysis.h"</font>
00023 <font class="preprocessor">#include "csearchdialogscope.h"</font>
00024 <font class="preprocessor">#include "../chtmldialog.h"</font>
00025 <font class="preprocessor">#include "../../resource.h"</font>
00026 <font class="preprocessor">#include "../../backend/cswordmodulesearch.h"</font>
00027 <font class="preprocessor">#include "../../backend/cswordversekey.h"</font>
00028 <font class="preprocessor">#include "../../backend/cswordmoduleinfo.h"</font>
00029 <font class="preprocessor">#include "../ctoolclass.h"</font>
00030 <font class="preprocessor">#include "../cbtconfig.h"</font>
00031 
00032 <font class="comment">//KDE includes</font>
00033 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00034 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00035 <font class="preprocessor">#include &lt;kkeydialog.h&gt;</font>
00036 <font class="preprocessor">#include &lt;kfontdialog.h&gt;</font>
00037 <font class="preprocessor">#include &lt;kfiledialog.h&gt;</font>
00038 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00039 
00040 <font class="comment">//QT includes</font>
00041 <font class="preprocessor">#include &lt;qlabel.h&gt;</font>
00042 <font class="preprocessor">#include &lt;qframe.h&gt;</font>
00043 <font class="preprocessor">#include &lt;qbutton.h&gt;</font>
00044 <font class="preprocessor">#include &lt;qdict.h&gt;</font>
00045 <font class="preprocessor">#include &lt;qlayout.h&gt;</font>
00046 <font class="preprocessor">#include &lt;qhbox.h&gt;</font>
00047 <font class="preprocessor">#include &lt;qvbox.h&gt;</font>
00048 <font class="preprocessor">#include &lt;qgrid.h&gt;</font>
00049 <font class="preprocessor">#include &lt;qhbuttongroup.h&gt;</font>
00050 <font class="preprocessor">#include &lt;qpushbutton.h&gt;</font>
00051 <font class="preprocessor">#include &lt;qcanvas.h&gt;</font>
00052 
<a name="l00053"></a><a class="code" href="class_c_search_dialog.html#a0">00053</a> <a class="code" href="class_c_search_dialog.html#a0">CSearchDialog::CSearchDialog</a>( ListCSwordModuleInfo&amp; modules, QWidget *parent, <font class="keyword">const</font> <font class="keywordtype">char</font> *name )
00054     : KDialogBase(Tabbed, i18n("Search Dialog"), Close | User1 | User2, User1, parent, name,    false, true, i18n("Search"), i18n("Interrupt"), QString::null)
00055 {
00056     setIcon(MODULE_SEARCH_ICON_SMALL);
00057     m_searcher.<a class="code" href="class_c_sword_module_search.html#a14">connectPercentUpdate</a>(<font class="keyword">this</font>, SLOT(<a class="code" href="class_c_search_dialog.html#i5">percentUpdate</a>()));
00058     m_searcher.<a class="code" href="class_c_sword_module_search.html#a15">connectFinished</a>(<font class="keyword">this</font>, SLOT(<a class="code" href="class_c_search_dialog.html#i4">searchFinished</a>()));
00059         
00060     <a class="code" href="class_c_search_dialog.html#b0">initView</a>(); 
00061     <a class="code" href="class_c_search_dialog.html#b1">readSettings</a>(); 
00062         
00063     <a class="code" href="class_c_search_dialog.html#a3">setModuleList</a>( modules );
00064     <font class="keywordflow">if</font> (modules.count())
00065         showPage(pageIndex(m_searchTextPage));      
00066 }
00067 
00068 CSearchDialog::~CSearchDialog(){
00069     <a class="code" href="class_c_search_dialog.html#b2">saveSettings</a>(); 
00070 }
00071 
<a name="l00073"></a><a class="code" href="class_c_search_dialog.html#b1">00073</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#b1">CSearchDialog::readSettings</a>(){
00074 }
00075 
<a name="l00077"></a><a class="code" href="class_c_search_dialog.html#b2">00077</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#b2">CSearchDialog::saveSettings</a>(){
00078 }
00079 
<a name="l00081"></a><a class="code" href="class_c_search_dialog.html#b0">00081</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#b0">CSearchDialog::initView</a>() {
00082     enableButton(User2,<font class="keyword">false</font>);
00083 
00084     m_moduleChooserPage     = addVBoxPage(i18n(<font class="stringliteral">"Choose modules"</font>), i18n(<font class="stringliteral">"Choose the modules for the search"</font>));
00085     m_moduleChooser         = <font class="keyword">new</font> <a class="code" href="class_c_search_dialog_module_chooser.html">CSearchDialogModuleChooser</a>(m_moduleChooserPage);
00086     connect(m_moduleChooser, SIGNAL(<a class="code" href="class_c_search_dialog.html#i0">chosenModulesChanged</a>()), SLOT(<a class="code" href="class_c_search_dialog.html#i0">chosenModulesChanged</a>()));
00087     
00088     m_searchTextPage = addVBoxPage(i18n(<font class="stringliteral">"Search Text"</font>), i18n(<font class="stringliteral">"Enter the text to search for"</font>));
00089     m_searchText            = <font class="keyword">new</font> <a class="code" href="class_c_search_dialog_text.html">CSearchDialogText</a>(m_searchTextPage);
00090     m_searchTextPage-&gt;setEnabled(<font class="keyword">false</font>);
00091     
00092     m_searchResultPage = addHBoxPage(i18n(<font class="stringliteral">"Search Result"</font>), i18n(<font class="stringliteral">"The result of your search"</font>));
00093     m_searchResult = <font class="keyword">new</font> CSearchDialogResult(m_searchResultPage);
00094     m_searchResultPage-&gt;setEnabled(<font class="keyword">false</font>);
00095     
00096     m_searchAnalysisPage = addVBoxPage(i18n(<font class="stringliteral">"Search Analysis"</font>), i18n(<font class="stringliteral">"Graphical analysis of your search result"</font>));  
00097     m_searchAnalysis = <font class="keyword">new</font> <a class="code" href="class_c_search_dialog_analysis.html">CSearchDialogAnalysis</a>(m_searchAnalysisPage);
00098     m_searchAnalysisView =  <font class="keyword">new</font> CSearchDialogAnalysisView(m_searchAnalysis, m_searchAnalysisPage);
00099     m_searchAnalysisPage-&gt;setEnabled(<font class="keyword">false</font>);
00100 
00101     m_searchAnalysisSaveButton = <font class="keyword">new</font> QPushButton(<font class="stringliteral">"Save Analysis to Disk"</font>, m_searchAnalysisPage);
00102 
00103     connect(m_searchAnalysisSaveButton, SIGNAL(clicked()),
00104         <font class="keyword">this</font>, SLOT(slotSaveSearchAnalysis()));  
00105 }
00106 
00107 ListCSwordModuleInfo&amp; CSearchDialog::getModuleList() {
00108 <font class="comment">//  ASSERT(moduleList);</font>
00109     m_moduleList = m_moduleChooser-&gt;<a class="code" href="class_c_search_dialog_module_chooser.html#a3">getChosenModules</a>();
00110     <font class="keywordflow">return</font> m_moduleList;
00111 }
00112 
<a name="l00113"></a><a class="code" href="class_c_search_dialog.html#a3">00113</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#a3">CSearchDialog::setModuleList</a>(ListCSwordModuleInfo&amp; list) {
00114     <font class="keywordflow">if</font> (m_moduleList != list)
00115         m_moduleList = list; <font class="comment">//copy the items of "list"</font>
00116     
00117     m_moduleChooser-&gt;blockSignals(<font class="keyword">true</font>);
00118     m_moduleChooser-&gt;<a class="code" href="class_c_search_dialog_module_chooser.html#a2">setChosenModules</a>(m_moduleList);
00119     m_moduleChooser-&gt;blockSignals(<font class="keyword">false</font>);   
00120     
00121     m_searchTextPage-&gt;setEnabled(m_moduleList.count()&gt;0);   
00122     m_searchResult-&gt;clearResult();
00123     m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a4">reset</a>();
00124 }
00125 
00126 <font class="keywordtype">void</font> CSearchDialog::slotSaveSearchAnalysis(){
00127     <font class="keyword">const</font> QString file = KFileDialog::getSaveFileName(QString::null, QString::fromLatin1(<font class="stringliteral">"*.html | %1"</font>).arg(i18n(<font class="stringliteral">"HTML files"</font>)), 0, i18n(<font class="stringliteral">"Save Search Analysis"</font>));
00128     <font class="keywordflow">if</font> (!file.isNull()) {
00129         <font class="keywordtype">int</font> moduleIndex = 0;
00130         <font class="keywordtype">int</font> count = 0;
00131         QString countStr = <font class="stringliteral">""</font>;
00132         QString m_searchAnalysisHTML = <font class="stringliteral">""</font>;
00133         QString tableTitle = <font class="stringliteral">""</font>;
00134       QString tableTotals = <font class="stringliteral">""</font>;
00135         QString VerseRange = <font class="stringliteral">""</font>;
00136         <font class="keyword">const</font> QString txtCSS = QString::fromLatin1(<font class="stringliteral">"&lt;style type='text/css'&gt;\nTD {border: thin solid black;}\nTH {font-size: 130%;text-align: left;vertical-align:top;}\n&lt;/style&gt;\n"</font>);   
00137         <a class="code" href="class_c_sword_verse_key.html">CSwordVerseKey</a> key(0);
00138         ListKey searchResult;
00139         
00140         key.<a class="code" href="class_c_sword_verse_key.html#a5">key</a>(<font class="stringliteral">"Genesis 1:1"</font>);
00141     
00142         <font class="keywordflow">if</font> (m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a3">getScopeType</a>() != CSwordModuleSearch::Scope_NoScope) {
00143             ListKey verses = m_searcher.<a class="code" href="class_c_sword_module_search.html#a13">scope</a>();
00144             <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; verses.Count(); ++i) {
00145                 VerseKey* element = dynamic_cast&lt;VerseKey*&gt;(verses.GetElement(i));
00146                 <font class="keywordflow">if</font> (element) {
00147                     VerseRange += QString(<font class="stringliteral">"%1 - %2"</font>).arg(QString::fromLocal8Bit((<font class="keyword">const</font> <font class="keywordtype">char</font>*)element-&gt;LowerBound())).arg(QString::fromLocal8Bit((<font class="keyword">const</font> <font class="keywordtype">char</font>*)element-&gt;UpperBound())) + <font class="stringliteral">"&lt;br&gt;"</font>;
00148                 }
00149             }
00150         }
00151 
00152         QDict&lt;CSearchDialogAnalysisItem&gt;* m_searchAnalysisItems = m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a5">getSearchAnalysisItemList</a>();
00153         <a class="code" href="class_c_search_dialog_analysis_item.html">CSearchDialogAnalysisItem</a>* analysisItem = m_searchAnalysisItems-&gt;find( key.<a class="code" href="class_c_sword_verse_key.html#a9">book</a>() );
00154         
00155     QString text = <font class="stringliteral">"&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;"</font> + i18n(<font class="stringliteral">"BibleTime Search Analysis"</font>) + <font class="stringliteral">"&lt;/title&gt;\n"</font> + txtCSS + <font class="stringliteral">"&lt;/head&gt;\n&lt;body&gt;\n"</font>;
00156         text += <font class="stringliteral">"&lt;table&gt;\n&lt;tr&gt;&lt;th&gt;"</font> + i18n(<font class="stringliteral">"Search Text :"</font>) + <font class="stringliteral">"&lt;/th&gt;&lt;th&gt;"</font> + m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a2">getText</a>() + <font class="stringliteral">"&lt;/th&gt;&lt;/tr&gt;\n"</font>;
00157         text += <font class="stringliteral">"&lt;tr&gt;&lt;th&gt;"</font> + i18n(<font class="stringliteral">"Search Type :"</font>) + <font class="stringliteral">"&lt;/th&gt;&lt;th&gt;"</font> + m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a6">getSearchTypeString</a>() + <font class="stringliteral">"&lt;/th&gt;&lt;/tr&gt;\n"</font>;
00158         text += <font class="stringliteral">"&lt;tr&gt;&lt;th&gt;"</font> + i18n(<font class="stringliteral">"Search Scope:"</font>) + <font class="stringliteral">"&lt;/th&gt;&lt;th&gt;"</font> + ((m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a3">getScopeType</a>() != CSwordModuleSearch::Scope_NoScope) ? VerseRange : m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a4">getScopeTypeString</a>()) + <font class="stringliteral">"&lt;/th&gt;&lt;/tr&gt;\n&lt;/table&gt;\n&lt;br&gt;\n"</font>;
00159 
00160 
00161       tableTitle = <font class="stringliteral">"&lt;tr&gt;&lt;th align=\"left\"&gt;"</font> + i18n(<font class="stringliteral">"Book"</font>) + <font class="stringliteral">"&lt;/th&gt;"</font>;
00162         tableTotals = <font class="stringliteral">"&lt;tr&gt;&lt;td align=\"left\"&gt;"</font> + i18n(<font class="stringliteral">"Total Hits"</font>) + <font class="stringliteral">"&lt;/td&gt;"</font>;
00163         <font class="keywordflow">for</font> (moduleIndex = 0,m_moduleList.first(); m_moduleList.current(); m_moduleList.next(),++moduleIndex) {
00164                 tableTitle += QString::fromLatin1(<font class="stringliteral">"&lt;th align=\"left\"&gt;"</font>) + m_moduleList.current()-&gt;name() + QString::fromLatin1(<font class="stringliteral">"&lt;/th&gt;"</font>);
00165                 searchResult = m_moduleList.current()-&gt;searchResult();
00166                 countStr.setNum(searchResult.Count());
00167           tableTotals += QString::fromLatin1(<font class="stringliteral">"&lt;td align=\"right\"&gt;"</font>) + countStr + QString::fromLatin1(<font class="stringliteral">"&lt;/td&gt;"</font>);
00168         }
00169         tableTitle += QString::fromLatin1(<font class="stringliteral">"&lt;/tr&gt;\n"</font>);
00170         tableTotals += QString::fromLatin1(<font class="stringliteral">"&lt;/tr&gt;\n"</font>);
00171 
00172         m_searchAnalysisHTML = <font class="stringliteral">""</font>;
00173         <font class="keywordtype">bool</font> ok = <font class="keyword">true</font>;     
00174         <font class="keywordflow">while</font> (ok) {
00175             m_searchAnalysisHTML += QString::fromLatin1(<font class="stringliteral">"&lt;tr&gt;&lt;td&gt;"</font>) + key.<a class="code" href="class_c_sword_verse_key.html#a9">book</a>() + QString::fromLatin1(<font class="stringliteral">"&lt;/td&gt;"</font>);
00176             analysisItem = m_searchAnalysisItems-&gt;find( key.<a class="code" href="class_c_sword_verse_key.html#a9">book</a>() );
00177             <font class="keywordflow">for</font> (moduleIndex = 0,m_moduleList.first(); m_moduleList.current(); m_moduleList.next(), ++moduleIndex) {
00178                 count = analysisItem-&gt;<a class="code" href="class_c_search_dialog_analysis_item.html#a3">getCountForModule</a>(moduleIndex);
00179                 countStr.setNum(count);
00180                 m_searchAnalysisHTML += QString::fromLatin1(<font class="stringliteral">"&lt;td align=\"right\"&gt;"</font>) + countStr + QString::fromLatin1(<font class="stringliteral">"&lt;/td&gt;"</font>);
00181             }
00182             m_searchAnalysisHTML += QString::fromLatin1(<font class="stringliteral">"&lt;/tr&gt;\n"</font>);
00183             ok = key.<a class="code" href="class_c_sword_verse_key.html#a7">next</a>(CSwordVerseKey::UseBook);
00184         }
00185         text += QString::fromLatin1(<font class="stringliteral">"&lt;table&gt;\n"</font>) + tableTitle + tableTotals + m_searchAnalysisHTML + QString::fromLatin1(<font class="stringliteral">"&lt;/table&gt;\n"</font>);
00186         text += QString::fromLatin1(<font class="stringliteral">"&lt;center&gt;"</font>) + i18n(<font class="stringliteral">"Created by"</font>) + QString::fromLatin1(<font class="stringliteral">" &lt;a href=\"http://www.bibletime.de/\"&gt;BibleTime&lt;/a&gt;&lt;/center&gt;"</font>);
00187         text += QString::fromLatin1(<font class="stringliteral">"&lt;/body&gt;&lt;/html&gt;"</font>);
00188         <a class="code" href="class_c_tool_class.html#d4">CToolClass::savePlainFile</a>(file, text);
00189     }
00190 }
00191 
00192 <font class="keywordtype">void</font> CSearchDialog::slotUser1() {
00193     startSearch();
00194 }
00195 
00196 <font class="keywordtype">void</font> CSearchDialog::slotUser2() {
00197 <font class="comment">//  if (searcher-&gt;isSearching())</font>
00198     m_searcher.<a class="code" href="class_c_sword_module_search.html#a7">interruptSearch</a>();
00199 }
00200 
00201 <font class="keywordtype">void</font> CSearchDialog::startSearch(<font class="keywordtype">void</font>) {
00202     <font class="keywordtype">int</font> searchFlags = m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a5">getSearchType</a>();    
00203     <font class="comment">// set the parameters</font>
00204     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a7">updateCurrentProgress</a>(0);
00205     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a8">updateOverallProgress</a>(0);
00206     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a3">setText</a>( m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a2">getText</a>() );
00207         
00208     m_searcher.<a class="code" href="class_c_sword_module_search.html#a4">setModules</a>( getModuleList() );
00209     m_searcher.<a class="code" href="class_c_sword_module_search.html#a2">setSearchedText</a>(m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a2">getText</a>());
00210 
00211     <font class="keywordflow">if</font> (m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a4">isCaseSensitive</a>())
00212         searchFlags |= CSwordModuleSearch::caseSensitive;
00213     m_searcher.<a class="code" href="class_c_sword_module_search.html#a6">resetSearchScope</a>();
00214     CSwordModuleSearch::scopeType scopeType = m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a3">getScopeType</a>();
00215     
00216     <font class="keywordflow">if</font> (scopeType == CSwordModuleSearch::Scope_LastSearch) {
00217         searchFlags |= CSwordModuleSearch::useLastResult;
00218     }
00219     <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( scopeType == CSwordModuleSearch::Scope_Bounds ) {
00220         searchFlags |= CSwordModuleSearch::useScope;    
00221         m_searcher.<a class="code" href="class_c_sword_module_search.html#a5">setSearchScope</a>( m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a2">getScope</a>() );
00222     }
00223     m_searcher.<a class="code" href="class_c_sword_module_search.html#a10">setSearchOptions</a>(searchFlags);
00224     enableButton(User1,<font class="keyword">false</font>);
00225     enableButton(User2,<font class="keyword">true</font>);
00226     m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a4">reset</a>();
00227     m_searchResult-&gt;clearResult();
00228         
00229     m_searcher.<a class="code" href="class_c_sword_module_search.html#a9">startSearchThread</a>();
00230 }
00231 
<a name="l00232"></a><a class="code" href="class_c_search_dialog.html#a4">00232</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#a4">CSearchDialog::setSearchText</a>(<font class="keyword">const</font> QString text){
00233   m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a3">setText</a>(text);
00234     <font class="keywordflow">if</font> (!text.isEmpty())
00235         showPage(pageIndex(m_searchTextPage));
00236 }
00237 
<a name="l00239"></a><a class="code" href="class_c_search_dialog.html#a5">00239</a> <font class="keyword">const</font> QString <a class="code" href="class_c_search_dialog.html#a5">CSearchDialog::getSearchedText</a>()<font class="keyword"> const </font>{
00240     qWarning(<font class="stringliteral">"searchedText: %s"</font>, m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a2">getText</a>().latin1());
00241     <font class="keywordflow">return</font> m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a2">getText</a>();
00242 }
00243 
<a name="l00245"></a><a class="code" href="class_c_search_dialog.html#i0">00245</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#i0">CSearchDialog::chosenModulesChanged</a>(){
00246     <a class="code" href="class_c_search_dialog.html#a3">setModuleList</a>(getModuleList());
00247 }
00248 
<a name="l00250"></a><a class="code" href="class_c_search_dialog.html#g0">00250</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#g0">CSearchDialog::show</a>(){
00251     KDialogBase::show();
00252 
00253     <font class="keywordflow">if</font> ( CBTConfig::get(CBTConfig::firstSearchDialog) ){
00254         HTML_DIALOG(HELPDIALOG_FIRSTTIME_SEARCH)
00255         CBTConfig::set(CBTConfig::firstSearchDialog, <font class="keyword">false</font>);
00256     }           
00257 }
00258 
<a name="l00260"></a><a class="code" href="class_c_search_dialog.html#i4">00260</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#i4">CSearchDialog::searchFinished</a>(){
00261 <font class="comment">//  qWarning("CSearchDialog::searchFinished()");</font>
00262     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a7">updateCurrentProgress</a>(100);
00263     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a8">updateOverallProgress</a>(100);
00264     m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a4">reset</a>();
00265     <font class="keywordflow">if</font> ( m_searcher.<a class="code" href="class_c_sword_module_search.html#a8">foundItems</a>() ){
00266         m_searchResult-&gt;setModuleList(getModuleList());         
00267         m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a2">setModuleList</a>(getModuleList());
00268         m_searchAnalysisView-&gt;setContentsPos(0,0);
00269         m_searchResultPage-&gt;setEnabled(<font class="keyword">true</font>);
00270         m_searchAnalysisPage-&gt;setEnabled(<font class="keyword">true</font>);                     
00271         showPage(pageIndex(m_searchResultPage));    <font class="comment">//the result page</font>
00272                         
00273         m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a3">analyse</a>();            
00274     }
00275     <font class="keywordflow">else</font>
00276         m_searchResult-&gt;clearResult();
00277 
00278     enableButton(User2,<font class="keyword">false</font>);
00279     enableButton(User1,<font class="keyword">true</font>);   
00280 }
00281 
<a name="l00283"></a><a class="code" href="class_c_search_dialog.html#i5">00283</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#i5">CSearchDialog::percentUpdate</a>(){
00284 <font class="comment">//  old_overallProgress = m_searcher.getPercent(CSwordModuleSearch::currentModule);</font>
00285     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a8">updateOverallProgress</a>(m_searcher.<a class="code" href="class_c_sword_module_search.html#a11">getPercent</a>(CSwordModuleSearch::allModules));
00286     
00287 <font class="comment">//  old_currentProgress = m_searcher.getPercent(CSwordModuleSearch::currentModule);</font>
00288     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a7">updateCurrentProgress</a>(m_searcher.<a class="code" href="class_c_sword_module_search.html#a11">getPercent</a>(CSwordModuleSearch::currentModule));
00289     KApplication::kapp-&gt;processEvents();
00290 }
</pre></div><hr><address><small>Generated on Sun Mar 10 22:12:47 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
