<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>csearchdialog.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>csearchdialog.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                       csearchdialog.cpp  -  description</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Wed Jan 19 2000</font>
00005 <font class="comment">    copyright            : (C) 2000 by The BibleTime Team</font>
00006 <font class="comment">    email                : Info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="preprocessor">#include "csearchdialog.h"</font>
00019 <font class="preprocessor">#include "csearchdialogmodulechooser.h"</font>
00020 <font class="preprocessor">#include "csearchdialogtext.h"</font>
00021 <font class="preprocessor">#include "csearchdialogresult.h"</font>
00022 <font class="preprocessor">#include "csearchdialoganalysis.h"</font>
00023 <font class="preprocessor">#include "csearchdialogscope.h"</font>
00024 
00025 <font class="preprocessor">#include "backend/cswordmodulesearch.h"</font>
00026 <font class="preprocessor">#include "backend/cswordversekey.h"</font>
00027 <font class="preprocessor">#include "backend/cswordmoduleinfo.h"</font>
00028 
00029 <font class="preprocessor">#include "frontend/ctoolclass.h"</font>
00030 <font class="preprocessor">#include "frontend/cbtconfig.h"</font>
00031 <font class="preprocessor">#include "frontend/chtmldialog.h"</font>
00032 
00033 <font class="preprocessor">#include "resource.h"</font>
00034 
00035 <font class="comment">//KDE includes</font>
00036 <font class="preprocessor">#include &lt;kapplication.h&gt;</font>
00037 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00038 <font class="preprocessor">#include &lt;kkeydialog.h&gt;</font>
00039 <font class="preprocessor">#include &lt;kfontdialog.h&gt;</font>
00040 <font class="preprocessor">#include &lt;kfiledialog.h&gt;</font>
00041 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00042 
00043 <font class="comment">//QT includes</font>
00044 <font class="preprocessor">#include &lt;qlabel.h&gt;</font>
00045 <font class="preprocessor">#include &lt;qframe.h&gt;</font>
00046 <font class="preprocessor">#include &lt;qbutton.h&gt;</font>
00047 <font class="preprocessor">#include &lt;qdict.h&gt;</font>
00048 <font class="preprocessor">#include &lt;qlayout.h&gt;</font>
00049 <font class="preprocessor">#include &lt;qhbox.h&gt;</font>
00050 <font class="preprocessor">#include &lt;qvbox.h&gt;</font>
00051 <font class="preprocessor">#include &lt;qgrid.h&gt;</font>
00052 <font class="preprocessor">#include &lt;qhbuttongroup.h&gt;</font>
00053 <font class="preprocessor">#include &lt;qpushbutton.h&gt;</font>
00054 <font class="preprocessor">#include &lt;qcanvas.h&gt;</font>
00055 
<a name="l00056"></a><a class="code" href="class_c_search_dialog.html#a0">00056</a> <a class="code" href="class_c_search_dialog.html#a0">CSearchDialog::CSearchDialog</a>( ListCSwordModuleInfo&amp; modules, QWidget *parent, <font class="keyword">const</font> <font class="keywordtype">char</font> *name )
00057     : KDialogBase(Tabbed, i18n("Search Dialog"), Close | User1 | User2, User1, parent, name,    false, true, i18n("Search"), i18n("Interrupt"), QString::null)
00058 {
00059     setIcon(MODULE_SEARCH_ICON_SMALL);
00060     m_searcher.<a class="code" href="class_c_sword_module_search.html#a14">connectPercentUpdate</a>(<font class="keyword">this</font>, SLOT(<a class="code" href="class_c_search_dialog.html#i5">percentUpdate</a>()));
00061     m_searcher.<a class="code" href="class_c_sword_module_search.html#a15">connectFinished</a>(<font class="keyword">this</font>, SLOT(<a class="code" href="class_c_search_dialog.html#i4">searchFinished</a>()));
00062         
00063     <a class="code" href="class_c_search_dialog.html#b0">initView</a>(); 
00064     <a class="code" href="class_c_search_dialog.html#b1">readSettings</a>(); 
00065         
00066     <a class="code" href="class_c_search_dialog.html#a3">setModuleList</a>( modules );
00067     <font class="keywordflow">if</font> (modules.count())
00068         showPage(pageIndex(m_searchTextPage));      
00069 }
00070 
00071 CSearchDialog::~CSearchDialog(){
00072     <a class="code" href="class_c_search_dialog.html#b2">saveSettings</a>(); 
00073 }
00074 
<a name="l00076"></a><a class="code" href="class_c_search_dialog.html#b1">00076</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#b1">CSearchDialog::readSettings</a>(){
00077 }
00078 
<a name="l00080"></a><a class="code" href="class_c_search_dialog.html#b2">00080</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#b2">CSearchDialog::saveSettings</a>(){
00081 }
00082 
<a name="l00084"></a><a class="code" href="class_c_search_dialog.html#b0">00084</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#b0">CSearchDialog::initView</a>() {
00085     enableButton(User2,<font class="keyword">false</font>);
00086 
00087     m_moduleChooserPage     = addVBoxPage(i18n(<font class="stringliteral">"Choose modules"</font>), i18n(<font class="stringliteral">"Choose the modules for the search"</font>));
00088     m_moduleChooser         = <font class="keyword">new</font> <a class="code" href="class_c_search_dialog_module_chooser.html">CSearchDialogModuleChooser</a>(m_moduleChooserPage);
00089     connect(m_moduleChooser, SIGNAL(<a class="code" href="class_c_search_dialog.html#i0">chosenModulesChanged</a>()), SLOT(<a class="code" href="class_c_search_dialog.html#i0">chosenModulesChanged</a>()));
00090     
00091     m_searchTextPage = addVBoxPage(i18n(<font class="stringliteral">"Search Text"</font>), i18n(<font class="stringliteral">"Enter the text to search for"</font>));
00092     m_searchText            = <font class="keyword">new</font> <a class="code" href="class_c_search_dialog_text.html">CSearchDialogText</a>(m_searchTextPage);
00093     m_searchTextPage-&gt;setEnabled(<font class="keyword">false</font>);
00094     
00095     m_searchResultPage = addHBoxPage(i18n(<font class="stringliteral">"Search Result"</font>), i18n(<font class="stringliteral">"The result of your search"</font>));
00096     m_searchResult = <font class="keyword">new</font> CSearchDialogResult(m_searchResultPage);
00097     m_searchResultPage-&gt;setEnabled(<font class="keyword">false</font>);
00098     
00099     m_searchAnalysisPage = addVBoxPage(i18n(<font class="stringliteral">"Search Analysis"</font>), i18n(<font class="stringliteral">"Graphical analysis of your search result"</font>));  
00100     m_searchAnalysis = <font class="keyword">new</font> <a class="code" href="class_c_search_dialog_analysis.html">CSearchDialogAnalysis</a>(m_searchAnalysisPage);
00101     m_searchAnalysisView =  <font class="keyword">new</font> CSearchDialogAnalysisView(m_searchAnalysis, m_searchAnalysisPage);
00102     m_searchAnalysisPage-&gt;setEnabled(<font class="keyword">false</font>);
00103 
00104     m_searchAnalysisSaveButton = <font class="keyword">new</font> QPushButton(<font class="stringliteral">"Save Analysis to Disk"</font>, m_searchAnalysisPage);
00105 
00106     connect(m_searchAnalysisSaveButton, SIGNAL(clicked()),
00107         <font class="keyword">this</font>, SLOT(slotSaveSearchAnalysis()));  
00108 }
00109 
00110 ListCSwordModuleInfo&amp; CSearchDialog::getModuleList() {
00111 <font class="comment">//  ASSERT(moduleList);</font>
00112     m_moduleList = m_moduleChooser-&gt;<a class="code" href="class_c_search_dialog_module_chooser.html#a3">getChosenModules</a>();
00113     <font class="keywordflow">return</font> m_moduleList;
00114 }
00115 
<a name="l00116"></a><a class="code" href="class_c_search_dialog.html#a3">00116</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#a3">CSearchDialog::setModuleList</a>(ListCSwordModuleInfo&amp; list) {
00117     <font class="keywordflow">if</font> (m_moduleList != list)
00118         m_moduleList = list; <font class="comment">//copy the items of "list"</font>
00119     
00120     m_moduleChooser-&gt;blockSignals(<font class="keyword">true</font>);
00121     m_moduleChooser-&gt;<a class="code" href="class_c_search_dialog_module_chooser.html#a2">setChosenModules</a>(m_moduleList);
00122     m_moduleChooser-&gt;blockSignals(<font class="keyword">false</font>);   
00123     
00124     m_searchTextPage-&gt;setEnabled(m_moduleList.count()&gt;0);   
00125     m_searchResult-&gt;clearResult();
00126     m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a4">reset</a>();
00127 }
00128 
00129 <font class="keywordtype">void</font> CSearchDialog::slotSaveSearchAnalysis(){
00130     <font class="keyword">const</font> QString file = KFileDialog::getSaveFileName(QString::null, QString::fromLatin1(<font class="stringliteral">"*.html | %1"</font>).arg(i18n(<font class="stringliteral">"HTML files"</font>)), 0, i18n(<font class="stringliteral">"Save Search Analysis"</font>));
00131     <font class="keywordflow">if</font> (!file.isNull()) {
00132         <font class="keywordtype">int</font> moduleIndex = 0;
00133         <font class="keywordtype">int</font> count = 0;
00134         QString countStr = <font class="stringliteral">""</font>;
00135         QString m_searchAnalysisHTML = <font class="stringliteral">""</font>;
00136         QString tableTitle = <font class="stringliteral">""</font>;
00137       QString tableTotals = <font class="stringliteral">""</font>;
00138         QString VerseRange = <font class="stringliteral">""</font>;
00139         <font class="keyword">const</font> QString txtCSS = QString::fromLatin1(<font class="stringliteral">"&lt;style type='text/css'&gt;\nTD {border: thin solid black;}\nTH {font-size: 130%;text-align: left;vertical-align:top;}\n&lt;/style&gt;\n"</font>);   
00140         <a class="code" href="class_c_sword_verse_key.html">CSwordVerseKey</a> key(0);
00141         ListKey searchResult;
00142         
00143         key.<a class="code" href="class_c_sword_verse_key.html#a4">key</a>(<font class="stringliteral">"Genesis 1:1"</font>);
00144     
00145         <font class="keywordflow">if</font> (m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a3">getScopeType</a>() != CSwordModuleSearch::Scope_NoScope) {
00146             ListKey verses = m_searcher.<a class="code" href="class_c_sword_module_search.html#a13">scope</a>();
00147             <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; verses.Count(); ++i) {
00148                 VerseKey* element = dynamic_cast&lt;VerseKey*&gt;(verses.GetElement(i));
00149                 <font class="keywordflow">if</font> (element) {
00150                     VerseRange += QString(<font class="stringliteral">"%1 - %2"</font>).arg(QString::fromLocal8Bit((<font class="keyword">const</font> <font class="keywordtype">char</font>*)element-&gt;LowerBound())).arg(QString::fromLocal8Bit((<font class="keyword">const</font> <font class="keywordtype">char</font>*)element-&gt;UpperBound())) + <font class="stringliteral">"&lt;br&gt;"</font>;
00151                 }
00152             }
00153         }
00154 
00155         QDict&lt;CSearchDialogAnalysisItem&gt;* m_searchAnalysisItems = m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a5">getSearchAnalysisItemList</a>();
00156         <a class="code" href="class_c_search_dialog_analysis_item.html">CSearchDialogAnalysisItem</a>* analysisItem = m_searchAnalysisItems-&gt;find( key.<a class="code" href="class_c_sword_verse_key.html#a8">book</a>() );
00157         
00158     QString text = <font class="stringliteral">"&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;"</font> + i18n(<font class="stringliteral">"BibleTime Search Analysis"</font>) + <font class="stringliteral">"&lt;/title&gt;\n"</font> + txtCSS + <font class="stringliteral">"&lt;/head&gt;\n&lt;body&gt;\n"</font>;
00159         text += <font class="stringliteral">"&lt;table&gt;\n&lt;tr&gt;&lt;th&gt;"</font> + i18n(<font class="stringliteral">"Search Text :"</font>) + <font class="stringliteral">"&lt;/th&gt;&lt;th&gt;"</font> + m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a2">getText</a>() + <font class="stringliteral">"&lt;/th&gt;&lt;/tr&gt;\n"</font>;
00160         text += <font class="stringliteral">"&lt;tr&gt;&lt;th&gt;"</font> + i18n(<font class="stringliteral">"Search Type :"</font>) + <font class="stringliteral">"&lt;/th&gt;&lt;th&gt;"</font> + m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a6">getSearchTypeString</a>() + <font class="stringliteral">"&lt;/th&gt;&lt;/tr&gt;\n"</font>;
00161         text += <font class="stringliteral">"&lt;tr&gt;&lt;th&gt;"</font> + i18n(<font class="stringliteral">"Search Scope:"</font>) + <font class="stringliteral">"&lt;/th&gt;&lt;th&gt;"</font> + ((m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a3">getScopeType</a>() != CSwordModuleSearch::Scope_NoScope) ? VerseRange : m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a4">getScopeTypeString</a>()) + <font class="stringliteral">"&lt;/th&gt;&lt;/tr&gt;\n&lt;/table&gt;\n&lt;br&gt;\n"</font>;
00162 
00163 
00164       tableTitle = <font class="stringliteral">"&lt;tr&gt;&lt;th align=\"left\"&gt;"</font> + i18n(<font class="stringliteral">"Book"</font>) + <font class="stringliteral">"&lt;/th&gt;"</font>;
00165         tableTotals = <font class="stringliteral">"&lt;tr&gt;&lt;td align=\"left\"&gt;"</font> + i18n(<font class="stringliteral">"Total Hits"</font>) + <font class="stringliteral">"&lt;/td&gt;"</font>;
00166         <font class="keywordflow">for</font> (moduleIndex = 0,m_moduleList.first(); m_moduleList.current(); m_moduleList.next(),++moduleIndex) {
00167                 tableTitle += QString::fromLatin1(<font class="stringliteral">"&lt;th align=\"left\"&gt;"</font>) + m_moduleList.current()-&gt;name() + QString::fromLatin1(<font class="stringliteral">"&lt;/th&gt;"</font>);
00168                 searchResult = m_moduleList.current()-&gt;searchResult();
00169                 countStr.setNum(searchResult.Count());
00170           tableTotals += QString::fromLatin1(<font class="stringliteral">"&lt;td align=\"right\"&gt;"</font>) + countStr + QString::fromLatin1(<font class="stringliteral">"&lt;/td&gt;"</font>);
00171         }
00172         tableTitle += QString::fromLatin1(<font class="stringliteral">"&lt;/tr&gt;\n"</font>);
00173         tableTotals += QString::fromLatin1(<font class="stringliteral">"&lt;/tr&gt;\n"</font>);
00174 
00175         m_searchAnalysisHTML = <font class="stringliteral">""</font>;
00176         <font class="keywordtype">bool</font> ok = <font class="keyword">true</font>;     
00177         <font class="keywordflow">while</font> (ok) {
00178             m_searchAnalysisHTML += QString::fromLatin1(<font class="stringliteral">"&lt;tr&gt;&lt;td&gt;"</font>) + key.<a class="code" href="class_c_sword_verse_key.html#a8">book</a>() + QString::fromLatin1(<font class="stringliteral">"&lt;/td&gt;"</font>);
00179             analysisItem = m_searchAnalysisItems-&gt;find( key.<a class="code" href="class_c_sword_verse_key.html#a8">book</a>() );
00180             <font class="keywordflow">for</font> (moduleIndex = 0,m_moduleList.first(); m_moduleList.current(); m_moduleList.next(), ++moduleIndex) {
00181                 count = analysisItem-&gt;<a class="code" href="class_c_search_dialog_analysis_item.html#a3">getCountForModule</a>(moduleIndex);
00182                 countStr.setNum(count);
00183                 m_searchAnalysisHTML += QString::fromLatin1(<font class="stringliteral">"&lt;td align=\"right\"&gt;"</font>) + countStr + QString::fromLatin1(<font class="stringliteral">"&lt;/td&gt;"</font>);
00184             }
00185             m_searchAnalysisHTML += QString::fromLatin1(<font class="stringliteral">"&lt;/tr&gt;\n"</font>);
00186             ok = key.<a class="code" href="class_c_sword_verse_key.html#a6">next</a>(CSwordVerseKey::UseBook);
00187         }
00188         text += QString::fromLatin1(<font class="stringliteral">"&lt;table&gt;\n"</font>) + tableTitle + tableTotals + m_searchAnalysisHTML + QString::fromLatin1(<font class="stringliteral">"&lt;/table&gt;\n"</font>);
00189         text += QString::fromLatin1(<font class="stringliteral">"&lt;center&gt;"</font>) + i18n(<font class="stringliteral">"Created by"</font>) + QString::fromLatin1(<font class="stringliteral">" &lt;a href=\"http://www.bibletime.de/\"&gt;BibleTime&lt;/a&gt;&lt;/center&gt;"</font>);
00190         text += QString::fromLatin1(<font class="stringliteral">"&lt;/body&gt;&lt;/html&gt;"</font>);
00191         <a class="code" href="class_c_tool_class.html#d3">CToolClass::savePlainFile</a>(file, text);
00192     }
00193 }
00194 
00195 <font class="keywordtype">void</font> CSearchDialog::slotUser1() {
00196     startSearch();
00197 }
00198 
00199 <font class="keywordtype">void</font> CSearchDialog::slotUser2() {
00200 <font class="comment">//  if (searcher-&gt;isSearching())</font>
00201     m_searcher.<a class="code" href="class_c_sword_module_search.html#a7">interruptSearch</a>();
00202 }
00203 
00204 <font class="keywordtype">void</font> CSearchDialog::startSearch(<font class="keywordtype">void</font>) {
00205     <font class="keywordtype">int</font> searchFlags = m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a5">getSearchType</a>();    
00206     <font class="comment">// set the parameters</font>
00207     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a7">updateCurrentProgress</a>(0);
00208     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a8">updateOverallProgress</a>(0);
00209     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a3">setText</a>( m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a2">getText</a>() );
00210         
00211     m_searcher.<a class="code" href="class_c_sword_module_search.html#a4">setModules</a>( getModuleList() );
00212     m_searcher.<a class="code" href="class_c_sword_module_search.html#a2">setSearchedText</a>(m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a2">getText</a>());
00213 
00214     <font class="keywordflow">if</font> (m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a4">isCaseSensitive</a>())
00215         searchFlags |= CSwordModuleSearch::caseSensitive;
00216     m_searcher.<a class="code" href="class_c_sword_module_search.html#a6">resetSearchScope</a>();
00217     CSwordModuleSearch::scopeType scopeType = m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a3">getScopeType</a>();
00218     
00219     <font class="keywordflow">if</font> (scopeType == CSwordModuleSearch::Scope_LastSearch) {
00220         searchFlags |= CSwordModuleSearch::useLastResult;
00221     }
00222     <font class="keywordflow">else</font> <font class="keywordflow">if</font> ( scopeType == CSwordModuleSearch::Scope_Bounds ) {
00223         searchFlags |= CSwordModuleSearch::useScope;    
00224         m_searcher.<a class="code" href="class_c_sword_module_search.html#a5">setSearchScope</a>( m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#m0">scopeChooser</a>-&gt;<a class="code" href="class_c_search_dialog_scope_chooser.html#a2">getScope</a>() );
00225     }
00226     m_searcher.<a class="code" href="class_c_sword_module_search.html#a10">setSearchOptions</a>(searchFlags);
00227     enableButton(User1,<font class="keyword">false</font>);
00228     enableButton(User2,<font class="keyword">true</font>);
00229     m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a4">reset</a>();
00230     m_searchResult-&gt;clearResult();
00231         
00232     m_searcher.<a class="code" href="class_c_sword_module_search.html#a9">startSearchThread</a>();
00233 }
00234 
<a name="l00235"></a><a class="code" href="class_c_search_dialog.html#a4">00235</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#a4">CSearchDialog::setSearchText</a>(<font class="keyword">const</font> QString text){
00236   m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a3">setText</a>(text);
00237     <font class="keywordflow">if</font> (!text.isEmpty())
00238         showPage(pageIndex(m_searchTextPage));
00239 }
00240 
<a name="l00242"></a><a class="code" href="class_c_search_dialog.html#a5">00242</a> <font class="keyword">const</font> QString <a class="code" href="class_c_search_dialog.html#a5">CSearchDialog::getSearchedText</a>()<font class="keyword"> const </font>{
00243     <font class="keywordflow">return</font> m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a2">getText</a>();
00244 }
00245 
<a name="l00247"></a><a class="code" href="class_c_search_dialog.html#i0">00247</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#i0">CSearchDialog::chosenModulesChanged</a>(){
00248     <a class="code" href="class_c_search_dialog.html#a3">setModuleList</a>(getModuleList());
00249 }
00250 
<a name="l00252"></a><a class="code" href="class_c_search_dialog.html#g0">00252</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#g0">CSearchDialog::show</a>(){
00253     KDialogBase::show();
00254 
00255     <font class="keywordflow">if</font> ( CBTConfig::get(CBTConfig::firstSearchDialog) ){
00256         <a class="code" href="class_c_h_t_m_l_dialog.html">CHTMLDialog</a> dlg(HELPDIALOG_FIRSTTIME_SEARCH);
00257         dlg.exec();
00258         CBTConfig::set(CBTConfig::firstSearchDialog, <font class="keyword">false</font>);
00259     }           
00260 }
00261 
<a name="l00263"></a><a class="code" href="class_c_search_dialog.html#i4">00263</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#i4">CSearchDialog::searchFinished</a>(){
00264 <font class="comment">//  qWarning("CSearchDialog::searchFinished()");</font>
00265     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a7">updateCurrentProgress</a>(100);
00266     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a8">updateOverallProgress</a>(100);
00267     m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a4">reset</a>();
00268     <font class="keywordflow">if</font> ( m_searcher.<a class="code" href="class_c_sword_module_search.html#a8">foundItems</a>() ){
00269         m_searchResult-&gt;setModuleList(getModuleList());         
00270         m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a2">setModuleList</a>(getModuleList());
00271         m_searchAnalysisView-&gt;setContentsPos(0,0);
00272         m_searchResultPage-&gt;setEnabled(<font class="keyword">true</font>);
00273         m_searchAnalysisPage-&gt;setEnabled(<font class="keyword">true</font>);                     
00274         showPage(pageIndex(m_searchResultPage));    <font class="comment">//the result page</font>
00275                         
00276         m_searchAnalysis-&gt;<a class="code" href="class_c_search_dialog_analysis.html#a3">analyse</a>();            
00277     }
00278     <font class="keywordflow">else</font>
00279         m_searchResult-&gt;clearResult();
00280 
00281     enableButton(User2,<font class="keyword">false</font>);
00282     enableButton(User1,<font class="keyword">true</font>);   
00283 }
00284 
<a name="l00286"></a><a class="code" href="class_c_search_dialog.html#i5">00286</a> <font class="keywordtype">void</font> <a class="code" href="class_c_search_dialog.html#i5">CSearchDialog::percentUpdate</a>(){
00287 <font class="comment">//  old_overallProgress = m_searcher.getPercent(CSwordModuleSearch::currentModule);</font>
00288     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a8">updateOverallProgress</a>(m_searcher.<a class="code" href="class_c_sword_module_search.html#a11">getPercent</a>(CSwordModuleSearch::allModules));
00289     
00290 <font class="comment">//  old_currentProgress = m_searcher.getPercent(CSwordModuleSearch::currentModule);</font>
00291     m_searchText-&gt;<a class="code" href="class_c_search_dialog_text.html#a7">updateCurrentProgress</a>(m_searcher.<a class="code" href="class_c_sword_module_search.html#a11">getPercent</a>(CSwordModuleSearch::currentModule));
00292     KApplication::kapp-&gt;processEvents();
00293 }
</pre></div><hr><address align="right"><small>Generated on Sun May 12 20:27:13 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
