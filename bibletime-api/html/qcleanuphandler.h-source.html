<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<title>qcleanuphandler.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.1.5 on Sat Feb 24 14:13:55 2001 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>qcleanuphandler.h</h1><a href="qcleanuphandler.h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="preprocessor">#ifndef QCLEANUPHANDLER_H
</font>00002 <font class="preprocessor"></font><font class="preprocessor">#define QCLEANUPHANDLER_H
</font>00003 <font class="preprocessor"></font>
00004 <font class="preprocessor">#ifndef QT_H
</font>00005 <font class="preprocessor"></font><font class="preprocessor">#include &lt;qlist.h&gt;</font>
00006 <font class="preprocessor">#include &lt;qguardedptr.h&gt;</font>
00007 <font class="preprocessor">#endif // QT_H
</font>00008 <font class="preprocessor"></font>
00009 template&lt;class Type&gt;
<a name="l00010"></a><a class="code" href="class_qguardedcleanuphandler.html">00010</a> <font class="keyword">class </font>Q_EXPORT <a class="code" href="class_qguardedcleanuphandler.html">QGuardedCleanupHandler</a>
00011 {
00012 <font class="keyword">public</font>:
<a name="l00013"></a><a class="code" href="class_qguardedcleanuphandler.html#a0">00013</a>     <a class="code" href="class_qguardedcleanuphandler.html#a0">~QGuardedCleanupHandler</a>()<font class="keyword"> </font>{ <a class="code" href="class_qguardedcleanuphandler.html#a4">clear</a>(); }
00014 
<a name="l00015"></a><a class="code" href="class_qguardedcleanuphandler.html#a1">00015</a>     <font class="keywordtype">void</font> <a class="code" href="class_qguardedcleanuphandler.html#a1">add</a>( Type* object )<font class="keyword">
</font>00016 <font class="keyword">    </font>{
00017     cleanupObjects.insert( 0, <font class="keyword">new</font> QGuardedPtr&lt;Type&gt;(object) );
00018     }
00019 
<a name="l00020"></a><a class="code" href="class_qguardedcleanuphandler.html#a2">00020</a>     <font class="keywordtype">void</font> <a class="code" href="class_qguardedcleanuphandler.html#a2">remove</a>( Type *object )<font class="keyword">
</font>00021 <font class="keyword">    </font>{
00022     QListIterator&lt;QGuardedPtr&lt;Type&gt; &gt; it( cleanupObjects );
00023     <font class="keywordflow">while</font> ( it.current() ) {
00024         QGuardedPtr&lt;Type&gt;* guard = it.current();
00025         ++it;
00026         <font class="keywordflow">if</font> ( (Type *)guard == object ) {
00027         cleanupObjects.removeRef( guard );
00028         <font class="keyword">delete</font> guard;
00029         <font class="keywordflow">break</font>;
00030         }
00031     }
00032     }
00033 
<a name="l00034"></a><a class="code" href="class_qguardedcleanuphandler.html#a3">00034</a>     <font class="keywordtype">bool</font> <a class="code" href="class_qguardedcleanuphandler.html#a3">isEmpty</a>()<font class="keyword"> const
</font>00035 <font class="keyword">    </font>{
00036     QListIterator&lt;QGuardedPtr&lt;Type&gt; &gt; it( cleanupObjects );
00037     <font class="keywordflow">while</font> ( it.current() ) {
00038         QGuardedPtr&lt;Type&gt;* guard = it.current();
00039         ++it;
00040         <font class="keywordflow">if</font> ( (Type*)*guard )
00041         <font class="keywordflow">return</font> FALSE;
00042     }
00043     <font class="keywordflow">return</font> TRUE;
00044     }
00045 
<a name="l00046"></a><a class="code" href="class_qguardedcleanuphandler.html#a4">00046</a>     <font class="keywordtype">void</font> <a class="code" href="class_qguardedcleanuphandler.html#a4">clear</a>()<font class="keyword"> </font>{
00047     QListIterator&lt;QGuardedPtr&lt;Type&gt; &gt; it( cleanupObjects );
00048     it.toLast();
00049     <font class="keywordflow">while</font> ( it.current() ) {
00050         QGuardedPtr&lt;Type&gt;* guard = it.current();
00051         --it;
00052         cleanupObjects.removeRef( guard );
00053         <font class="keyword">delete</font> (Type*)*guard;
00054         <font class="keyword">delete</font> guard;
00055     }
00056     }
00057 
00058 <font class="keyword">private</font>:
<a name="l00059"></a><a class="code" href="class_qguardedcleanuphandler.html#o0">00059</a>     QList&lt;QGuardedPtr&lt;Type&gt; &gt; cleanupObjects;
00060 };
00061 
00062 template&lt;class Type&gt;
<a name="l00063"></a><a class="code" href="class_qcleanuphandler.html">00063</a> <font class="keyword">class </font>Q_EXPORT <a class="code" href="class_qcleanuphandler.html">QCleanupHandler</a>
00064 {
00065 <font class="keyword">public</font>:
<a name="l00066"></a><a class="code" href="class_qcleanuphandler.html#a0">00066</a>     <a class="code" href="class_qcleanuphandler.html#a0">QCleanupHandler</a>() : <a class="code" href="class_qcleanuphandler.html#o0">cleanupObjects</a>( 0 )<font class="keyword">
</font>00067 <font class="keyword">    </font>{}
<a name="l00068"></a><a class="code" href="class_qcleanuphandler.html#a1">00068</a>     <a class="code" href="class_qcleanuphandler.html#a1">~QCleanupHandler</a>()<font class="keyword"> </font>{ <a class="code" href="class_qcleanuphandler.html#a5">clear</a>(); }
00069 
<a name="l00070"></a><a class="code" href="class_qcleanuphandler.html#a2">00070</a>     <font class="keywordtype">void</font> <a class="code" href="class_qcleanuphandler.html#a2">add</a>( Type* object )<font class="keyword">
</font>00071 <font class="keyword">    </font>{
00072     <font class="keywordflow">if</font> ( !cleanupObjects ) {
00073         cleanupObjects = <font class="keyword">new</font> QList&lt;Type&gt;;
00074     }
00075     cleanupObjects-&gt;insert( 0, object );
00076     }
00077 
<a name="l00078"></a><a class="code" href="class_qcleanuphandler.html#a3">00078</a>     <font class="keywordtype">void</font> <a class="code" href="class_qcleanuphandler.html#a3">remove</a>( Type *object )<font class="keyword">
</font>00079 <font class="keyword">    </font>{
00080     <font class="keywordflow">if</font> ( !cleanupObjects )
00081         <font class="keywordflow">return</font>;
00082     <font class="keywordflow">if</font> ( object )
00083         cleanupObjects-&gt;removeRef( object );
00084     }
00085 
<a name="l00086"></a><a class="code" href="class_qcleanuphandler.html#a4">00086</a>     <font class="keywordtype">bool</font> <a class="code" href="class_qcleanuphandler.html#a4">isEmpty</a>()<font class="keyword"> const
</font>00087 <font class="keyword">    </font>{
00088     <font class="keywordflow">return</font> cleanupObjects ? cleanupObjects-&gt;isEmpty() : TRUE;
00089     }
00090 
<a name="l00091"></a><a class="code" href="class_qcleanuphandler.html#a5">00091</a>     <font class="keywordtype">void</font> <a class="code" href="class_qcleanuphandler.html#a5">clear</a>()<font class="keyword">
</font>00092 <font class="keyword">    </font>{
00093     <font class="keywordflow">if</font> ( !cleanupObjects )
00094         <font class="keywordflow">return</font>;
00095 
00096     QListIterator&lt;Type&gt; it( *cleanupObjects );
00097     it.toLast();
00098     <font class="keywordflow">while</font> ( it.current() ) {
00099         Type* object = it.current();
00100         --it;
00101         cleanupObjects-&gt;removeRef( object );
00102         <font class="keyword">delete</font> object;
00103     }
00104 
00105     <font class="keyword">delete</font> cleanupObjects;
00106     cleanupObjects = 0;
00107     }
00108 
00109 <font class="keyword">private</font>:
<a name="l00110"></a><a class="code" href="class_qcleanuphandler.html#o0">00110</a>     QList&lt;Type&gt; *cleanupObjects;
00111 };
00112 
00113 <font class="preprocessor">#endif //QCLEANUPHANDLER_H
</font></div></pre><hr><address><small>Generated at Sat Feb 24 14:13:55 2001 for BibleTime by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align=center border=0 
width=110 height=53></a>1.1.5 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy; 1997-2000</small></address>
</body>
</html>
