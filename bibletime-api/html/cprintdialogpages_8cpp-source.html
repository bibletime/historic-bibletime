<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>cprintdialogpages.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>cprintdialogpages.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                          cstylelistpage.cpp  -  description</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Fri Feb 8 2002</font>
00005 <font class="comment">    copyright            : (C) 2002 by The BibleTime team</font>
00006 <font class="comment">    email                : info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="comment">//BibleTime includes</font>
00019 <font class="preprocessor">#include "cprinter.h"</font>
00020 <font class="preprocessor">#include "cprintdialogpages.h"</font>
00021 <font class="preprocessor">#include "cprintitemlist.h"</font>
00022 <font class="preprocessor">#include "cprintitem.h"</font>
00023 <font class="preprocessor">#include "tooltipdef.h"</font>
00024 <font class="preprocessor">#include "resource.h"</font>
00025 <font class="preprocessor">#include "whatsthisdef.h"</font>
00026 
00027 <font class="comment">//QT includes</font>
00028 <font class="preprocessor">#include &lt;qbuttongroup.h&gt;</font>
00029 <font class="preprocessor">#include &lt;qcombobox.h&gt;</font>
00030 <font class="preprocessor">#include &lt;qtoolbutton.h&gt;</font>
00031 <font class="preprocessor">#include &lt;qlayout.h&gt;</font>
00032 <font class="preprocessor">#include &lt;qlabel.h&gt;</font>
00033 <font class="preprocessor">#include &lt;qwhatsthis.h&gt;</font>
00034 <font class="preprocessor">#include &lt;qtooltip.h&gt;</font>
00035 <font class="preprocessor">#include &lt;qspinbox.h&gt;</font>
00036 <font class="preprocessor">#include &lt;qlistview.h&gt;</font>
00037 <font class="preprocessor">#include &lt;qiconset.h&gt;</font>
00038 
00039 
00040 <font class="comment">//KDE includes</font>
00041 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00042 
00043 CStyleListPage::CStyleListPage(CPrinter* printer, QWidget *parent, <font class="keyword">const</font> <font class="keywordtype">char</font> *name )
00044     : KPrintDialogPage(parent,name), m_printer(printer) {
00045     setTitle(i18n(<font class="stringliteral">"Styles"</font>));
00046 
00047 <font class="comment">//  QFrame *page = addPage( i18n("Layout"), i18n("Layout specific settings") );</font>
00048   QVBoxLayout *topLayout = <font class="keyword">new</font> QVBoxLayout( <font class="keyword">this</font>, 5, 5 );
00049     
00050   QButtonGroup *group = <font class="keyword">new</font> QButtonGroup( i18n(<font class="stringliteral">"Margins (in millimeter)"</font>), <font class="keyword">this</font> );
00051   QWhatsThis::add(group, WT_PD_LAYOUT_BORDER);
00052   topLayout-&gt;addWidget( group, 0 );
00053 
00054   QGridLayout *gbox = <font class="keyword">new</font> QGridLayout( group, 4, 2, 5, 5 );
00055   gbox-&gt;addRowSpacing( 0, group-&gt;fontMetrics().height()-5 );
00056 
00057   <font class="keyword">const</font> QString name[4] = {i18n(<font class="stringliteral">"&amp;Top"</font>),i18n(<font class="stringliteral">"&amp;Bottom"</font>),i18n(<font class="stringliteral">"&amp;Left"</font>), i18n(<font class="stringliteral">"&amp;Right"</font>) };
00058   <font class="keywordflow">for</font>( <font class="keywordtype">int</font> i=0; i&lt;4; i++ ) {
00059     m_marginSpin[i] = <font class="keyword">new</font> QSpinBox( group );
00060     m_marginSpin[i]-&gt;setFixedHeight( m_marginSpin[i]-&gt;sizeHint().height() );
00061     m_marginSpin[i]-&gt;setMinimumWidth( m_marginSpin[i]-&gt;fontMetrics().width(<font class="stringliteral">"M"</font>)*10 );
00062     m_marginSpin[i]-&gt;setSuffix(<font class="stringliteral">" mm"</font>);
00063 
00064     QLabel *label = <font class="keyword">new</font> QLabel( m_marginSpin[i], name[i], group );
00065     label-&gt;setFixedHeight( m_marginSpin[i]-&gt;sizeHint().height() );
00066     label-&gt;setFixedWidth( label-&gt;sizeHint().width() );
00067 
00068     <font class="keywordflow">if</font>( i &lt; 2 )
00069     {
00070       gbox-&gt;addWidget( label, i+1, 0, AlignLeft );
00071       gbox-&gt;addWidget( m_marginSpin[i], i+1, 1, AlignLeft );
00072     }
00073     <font class="keywordflow">else</font>
00074     {
00075       gbox-&gt;addWidget( label, i-1, 3, AlignLeft );
00076       gbox-&gt;addWidget( m_marginSpin[i], i-1, 4, AlignLeft );
00077     }
00078   }
00079   QWhatsThis::add(m_marginSpin[0], WT_PD_LAYOUT_BORDER_TOP);
00080   QWhatsThis::add(m_marginSpin[1], WT_PD_LAYOUT_BORDER_BOTTOM);
00081   QWhatsThis::add(m_marginSpin[2], WT_PD_LAYOUT_BORDER_LEFT);
00082   QWhatsThis::add(m_marginSpin[3], WT_PD_LAYOUT_BORDER_RIGHT);
00083 
00084   QToolTip::add(m_marginSpin[0], TT_PD_LAYOUT_BORDER_TOP);
00085   QToolTip::add(m_marginSpin[1], TT_PD_LAYOUT_BORDER_BOTTOM);
00086   QToolTip::add(m_marginSpin[2], TT_PD_LAYOUT_BORDER_LEFT);
00087   QToolTip::add(m_marginSpin[3], TT_PD_LAYOUT_BORDER_RIGHT);
00088 
00089   gbox-&gt;activate(); 
00090   group-&gt;setFixedHeight( group-&gt;sizeHint().height() );
00091   <font class="comment">//set minimum borders</font>
00092   m_marginSpin[0]-&gt;setRange(0, 100);    <font class="comment">//upper margin</font>
00093   m_marginSpin[1]-&gt;setRange(0, 100);    <font class="comment">//lower margin</font>
00094   m_marginSpin[2]-&gt;setRange(0, 100);    <font class="comment">//left margin</font>
00095   m_marginSpin[3]-&gt;setRange(0, 100);    <font class="comment">//right margin</font>
00096 
00097   QHBoxLayout *entryLayout = <font class="keyword">new</font> QHBoxLayout( 0, 5, 5 );
00098   QVBoxLayout *styleLayout = <font class="keyword">new</font> QVBoxLayout( 0, 5, 5 );
00099   QVBoxLayout *buttonLayout = <font class="keyword">new</font> QVBoxLayout( 0, 5, 5 );
00100     
00101   m_styleList = <font class="keyword">new</font> <a class="code" href="class_c_style_list.html">CStyleList</a>( &amp;(m_printer-&gt;styleList()), <font class="keyword">this</font>, <font class="stringliteral">"CStyleList1"</font>);
00102     connect(m_styleList, SIGNAL(currentChanged(QListViewItem*)), SLOT(currentStyleChanged(QListViewItem*)));
00103     QToolTip::add(m_styleList, TT_PD_LAYOUT_STYLE_LIST);    
00104     QWhatsThis::add(m_styleList, WT_PD_LAYOUT_STYLE_LIST);
00105     
00106   QLabel* label = <font class="keyword">new</font> QLabel(m_styleList, i18n(<font class="stringliteral">"List of style items:"</font>), <font class="keyword">this</font>);
00107   styleLayout-&gt;addWidget(label,0);
00108     styleLayout-&gt;addWidget( m_styleList, 3);
00109     
00110     m_newStyleButton = <font class="keyword">new</font> QToolButton( <font class="keyword">this</font>, <font class="stringliteral">"newStyle Button"</font>);
00111     m_newStyleButton-&gt;setIconSet( SmallIcon(ICON_FILE_NEW));
00112 <font class="comment">//  m_newStyleButton-&gt;setOffIconSet( SmallIcon(ICON_FILE_NEW)); </font>
00113     QToolTip::add(m_newStyleButton, TT_PD_LAYOUT_STYLE_NEW);    
00114     QWhatsThis::add(m_newStyleButton, WT_PD_LAYOUT_STYLE_NEW);  
00115     connect( m_newStyleButton, SIGNAL(clicked()), m_styleList, SLOT(createNewStyle()));
00116         
00117     m_deleteStyleButton = <font class="keyword">new</font> QToolButton( <font class="keyword">this</font>, <font class="stringliteral">"deleteStyle Button"</font>); 
00118     m_deleteStyleButton-&gt;setIconSet( SmallIcon(ICON_FILE_DELETE));
00119 <font class="comment">//  m_deleteStyleButton-&gt;setOffIconSet( SmallIcon(ICON_FILE_DELETE));   </font>
00120     QToolTip::add(m_deleteStyleButton, TT_PD_LAYOUT_STYLE_DELETE);  
00121     QWhatsThis::add(m_deleteStyleButton, WT_PD_LAYOUT_STYLE_DELETE);        
00122     connect( m_deleteStyleButton, SIGNAL(clicked()), m_styleList, SLOT(deleteCurrentStyle()));
00123 
00124     m_editStyleButton = <font class="keyword">new</font> QToolButton( <font class="keyword">this</font>, <font class="stringliteral">"editStyle"</font>);
00125     m_editStyleButton-&gt;setIconSet( SmallIcon(ICON_EDIT));
00126 <font class="comment">//  m_editStyleButton-&gt;setOffIconSet( SmallIcon(ICON_EDIT));    </font>
00127     QToolTip::add(m_editStyleButton, TT_PD_LAYOUT_STYLE_EDIT);  
00128     QWhatsThis::add(m_editStyleButton, WT_PD_LAYOUT_STYLE_EDIT);        
00129     connect( m_editStyleButton, SIGNAL(clicked()), m_styleList, SLOT(editCurrentStyle()));
00130         
00131     buttonLayout-&gt;addWidget( m_newStyleButton );
00132     buttonLayout-&gt;addWidget( m_editStyleButton );
00133     buttonLayout-&gt;addWidget( m_deleteStyleButton );
00134     buttonLayout-&gt;addStretch(3);
00135         
00136     entryLayout-&gt;addLayout( styleLayout );
00137     entryLayout-&gt;addLayout( buttonLayout );
00138     
00139     topLayout-&gt;addLayout(entryLayout);
00140 }
00141 
00142 CStyleListPage::~CStyleListPage() {
00143 
00144 }
00145 
00146 <font class="keywordtype">void</font>  CStyleListPage::getOptions (QMap&lt;QString, QString&gt;&amp; opts, <font class="keywordtype">bool</font> incldef) {
00147     qWarning(<font class="stringliteral">"CStyleListPage::getOptions (const QMap&lt;QString,QString&gt;&amp; opts, bool)"</font>);
00148 
00149     <font class="keyword">const</font> QString leading = <font class="stringliteral">"kde-bibletime-"</font>;
00150     opts[ leading+<font class="stringliteral">"upper_margin"</font> ] = QString::number(m_marginSpin[0]-&gt;value());
00151     qWarning(opts[leading+<font class="stringliteral">"upper_margin"</font>].latin1());
00152     opts[ leading+<font class="stringliteral">"lower_margin"</font> ] = QString::number(m_marginSpin[1]-&gt;value());
00153     opts[ leading+<font class="stringliteral">"left_margin"</font>  ] = QString::number(m_marginSpin[2]-&gt;value());
00154     opts[ leading+<font class="stringliteral">"right_margin"</font> ] = QString::number(m_marginSpin[3]-&gt;value());
00155 }
00156 
00157 <font class="keywordtype">void</font>  CStyleListPage::setOptions (<font class="keyword">const</font> QMap&lt;QString,QString&gt;&amp; opts) {
00158     qWarning(<font class="stringliteral">"CStyleListPage::setOptions (const QMap&lt;QString,QString&gt;&amp; opts)"</font>);
00159 
00160     <font class="keyword">const</font> QString leading = <font class="stringliteral">"kde-bibletime-"</font>;
00161     QString option = opts[ leading+<font class="stringliteral">"upper_margin"</font> ];
00162     m_marginSpin[0]-&gt;setValue( option.toInt() );
00163     option = opts[ leading+<font class="stringliteral">"lower_margin"</font> ];
00164     m_marginSpin[1]-&gt;setValue( option.toInt() );
00165     option = opts[ leading+<font class="stringliteral">"left_margin"</font> ];
00166     m_marginSpin[2]-&gt;setValue( option.toInt() );
00167     option = opts[ leading+<font class="stringliteral">"right_margin"</font> ];
00168     m_marginSpin[3]-&gt;setValue( option.toInt() );
00169 }
00170 
00171 <font class="keywordtype">bool</font>  CStyleListPage::isValid (QString&amp; errorMessage) {
00172     <font class="keywordflow">return</font> <font class="keyword">true</font>;
00173 }
00174 
<a name="l00176"></a><a class="code" href="class_c_style_list_page.html#i0">00176</a> <font class="keywordtype">void</font> <a class="code" href="class_c_style_list_page.html#i0">CStyleListPage::currentStyleChanged</a>( QListViewItem* item ){
00177     <font class="keywordflow">if</font> (item) {
00178         m_deleteStyleButton-&gt;setEnabled( item-&gt;text(0) != i18n(<font class="stringliteral">"Standard"</font>) );
00179         m_editStyleButton-&gt;setEnabled( <font class="keyword">true</font> );  
00180     }
00181     <font class="keywordflow">else</font> {
00182         m_deleteStyleButton-&gt;setEnabled( <font class="keyword">false</font> );
00183         m_editStyleButton-&gt;setEnabled( <font class="keyword">false</font> ); 
00184     }
00185 }
00186 
00187 
00188 
00189 <font class="comment">// ------------------</font>
00190 
00191 CPrintItemListPage::CPrintItemListPage(CPrinter* printer, QWidget *parent, <font class="keyword">const</font> <font class="keywordtype">char</font> *name )
00192     : KPrintDialogPage(parent,name), m_printer( printer )
00193 {
00194     setTitle(i18n(<font class="stringliteral">"Print queue"</font>));
00195 
00196   QVBoxLayout *topLayout = <font class="keyword">new</font> QVBoxLayout( <font class="keyword">this</font>, 5, 5 );
00197   QVBoxLayout *entryLayout = <font class="keyword">new</font> QVBoxLayout( 0, 5, 5 );
00198   QLabel*   label = 0;
00199 
00200   m_styleComboBox = <font class="keyword">new</font> QComboBox( <font class="keyword">this</font>, <font class="stringliteral">"styleComboBox"</font> );
00201     QToolTip::add(m_styleComboBox, TT_PD_ENTRIES_STYLE_COMBO);
00202     QWhatsThis::add(m_styleComboBox, WT_PD_ENTRIES_STYLE_COMBO);
00203   connect(m_styleComboBox, SIGNAL(activated(<font class="keyword">const</font> QString&amp;)), SLOT(slotListApplyStyle(<font class="keyword">const</font> QString&amp;)));
00204 
00205   label = <font class="keyword">new</font> QLabel( m_styleComboBox, i18n(<font class="stringliteral">"Choose a style"</font>), <font class="keyword">this</font>);
00206   QHBoxLayout*  hboxLayout = <font class="keyword">new</font> QHBoxLayout( 0, 5, 5 );
00207   hboxLayout-&gt;addWidget( label );
00208   hboxLayout-&gt;addWidget( m_styleComboBox );
00209   topLayout-&gt;addLayout( hboxLayout );
00210 
00211   hboxLayout = <font class="keyword">new</font> QHBoxLayout( 0, 5, 5 );
00212 
00213   m_printItemList = <font class="keyword">new</font> <a class="code" href="class_c_print_item_list.html">CPrintItemList</a>( &amp;(m_printer-&gt;printQueue()), <font class="keyword">this</font>, <font class="stringliteral">"CPrintItemList1"</font>);
00214     QToolTip::add(m_printItemList, TT_PD_ENTRIES_PI_LIST);
00215     QWhatsThis::add(m_printItemList, WT_PD_ENTRIES_PI_LIST);
00216 
00217   label = <font class="keyword">new</font> QLabel(m_printItemList, i18n(<font class="stringliteral">"Entries which should be printed:"</font>), <font class="keyword">this</font>);
00218   entryLayout-&gt;addWidget(label);
00219   entryLayout-&gt;addWidget( m_printItemList );
00220   hboxLayout-&gt;addLayout(entryLayout);
00221 
00222   QVBoxLayout *buttonLayout = <font class="keyword">new</font> QVBoxLayout( 0, 5, 5 );
00223   m_moveUpButton = <font class="keyword">new</font> QToolButton(<font class="keyword">this</font>);
00224     m_moveUpButton-&gt;setIconSet( SmallIcon(<font class="stringliteral">"up"</font>));
00225 <font class="comment">//  m_moveUpButton-&gt;setOffIconSet( SmallIcon("up"));    </font>
00226     QToolTip::add(m_moveUpButton, TT_PD_ENTRIES_PI_MOVE_UP);
00227     QWhatsThis::add(m_moveUpButton, WT_PD_ENTRIES_PI_MOVE_UP);  
00228     connect(m_moveUpButton, SIGNAL(clicked()),m_printItemList, SLOT(moveUp()));
00229     
00230   m_moveDownButton = <font class="keyword">new</font> QToolButton(<font class="keyword">this</font>);
00231     m_moveDownButton-&gt;setIconSet( SmallIcon(<font class="stringliteral">"down"</font>));
00232 <font class="comment">//  m_moveDownButton-&gt;setOffIconSet( SmallIcon("down"));    </font>
00233     QToolTip::add(m_moveDownButton, TT_PD_ENTRIES_PI_MOVE_DOWN);
00234     QWhatsThis::add(m_moveDownButton, WT_PD_ENTRIES_PI_MOVE_DOWN);
00235     connect( m_moveDownButton, SIGNAL(clicked()),m_printItemList, SLOT(moveDown()));
00236     
00237   m_deleteButton = <font class="keyword">new</font> QToolButton(<font class="keyword">this</font>);
00238     m_deleteButton-&gt;setIconSet( SmallIcon(<font class="stringliteral">"edittrash"</font>));
00239 <font class="comment">//  m_deleteButton-&gt;setOffIconSet( SmallIcon("edittrash")); </font>
00240     QToolTip::add(m_deleteButton, TT_PD_ENTRIES_PI_DELETE);
00241     QWhatsThis::add(m_deleteButton, WT_PD_ENTRIES_PI_DELETE);       
00242     connect( m_deleteButton, SIGNAL(clicked()),m_printItemList, SLOT(deleteSelectedItems()));
00243 
00244   buttonLayout-&gt;addWidget(m_moveUpButton);
00245   buttonLayout-&gt;addWidget(m_moveDownButton);
00246   buttonLayout-&gt;addWidget(m_deleteButton);
00247     buttonLayout-&gt;addStretch(3);
00248 
00249   hboxLayout-&gt;addLayout( buttonLayout );
00250   topLayout-&gt;addLayout( hboxLayout );
00251 
00252     connect(m_printer, SIGNAL(sigStylesChanged()), <font class="keyword">this</font>, SLOT(stylesChanged()));
00253     stylesChanged(); <font class="comment">//fill the box for the first time</font>
00254 }
00255 
00256 CPrintItemListPage::~CPrintItemListPage() {
00257 
00258 }
00259 
00260 <font class="keywordtype">void</font> CPrintItemListPage::getOptions (QMap&lt;QString, QString&gt;&amp; opts, <font class="keywordtype">bool</font> incldef) {
00261 
00262 }
00263 
00264 <font class="keywordtype">void</font> CPrintItemListPage::setOptions (<font class="keyword">const</font> QMap&lt;QString,QString&gt;&amp; opts) {
00265 
00266 }
00267 
00268 <font class="keywordtype">bool</font> CPrintItemListPage::isValid(QString&amp; errorMessage) {
00269     <font class="keywordflow">return</font> <font class="keyword">true</font>;
00270 }
00271 
<a name="l00273"></a><a class="code" href="class_c_print_item_list_page.html#i0">00273</a> <font class="keywordtype">void</font> <a class="code" href="class_c_print_item_list_page.html#i0">CPrintItemListPage::slotListApplyStyle</a>(<font class="keyword">const</font> QString&amp; styleName ){
00274     StyleItemList&amp; styleList = m_printer-&gt;styleList();  
00275     <font class="keywordflow">for</font>(styleList.first(); styleList.current(); styleList.next()) {
00276         <font class="keywordflow">if</font> (styleList.current()-&gt;styleName() == styleName) {
00277             m_printItemList-&gt;<a class="code" href="class_c_print_item_list.html#a5">applyStyleToSelected</a>( styleList.current() );
00278             <font class="keywordflow">break</font>;
00279         }
00280     }
00281 }
00282 
<a name="l00284"></a><a class="code" href="class_c_print_item_list_page.html#h0">00284</a> <font class="keywordtype">void</font> <a class="code" href="class_c_print_item_list_page.html#h0">CPrintItemListPage::stylesChanged</a>(){
00285     m_styleComboBox-&gt;clear();
00286     <font class="comment">//refill the combobox</font>
00287     StyleItemList&amp; styleList = m_printer-&gt;styleList();  
00288     <font class="keywordflow">for</font>(styleList.first(); styleList.current(); styleList.next()) {
00289         m_styleComboBox-&gt;insertItem(styleList.current()-&gt;styleName());
00290     }   
00291 }
</pre></div><hr><address align="right"><small>Generated on Tue Jul 16 13:53:09 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
