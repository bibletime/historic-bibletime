<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>chtmldialog.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>chtmldialog.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                          chtmldialog.cpp  -  description</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Tue Jan 25 2000</font>
00005 <font class="comment">    copyright            : (C) 2000 by The BibleTime Team</font>
00006 <font class="comment">    email                : Info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="comment">//own includes</font>
00019 <font class="preprocessor">#include "chtmldialog.h"</font>
00020 <font class="preprocessor">#include "ctoolclass.h"</font>
00021 
00022 <font class="comment">//QT includes</font>
00023 <font class="preprocessor">#include &lt;qlayout.h&gt;</font>
00024 <font class="preprocessor">#include &lt;qhbox.h&gt;</font>
00025 <font class="preprocessor">#include &lt;qfile.h&gt;</font>
00026 <font class="preprocessor">#include &lt;qtoolbar.h&gt;</font>
00027 <font class="preprocessor">#include &lt;qtoolbutton.h&gt;</font>
00028 <font class="preprocessor">#include &lt;qpushbutton.h&gt;</font>
00029 
00030 <font class="comment">//KDE includes</font>
00031 <font class="preprocessor">#include &lt;kcombobox.h&gt;</font>
00032 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00033 <font class="preprocessor">#include &lt;kiconloader.h&gt;</font>
00034 <font class="preprocessor">#include &lt;kapp.h&gt;</font>
00035 <font class="preprocessor">#include &lt;khtmlview.h&gt;</font>
00036 
00037 
00038 CHTMLDialog::CHTMLDialog(QWidget* parent, <font class="keyword">const</font> <font class="keywordtype">char</font> *name )
00039     : QDialog ( parent, name, true, WStyle_MinMax | WStyle_DialogBorder <font class="comment">/*| WStyle_Dialog */</font>)
00040 {
00041     <a class="code" href="class_c_group_manager_item.html#c0">init</a>(<font class="keyword">false</font>);
00042 }
00043 
00044 CHTMLDialog::CHTMLDialog(<font class="keyword">const</font> QString&amp; url, QWidget* parent, <font class="keyword">const</font> <font class="keywordtype">char</font> *name)
00045     : QDialog ( parent, name, true, WStyle_MinMax | WStyle_DialogBorder <font class="comment">/*| WStyle_Dialog */</font>)
00046 {
00047     <a class="code" href="class_c_group_manager_item.html#c0">init</a>();
00048     QString file = <a class="code" href="class_c_tool_class.html#d0">CToolClass::locatehtml</a>(url);
00049     
00050 <font class="comment">//  m_htmlPart-&gt;mimeSourceFactory()-&gt;setFilePath(file);</font>
00051   KURL url =QString::fromLatin1(<font class="stringliteral">"file:/"</font>) + file;
00052     m_htmlPart-&gt;openURL(url);
00053 }
00054 
00055 CHTMLDialog::~CHTMLDialog(){
00056 }
00057 
<a name="l00059"></a><a class="code" href="class_c_h_t_m_l_dialog.html#a3">00059</a> <font class="keywordtype">void</font> <a class="code" href="class_c_h_t_m_l_dialog.html#a3">CHTMLDialog::setText</a>(<font class="keyword">const</font> QString&amp; text){
00060   m_htmlPart-&gt;begin();
00061   m_htmlPart-&gt;write(text);
00062     m_htmlPart-&gt;end();
00063 }
00064 
<a name="l00066"></a><a class="code" href="class_c_h_t_m_l_dialog.html#b0">00066</a> <font class="keywordtype">void</font> <a class="code" href="class_c_h_t_m_l_dialog.html#b0">CHTMLDialog::init</a>(<font class="keyword">const</font> <font class="keywordtype">bool</font> enableHistory){
00067     resize(600,400);        
00068     QVBoxLayout* layout = <font class="keyword">new</font> QVBoxLayout(<font class="keyword">this</font>, 5);
00069         
00070     m_htmlPart = <font class="keyword">new</font> KHTMLPart(<font class="keyword">this</font>);       
00071   connect(m_htmlPart-&gt;browserExtension(), SIGNAL(openURLRequest(<font class="keyword">const</font> KURL&amp;, <font class="keyword">const</font> KParts::URLArgs&amp;)),
00072     SLOT(<a class="code" href="class_c_h_t_m_l_dialog.html#h2">openURL</a>( <font class="keyword">const</font> KURL&amp;, <font class="keyword">const</font> KParts::URLArgs&amp;)));
00073 <font class="comment">//  KURL url(CToolClass::locatehtml("bibletime/helpdialog/index.docbook")); </font>
00074 <font class="comment">//  m_htmlPart-&gt;mimeSourceFactory()-&gt;addFilePath(url.directory());</font>
00075 <font class="comment">//  url.cd(QString::fromLatin1(".."));</font>
00076 <font class="comment">//  m_htmlPart-&gt;mimeSourceFactory()-&gt;addFilePath(url.directory());</font>
00077 <font class="comment">//  url.cd(QString::fromLatin1(".."));</font>
00078 <font class="comment">//  m_htmlPart-&gt;mimeSourceFactory()-&gt;addFilePath(url.directory());</font>
00079 <font class="comment">//  url.cd(QString::fromLatin1(".."));</font>
00080 <font class="comment">//  m_htmlPart-&gt;mimeSourceFactory()-&gt;addFilePath(url.directory());</font>
00081     
00082     
00083     <font class="keywordflow">if</font> (enableHistory) {
00084         QHBox* toolBar = <font class="keyword">new</font> QHBox(<font class="keyword">this</font>, <font class="stringliteral">"history toolbar"</font>);
00085         
00086         QToolButton *button = 0;        
00087         button = <font class="keyword">new</font> QToolButton(toolBar);
00088         button-&gt;setIconSet(SmallIcon(<font class="stringliteral">"back"</font>));
00089         button-&gt;setTextLabel(i18n(<font class="stringliteral">"Backward"</font>));     
00090         button-&gt;setEnabled(<font class="keyword">false</font>);      
00091         button-&gt;setUsesTextLabel(<font class="keyword">true</font>);
00092         button-&gt;setFixedSize(button-&gt;sizeHint());
00093         connect(button, SIGNAL(clicked()), m_htmlPart, SLOT(backward()));
00094         connect(m_htmlPart, SIGNAL(backwardAvailable(<font class="keywordtype">bool</font>)),
00095             button, SLOT(setEnabled(<font class="keywordtype">bool</font>)));        
00096     connect( m_htmlPart, SIGNAL( <a class="code" href="class_c_h_t_m_l_dialog.html#h0">textChanged</a>() ),   
00097          <font class="keyword">this</font>, SLOT( <a class="code" href="class_c_h_t_m_l_dialog.html#h0">textChanged</a>() ) );
00098 
00099         m_historyCombo = <font class="keyword">new</font> KComboBox(toolBar);
00100         toolBar-&gt;setStretchFactor(m_historyCombo, 5);       
00101 <font class="comment">//    connect( m_historyCombo, SIGNAL( activated( const QString &amp; ) ),</font>
00102 <font class="comment">//       this, SLOT( historyItemSelected( const QString &amp; ) ) );</font>
00103         
00104                         
00105         button = <font class="keyword">new</font> QToolButton(toolBar);      
00106         button-&gt;setEnabled(<font class="keyword">false</font>);
00107         button-&gt;setTextLabel(i18n(<font class="stringliteral">"Forward"</font>));      
00108         button-&gt;setUsesTextLabel(<font class="keyword">true</font>);     
00109         button-&gt;setIconSet(SmallIcon(<font class="stringliteral">"forward"</font>));
00110         button-&gt;setFixedSize(button-&gt;sizeHint());
00111         connect(button, SIGNAL(clicked()), m_htmlPart, SLOT(forward()));        
00112         connect(m_htmlPart, SIGNAL(forwardAvailable(<font class="keywordtype">bool</font>)),
00113             button, SLOT(setEnabled(<font class="keywordtype">bool</font>)));
00114             
00115         layout-&gt;addWidget(toolBar);     
00116     }       
00117     layout-&gt;addSpacing(5);  
00118     layout-&gt;addWidget(m_htmlPart-&gt;view(),5);
00119     
00120     QHBoxLayout* hBox = <font class="keyword">new</font> QHBoxLayout();
00121     QPushButton* closeButton = <font class="keyword">new</font> QPushButton(<font class="keyword">this</font>);
00122     closeButton-&gt;setText(i18n(<font class="stringliteral">"Close"</font>));
00123     connect(closeButton, SIGNAL(pressed()), <font class="keyword">this</font>, SLOT(close()));
00124     hBox-&gt;addStretch(5);
00125     hBox-&gt;addWidget(closeButton,1);
00126     
00127     layout-&gt;addLayout(hBox);
00128 }
00129 
<a name="l00131"></a><a class="code" href="class_c_h_t_m_l_dialog.html#h1">00131</a> <font class="keywordtype">void</font> <a class="code" href="class_c_h_t_m_l_dialog.html#h1">CHTMLDialog::historyItemSelected</a>( <font class="keyword">const</font> QString &amp; file ){
00132 <font class="comment">//  m_htmlPart-&gt;setSource(file);</font>
00133 }
00134 
<a name="l00136"></a><a class="code" href="class_c_h_t_m_l_dialog.html#h0">00136</a> <font class="keywordtype">void</font> <a class="code" href="class_c_h_t_m_l_dialog.html#h0">CHTMLDialog::textChanged</a>(){
00137 <font class="comment">//  if ( m_htmlPart-&gt;documentTitle().isNull() )</font>
00138 <font class="comment">//      setCaption( m_htmlPart-&gt;context() );</font>
00139 <font class="comment">//  else</font>
00140 <font class="comment">//      setCaption( m_htmlPart-&gt;documentTitle() ) ;</font>
00141 <font class="comment">//</font>
00142 <font class="comment">//  QString selectedURL = caption();</font>
00143 <font class="comment">//  if ( !selectedURL.isEmpty() &amp;&amp; m_historyCombo ) {</font>
00144 <font class="comment">//      bool exists = false;</font>
00145 <font class="comment">//      int i;</font>
00146 <font class="comment">//      for ( i = 0; i &lt; m_historyCombo-&gt;count(); ++i ) {</font>
00147 <font class="comment">//          if ( m_historyCombo-&gt;text( i ) == selectedURL ) {</font>
00148 <font class="comment">//              exists = true;</font>
00149 <font class="comment">//              break;</font>
00150 <font class="comment">//          }</font>
00151 <font class="comment">//      }</font>
00152 <font class="comment">//      if ( !exists ) {</font>
00153 <font class="comment">//      m_historyCombo-&gt;insertItem( selectedURL, -1 );</font>
00154 <font class="comment">//      m_historyCombo-&gt;setCurrentItem( 0 );</font>
00155 <font class="comment">//      } else</font>
00156 <font class="comment">//      m_historyCombo-&gt;setCurrentItem( i );</font>
00157 <font class="comment">//      selectedURL = QString::null;</font>
00158 <font class="comment">//  }   </font>
00159 }
00160 
<a name="l00162"></a><a class="code" href="class_c_h_t_m_l_dialog.html#h2">00162</a> <font class="keywordtype">void</font> <a class="code" href="class_c_h_t_m_l_dialog.html#h2">CHTMLDialog::openURL</a>( <font class="keyword">const</font> KURL&amp; url, <font class="keyword">const</font> KParts::URLArgs&amp; args){
00163   m_htmlPart-&gt;closeURL();
00164   m_htmlPart-&gt;openURL(url);
00165 }
</pre></div><hr><address align="right"><small>Generated on Tue Jul 16 13:53:08 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
