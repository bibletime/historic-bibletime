<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>bibletime_init.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>bibletime_init.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                          bibletime_init.cpp  -  functions to initialize BibleTime on startup</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Wed Jan 19 2000</font>
00005 <font class="comment">    copyright            : (C) 2000 by The BibleTime Team</font>
00006 <font class="comment">    email                : Info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="comment">//BibleTime includes</font>
00019 <font class="preprocessor">#include "bibletime.h"</font>
00020 <font class="preprocessor">#include "resource.h"</font>
00021 
00022 <font class="preprocessor">#include "backend/cswordbackend.h"</font>
00023 
00024 <font class="preprocessor">#include "frontend/chtmldialog.h"</font>
00025 <font class="preprocessor">#include "frontend/cprofilemgr.h"</font>
00026 <font class="preprocessor">#include "frontend/cprofile.h"</font>
00027 <font class="preprocessor">#include "frontend/cmdiarea.h"</font>
00028 <font class="preprocessor">#include "frontend/kstartuplogo.h"</font>
00029 <font class="preprocessor">#include "frontend/groupmanager/cgroupmanager.h"</font>
00030 
00031 <font class="preprocessor">#include "printing/cprinter.h"</font>
00032 
00033 <font class="preprocessor">#include "whatsthisdef.h"</font>
00034 <font class="preprocessor">#include "config.h"</font>
00035 <font class="preprocessor">#include "frontend/cbtconfig.h"</font>
00036 
00037 
00038 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00039 
00040 <font class="comment">//QT includes</font>
00041 <font class="preprocessor">#include &lt;qpopupmenu.h&gt;</font>
00042 <font class="preprocessor">#include &lt;qsplitter.h&gt;</font>
00043 <font class="preprocessor">#include &lt;qguardedptr.h&gt;</font>
00044 <font class="preprocessor">#include &lt;qlistview.h&gt;</font>
00045 
00046 <font class="comment">//KDE includes</font>
00047 <font class="preprocessor">#include &lt;kaboutdata.h&gt;</font>
00048 <font class="preprocessor">#include &lt;kconfigbase.h&gt;</font>
00049 <font class="preprocessor">#include &lt;ktoolbar.h&gt;</font>
00050 <font class="preprocessor">#include &lt;kiconloader.h&gt;</font>
00051 <font class="preprocessor">#include &lt;kstddirs.h&gt;</font>
00052 <font class="preprocessor">#include &lt;kstdaction.h&gt;</font>
00053 <font class="preprocessor">#include &lt;kmenubar.h&gt;</font>
00054 <font class="preprocessor">#include &lt;kaccel.h&gt;</font>
00055 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00056 <font class="preprocessor">#include &lt;kaction.h&gt;</font>
00057 <font class="preprocessor">#include &lt;khelpmenu.h&gt;</font>
00058 <font class="preprocessor">#include &lt;kglobal.h&gt;</font>
00059 <font class="preprocessor">#include &lt;kpopupmenu.h&gt;</font>
00060 
<a name="l00062"></a><a class="code" href="class_bible_time.html#b0">00062</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#b0">BibleTime::initView</a>(){
00063     KStartupLogo::setStatusMessage(i18n(<font class="stringliteral">"Creating BibleTime's GUI"</font>) + QString::fromLatin1(<font class="stringliteral">"..."</font>));  
00064     
00065     m_splitter = <font class="keyword">new</font> QSplitter(<font class="keyword">this</font>, <font class="stringliteral">"mainsplitter"</font>);
00066     
00067     m_groupmanager = <font class="keyword">new</font> <a class="code" href="class_c_group_manager.html">CGroupManager</a>( m_splitter, <font class="stringliteral">"groupmanager"</font>, <a class="code" href="class_bible_time.html#n20">m_moduleList</a> );
00068     m_groupmanager-&gt;setFocusPolicy(ClickFocus);
00069 
00070     m_mdi = <font class="keyword">new</font> <a class="code" href="class_c_m_d_i_area.html">CMDIArea</a>(m_splitter, <font class="stringliteral">"mdiarea"</font> );
00071     m_mdi-&gt;setFocusPolicy(ClickFocus);
00072 
00073     m_helpMenu = <font class="keyword">new</font> KHelpMenu(<font class="keyword">this</font>, KGlobal::instance()-&gt;aboutData(), <font class="keyword">true</font>, actionCollection());
00074 
00075     setCentralWidget(m_splitter);   
00076 }
00077 
00078 
<a name="l00080"></a><a class="code" href="class_bible_time.html#b4">00080</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#b4">BibleTime::initActions</a>() {
00081     KStartupLogo::setStatusMessage(i18n(<font class="stringliteral">"Initializing menu- and toolbars"</font>) + QString::fromLatin1(<font class="stringliteral">"..."</font>));
00082 
00083     KAction* action = 0;
00084         
00085     <a class="code" href="class_bible_time.html#n2">m_fileClearQueue_action</a> = <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"Clear printing queue"</font>), ICON_FILE_CLEAR_QUEUE ,0,
00086         m_printer, SLOT(clearQueue()), actionCollection(), <font class="stringliteral">"fileClearQueue_action"</font>);    
00087     <a class="code" href="class_bible_time.html#n2">m_fileClearQueue_action</a>-&gt;setEnabled(<font class="keyword">false</font>); 
00088     <a class="code" href="class_bible_time.html#n2">m_fileClearQueue_action</a>-&gt;setToolTip( TT_FILE_CLEAR_QUEUE );
00089     <a class="code" href="class_bible_time.html#n2">m_fileClearQueue_action</a>-&gt;setWhatsThis( WT_FILE_CLEAR_QUEUE );
00090     <a class="code" href="class_bible_time.html#n2">m_fileClearQueue_action</a>-&gt;plugAccel( m_keyAccel );   
00091     
00092     m_filePrint_action = KStdAction::print(<font class="keyword">this</font>, SLOT( <a class="code" href="class_bible_time.html#h10">slotFilePrint</a>() ), actionCollection());
00093     m_filePrint_action-&gt;setEnabled(<font class="keyword">false</font>);      
00094     m_filePrint_action-&gt;setToolTip( TT_FILE_PRINT );    
00095     m_filePrint_action-&gt;setWhatsThis( WT_FILE_PRINT );
00096     m_filePrint_action-&gt;plugAccel( m_keyAccel );    
00097     
00098     action = KStdAction::quit(<font class="keyword">this</font>, SLOT( <a class="code" href="class_bible_time.html#h0">slotFileQuit</a>() ), actionCollection());
00099     action-&gt;setToolTip( TT_FILE_QUIT ); 
00100     action-&gt;setWhatsThis( WT_FILE_QUIT );
00101     action-&gt;plugAccel( m_keyAccel );
00102                                                 
00103     action =  <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"Reset main index"</font>), ICON_MAININDEX_RESET, IDK_GM_RESET,
00104         m_groupmanager, SLOT(slotReset()), actionCollection(), <font class="stringliteral">"GMreset_action"</font>);   
00105     action-&gt;setToolTip( TT_GM_RESET );          
00106     action-&gt;setWhatsThis( WT_GM_RESET );        
00107     action-&gt;plugAccel( m_keyAccel );
00108     
00109     action =  <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"Search in module(s)"</font>), ICON_MAININDEX_SEARCH, IDK_GM_MODULES_SEARCH,
00110         m_groupmanager, SLOT(slotSearchSelectedModules()), actionCollection(), <font class="stringliteral">"GMsearch_action"</font>);  
00111   action-&gt;setToolTip( TT_GM_SEARCH_MODULES );
00112   action-&gt;setWhatsThis( WT_GM_SEARCH_MODULES );
00113     action-&gt;plugAccel( m_keyAccel );
00114     
00115     action =  <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"Remove selected item(s)"</font>),ICON_MAININDEX_DELETE_ITEMS, IDK_GM_ITEMS_DELETE,
00116         m_groupmanager, SLOT(slotDeleteSelectedItems()), actionCollection(), <font class="stringliteral">"GMdelete_action"</font>);    
00117     action-&gt;setToolTip( TT_GM_DELETE_ITEMS );   
00118     action-&gt;setWhatsThis( WT_GM_DELETE_ITEMS );
00119     action-&gt;plugAccel( m_keyAccel );
00120 
00121     <a class="code" href="class_bible_time.html#n4">m_viewToolbar_action</a> = KStdAction::showToolbar(<font class="keyword">this</font>, SLOT( <a class="code" href="class_bible_time.html#h7">slotToggleToolbar</a>() ), actionCollection());
00122     <a class="code" href="class_bible_time.html#n4">m_viewToolbar_action</a>-&gt;setToolTip( TT_VIEW_TOOLBAR );    
00123     <a class="code" href="class_bible_time.html#n4">m_viewToolbar_action</a>-&gt;setWhatsThis( WT_VIEW_TOOLBAR );
00124     <a class="code" href="class_bible_time.html#n4">m_viewToolbar_action</a>-&gt;plugAccel( m_keyAccel );
00125 
00126     m_viewGroupManager_action = <font class="keyword">new</font> KToggleAction(i18n(<font class="stringliteral">"&amp;Show main index"</font>), ICON_VIEW_MAININDEX, IDK_VIEW_GROUPMANAGER,
00127         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h9">slotToggleGroupManager</a>()), actionCollection(), <font class="stringliteral">"viewGroupManager_action"</font>);
00128     m_viewGroupManager_action-&gt;setToolTip( TT_VIEW_GROUPMANAGER );  
00129     m_viewGroupManager_action-&gt;setWhatsThis( WT_VIEW_GROUPMANAGER );
00130     
00131     action = KStdAction::preferences(<font class="keyword">this</font>, SLOT( <a class="code" href="class_bible_time.html#g1">slotSettingsOptions</a>() ), actionCollection());
00132     action-&gt;setToolTip( TT_SETTINGS_OPTIONS );
00133     action-&gt;setWhatsThis( WT_SETTINGS_OPTIONS );
00134     action-&gt;plugAccel( m_keyAccel );
00135 
00136     action = KStdAction::configureToolbars(<font class="keyword">this</font>, SLOT( <a class="code" href="class_bible_time.html#h8">slotSettingsToolbar</a>() ), actionCollection());
00137     action-&gt;setToolTip( TT_SETTINGS_EDIT_TOOLBAR ); 
00138     action-&gt;setWhatsThis( WT_SETTINGS_EDIT_TOOLBAR );
00139     action-&gt;plugAccel( m_keyAccel );
00140 
00141     <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a> = <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"&amp;Cascade"</font>), ICON_WINDOW_CASCADE, IDK_WINDOW_CASCADE,
00142         m_mdi, SLOT(cascade()), actionCollection(), <font class="stringliteral">"windowCascade_action"</font>);
00143     <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;setToolTip( TT_WINDOW_CASCADE );    
00144     <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;setWhatsThis( WT_WINDOW_CASCADE );
00145     <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;plugAccel( m_keyAccel); 
00146     
00147     m_windowTile_action = <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"&amp;Tile"</font>), ICON_WINDOW_TILE,
00148                                                                 IDK_WINDOW_TILE, m_mdi, SLOT(tile()), actionCollection(), <font class="stringliteral">"windowTile_action"</font>);
00149     m_windowTile_action-&gt;setToolTip( TT_WINDOW_TILE );  
00150     m_windowTile_action-&gt;setWhatsThis( WT_WINDOW_TILE );
00151     m_windowTile_action-&gt;plugAccel( m_keyAccel );   
00152     
00153     m_windowAutoCascade_action  = <font class="keyword">new</font> KToggleAction(i18n(<font class="stringliteral">"&amp;Auto cascade"</font>), ICON_WINDOW_CASCADE_AUTO,
00154                                                                 IDK_WINDOW_AUTO_CASCADE, <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h5">slotAutoCascade</a>()), actionCollection(), <font class="stringliteral">"windowAutoCascade_action"</font>);
00155     m_windowAutoCascade_action-&gt;setToolTip( TT_WINDOW_AUTO_CASCADE );   
00156     m_windowAutoCascade_action-&gt;setWhatsThis( WT_WINDOW_AUTO_CASCADE );
00157     m_windowAutoCascade_action-&gt;plugAccel( m_keyAccel );    
00158                                                                     
00159     m_windowAutoTile_action = <font class="keyword">new</font> KToggleAction(i18n(<font class="stringliteral">"A&amp;uto Tile"</font>),ICON_WINDOW_TILE_AUTO,
00160                                                                 IDK_WINDOW_AUTO_TILE, <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h4">slotAutoTile</a>()), actionCollection(), <font class="stringliteral">"windowAutoTile_action"</font>);
00161     m_windowAutoTile_action-&gt;setToolTip( TT_WINDOW_AUTO_TILE ); 
00162     m_windowAutoTile_action-&gt;setWhatsThis( WT_WINDOW_AUTO_TILE );
00163     m_windowAutoTile_action-&gt;plugAccel( m_keyAccel );   
00164     
00165     m_windowCloseAll_action = <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"&amp;Close all"</font>), ICON_WINDOW_CLOSE_ALL,
00166                                                                 IDK_WINDOW_CLOSE_ALL, m_mdi, SLOT(deleteAll()), actionCollection(),<font class="stringliteral">"windowCloseAll_action"</font>);
00167     m_windowCloseAll_action-&gt;setToolTip( TT_WINDOW_CLOSE_ALL ); 
00168     m_windowCloseAll_action-&gt;setWhatsThis( WT_WINDOW_CLOSE_ALL );
00169     m_windowCloseAll_action-&gt;plugAccel( m_keyAccel );   
00170     
00171     m_windowSaveProfile_action = <font class="keyword">new</font> KActionMenu(i18n(<font class="stringliteral">"&amp;Save profile"</font>), ICON_WINDOW_SAVE_PROFILE, actionCollection(),<font class="stringliteral">"windowSaveProfile_action"</font>);
00172     m_windowSaveProfile_action-&gt;setToolTip( TT_WINDOW_SAVE_PROFILE );   
00173     m_windowSaveProfile_action-&gt;setWhatsThis( WT_WINDOW_SAVE_PROFILE );
00174     m_windowSaveProfile_action-&gt;plugAccel( m_keyAccel );    
00175 
00176     m_windowLoadProfile_action = <font class="keyword">new</font> KActionMenu(i18n(<font class="stringliteral">"&amp;Load profile"</font>), ICON_WINDOW_SAVE_PROFILE, actionCollection(),<font class="stringliteral">"windowLoadProfile_action"</font>);
00177     m_windowLoadProfile_action-&gt;setToolTip( TT_WINDOW_SAVE_PROFILE );   
00178     m_windowLoadProfile_action-&gt;setWhatsThis( WT_WINDOW_SAVE_PROFILE );
00179     m_windowLoadProfile_action-&gt;plugAccel( m_keyAccel );
00180 
00181     m_windowEditProfiles_action = <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"&amp;Configure profiles"</font>), ICON_WINDOW_EDIT_PROFILES,
00182                                                                 IDK_WINDOW_EDIT_PROFILES, <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h14">editProfiles</a>()), actionCollection(),<font class="stringliteral">"windowEditProfiles_action"</font>);
00183     m_windowEditProfiles_action-&gt;setToolTip( TT_WINDOW_SAVE_PROFILE );  
00184     m_windowEditProfiles_action-&gt;setWhatsThis( WT_WINDOW_SAVE_PROFILE );
00185     m_windowEditProfiles_action-&gt;plugAccel( m_keyAccel );   
00186 
00187     m_windowFullscreen_action = <font class="keyword">new</font> KToggleAction(i18n(<font class="stringliteral">"&amp;Fullscreen mode"</font>), ICON_WINDOW_FULLSCREEN,
00188                                                                 IDK_WINDOW_FULLSCREEN, <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h17">toggleFullscreen</a>()), actionCollection(),<font class="stringliteral">"windowFullscreen_action"</font>);
00189     m_windowFullscreen_action-&gt;setToolTip( TT_WINDOW_FULLSCREEN );  
00190     m_windowFullscreen_action-&gt;setWhatsThis( WT_WINDOW_FULLSCREEN );
00191     m_windowFullscreen_action-&gt;plugAccel( m_keyAccel );         
00192         
00193     QPtrList&lt;CProfile&gt; profiles = m_profileMgr.<a class="code" href="class_c_profile_mgr.html#a3">profiles</a>();      
00194     KPopupMenu* loadPopup = m_windowLoadProfile_action-&gt;popupMenu();
00195     KPopupMenu* savePopup = m_windowSaveProfile_action-&gt;popupMenu();    
00196     connect(loadPopup, SIGNAL(activated(<font class="keywordtype">int</font>)), SLOT(<a class="code" href="class_bible_time.html#h15">loadProfile</a>(<font class="keywordtype">int</font>)));
00197     connect(savePopup, SIGNAL(activated(<font class="keywordtype">int</font>)), SLOT(<a class="code" href="class_bible_time.html#h12">saveProfile</a>(<font class="keywordtype">int</font>)));
00198     <font class="keywordflow">for</font> (<a class="code" href="class_c_profile.html">CProfile</a>* p = profiles.first(); p; p = profiles.next()) {
00199         savePopup-&gt;insertItem(p-&gt;<a class="code" href="class_c_profile.html#a5">name</a>());           
00200         loadPopup-&gt;insertItem(p-&gt;<a class="code" href="class_c_profile.html#a5">name</a>());
00201     }
00202     
00203     <font class="keywordflow">if</font> ( actionCollection()-&gt;action(<font class="stringliteral">"help_contents"</font>) )   <font class="comment">//delete help action if KDE created it</font>
00204         actionCollection()-&gt;remove(actionCollection()-&gt;action(<font class="stringliteral">"help_contents"</font>));
00205         
00206     action = <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"&amp;Handbook"</font>), ICON_HELP_CONTENTS, 0, <font class="keyword">this</font>,
00207         SLOT(<a class="code" href="class_bible_time.html#g3">openOnlineHelp_Handbook</a>()), actionCollection(), <font class="stringliteral">"help_handbook"</font>);
00208   action-&gt;setToolTip( TT_HELP_HANDBOOK );
00209   action-&gt;setWhatsThis( WT_HELP_HANDBOOK  );
00210     action-&gt;plugAccel( m_keyAccel );
00211 
00212     action = <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"&amp;Installation"</font>), ICON_HELP_CONTENTS, 0, <font class="keyword">this</font>,
00213         SLOT(<a class="code" href="class_bible_time.html#g4">openOnlineHelp_Install</a>()), actionCollection(), <font class="stringliteral">"help_install"</font>);
00214   action-&gt;setToolTip( TT_HELP_INSTALLATION );
00215   action-&gt;setWhatsThis( WT_HELP_INSTALLATION  );
00216     action-&gt;plugAccel( m_keyAccel );
00217 
00218     action = <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"&amp;Bible Study Howto"</font>), ICON_HELP_CONTENTS, 0, <font class="keyword">this</font>,
00219         SLOT(<a class="code" href="class_bible_time.html#g5">openOnlineHelp_Howto</a>()), actionCollection(), <font class="stringliteral">"help_howto"</font>);
00220   action-&gt;setToolTip( TT_HELP_BIBLESTUDY );
00221   action-&gt;setWhatsThis( WT_HELP_BIBLESTUDY  );
00222     action-&gt;plugAccel( m_keyAccel );
00223 
00224     action = KStdAction::whatsThis(<font class="keyword">this</font>, SLOT(whatsThis()), actionCollection());
00225     action-&gt;setToolTip(TT_HELP_WHATSTHIS);
00226     action-&gt;setWhatsThis(WT_HELP_WHATSTHIS);    
00227     
00228     action = KStdAction::reportBug(m_helpMenu, SLOT(reportBug()), actionCollection());  
00229     action-&gt;setToolTip(TT_HELP_BUGREPORT);
00230     action-&gt;setWhatsThis(WT_HELP_BUGREPORT);
00231     action-&gt;setIcon(ICON_BUG_REPORT);
00232     
00233     action = <font class="keyword">new</font> KAction(i18n(<font class="stringliteral">"&amp;Daily tip"</font>), ICON_HELP_DAILY_TIP, IDK_HELP_DAILY_TIP, <font class="keyword">this</font>,
00234         SLOT(<a class="code" href="class_bible_time.html#g0">slotHelpTipOfDay</a>()), actionCollection(), <font class="stringliteral">"helpDailyTip_action"</font>);
00235     action-&gt;setToolTip(TT_HELP_DAILY_TIP);
00236     action-&gt;setWhatsThis(WT_HELP_DAILY_TIP);    
00237 
00238     action = KStdAction::aboutApp(m_helpMenu, SLOT(aboutApplication()), actionCollection());    
00239     action-&gt;setToolTip(TT_HELP_ABOUT);
00240     action-&gt;setWhatsThis(WT_HELP_ABOUT);    
00241     
00242     <font class="comment">//delete About KDE action if KDE created it already</font>
00243     <font class="keywordflow">if</font> ( actionCollection()-&gt;action(<font class="stringliteral">"help_about_kde"</font>) )  <font class="comment">//delete About KDE action if KDE created it</font>
00244         actionCollection()-&gt;remove(actionCollection()-&gt;action(<font class="stringliteral">"help_about_kde"</font>));   
00245     action = KStdAction::aboutKDE(m_helpMenu, SLOT(aboutKDE()), actionCollection());    
00246     action-&gt;setToolTip(TT_HELP_ABOUT_KDE);
00247     action-&gt;setWhatsThis(WT_HELP_ABOUT_KDE);
00248 
00249 <font class="comment">//  action = KStdAction::keybindings(m_helpMenu, SLOT(aboutApplication()), actionCollection()); </font>
00250 <font class="comment">//  action-&gt;setToolTip(TT_HELP_ABOUT);</font>
00251 <font class="comment">//  action-&gt;setWhatsThis(WT_HELP_ABOUT);    </font>
00252 }
00253 
<a name="l00255"></a><a class="code" href="class_bible_time.html#b1">00255</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#b1">BibleTime::initMenubar</a>(){
00256     <font class="comment">//get the window and edit menus using the actions and their properties</font>
00257     m_windowMenu = dynamic_cast&lt;QPopupMenu*&gt;(m_windowTile_action-&gt;container(0));    
00258 }
00259 
<a name="l00261"></a><a class="code" href="class_bible_time.html#b2">00261</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#b2">BibleTime::initConnections</a>(){
00262     connect(m_mdi, SIGNAL(sigSetToplevelCaption(<font class="keyword">const</font> QString&amp;)),
00263         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#g6">setPlainCaption</a>(<font class="keyword">const</font> QString&amp;)));
00264     connect(m_mdi, SIGNAL(<a class="code" href="class_bible_time.html#h1">createDisplayWindow</a>(ListCSwordModuleInfo, <font class="keyword">const</font> QString&amp;)),
00265         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h1">createDisplayWindow</a>(ListCSwordModuleInfo, <font class="keyword">const</font> QString&amp;)));
00266         
00267     <font class="keywordflow">if</font> (m_windowMenu) {
00268         connect(m_windowMenu, SIGNAL(aboutToShow()),
00269             <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h3">slotWindowMenuAboutToShow</a>()));
00270         connect(m_windowMenu, SIGNAL(activated(<font class="keywordtype">int</font>)),
00271             <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h6">slotWindowMenuActivated</a>(<font class="keywordtype">int</font>)));      
00272     }
00273     <font class="keywordflow">else</font>
00274         qWarning(<font class="stringliteral">"can't find window menu"</font>);
00275         
00276     connect(m_groupmanager, SIGNAL(<a class="code" href="class_bible_time.html#h1">createDisplayWindow</a>(<a class="code" href="class_c_sword_module_info.html">CSwordModuleInfo</a>*, <font class="keyword">const</font> QString&amp;)),
00277         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h1">createDisplayWindow</a>(<a class="code" href="class_c_sword_module_info.html">CSwordModuleInfo</a>*,<font class="keyword">const</font> QString&amp;)));
00278     connect(m_groupmanager, SIGNAL(<a class="code" href="class_bible_time.html#h1">createDisplayWindow</a>(ListCSwordModuleInfo, <font class="keyword">const</font> QString&amp;)),
00279         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h1">createDisplayWindow</a>(ListCSwordModuleInfo,<font class="keyword">const</font> QString&amp;)));
00280     
00281     <font class="comment">//connect to the signals of the printer object</font>
00282     connect(m_printer, SIGNAL(addedFirstQueueItem()),
00283         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h11">slotSetPrintingStatus</a>()));
00284     connect(m_printer, SIGNAL(printingStarted()),
00285         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#i3">slotPrintingStarted</a>()));     
00286     connect(m_printer, SIGNAL(printingFinished()),
00287         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h11">slotSetPrintingStatus</a>()));       
00288     connect(m_printer, SIGNAL(printingFinished()),
00289         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#i1">slotPrintingFinished</a>()));                
00290     connect(m_printer, SIGNAL(printingInterrupted()),
00291         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h11">slotSetPrintingStatus</a>()));               
00292     connect(m_printer, SIGNAL(printingInterrupted()),
00293         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#i1">slotPrintingFinished</a>()));                        
00294     connect(m_printer, SIGNAL(queueCleared()),
00295         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#h11">slotSetPrintingStatus</a>()));
00296     connect(m_printer, SIGNAL(percentCompleted(<font class="keyword">const</font> <font class="keywordtype">int</font>)),
00297         <font class="keyword">this</font>, SLOT(<a class="code" href="class_bible_time.html#i0">slotPrintedPercent</a>(<font class="keyword">const</font> <font class="keywordtype">int</font>)));     
00298 }
00299 
<a name="l00301"></a><a class="code" href="class_bible_time.html#b3">00301</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#b3">BibleTime::initBackends</a>(){
00302     KStartupLogo::setStatusMessage(i18n(<font class="stringliteral">"Initializing Sword"</font>)+QString::fromLatin1(<font class="stringliteral">"..."</font>));
00303     
00304     m_backend = <font class="keyword">new</font> <a class="code" href="class_c_sword_backend.html">CSwordBackend</a>();    
00305     CPointers::setBackend(m_backend);
00306     <font class="keyword">const</font> CSwordBackend::LoadError errorCode = m_backend-&gt;<a class="code" href="class_c_sword_backend.html#a3">initModules</a>();
00307 <font class="comment">//  qWarning("ErrorCode = %i", errorCode);</font>
00308 
00309     <a class="code" href="class_bible_time.html#n20">m_moduleList</a> = 0;       
00310     <font class="keywordflow">if</font> ( errorCode == CSwordBackend::NoError ) {    <font class="comment">//no error</font>
00311         <a class="code" href="class_bible_time.html#n20">m_moduleList</a> = &amp;(m_backend-&gt;<a class="code" href="class_c_sword_backend.html#a2">moduleList</a>());
00312     } <font class="keywordflow">else</font> {
00313         <a class="code" href="class_bible_time.html#n20">m_moduleList</a> = 0;
00314         <font class="comment">//show error message that initBackend failed        </font>
00315         <font class="keywordflow">switch</font> (errorCode) {
00316             <font class="keywordflow">case</font> CSwordBackend::NoSwordConfig: <font class="comment">//mods.d or mods.conf missing</font>
00317             {
00318                 KStartupLogo::hideSplash();
00319                 <a class="code" href="class_c_h_t_m_l_dialog.html">CHTMLDialog</a> dlg(HELPDIALOG_NO_SWORD_MODULE_CONFIG_DIR);
00320                 dlg.exec();             
00321                 KStartupLogo::showSplash();             
00322                 <font class="keywordflow">break</font>;
00323         }
00324     
00325             <font class="keywordflow">case</font> CSwordBackend::NoModules: <font class="comment">//no modules installed, but config exists</font>
00326             {
00327                 KStartupLogo::hideSplash();
00328                 <a class="code" href="class_c_h_t_m_l_dialog.html">CHTMLDialog</a> dlg(HELPDIALOG_NO_SWORD_MODULES);
00329                 dlg.exec();
00330                 KStartupLogo::showSplash();             
00331                 <font class="keywordflow">break</font>;
00332           }
00333         
00334             <font class="keywordflow">default</font>: <font class="comment">//unknown error</font>
00335             {
00336                 KStartupLogo::hideSplash();
00337                 <a class="code" href="class_c_h_t_m_l_dialog.html">CHTMLDialog</a> dlg(HELPDIALOG_INITBACKEND_FAILED);
00338                 dlg.exec();
00339                 KStartupLogo::showSplash();             
00340                 <font class="keywordflow">break</font>;
00341           }
00342         }
00343     }
00344     m_backend-&gt;<a class="code" href="class_c_sword_backend.html#a9">booknameLanguage</a>( CBTConfig::get(CBTConfig::language) );
00345 }
00346 
<a name="l00348"></a><a class="code" href="class_bible_time.html#b8">00348</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#b8">BibleTime::initPrinter</a>() {
00349     KStartupLogo::setStatusMessage(i18n(<font class="stringliteral">"Initializing printing system"</font>) + QString::fromLatin1(<font class="stringliteral">"..."</font>));
00350     CPointers::setPrinter( (m_printer = <font class="keyword">new</font> CPrinter(<font class="keyword">this</font>)) );
00351 }
00352 
<a name="l00354"></a><a class="code" href="class_bible_time.html#a6">00354</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#a6">BibleTime::applyProfileSettings</a>( <a class="code" href="class_c_profile.html">CProfile</a>* p ){
00355     <font class="keywordflow">if</font> (!p)
00356         <font class="keywordflow">return</font>;
00357 
00358     <font class="keywordflow">if</font> (p-&gt;<a class="code" href="class_c_profile.html#a10">fullscreen</a>()) { <font class="comment">//we can set only fullscreen OR geometry</font>
00359         m_windowFullscreen_action-&gt;setChecked( <font class="keyword">true</font> );
00360         <a class="code" href="class_bible_time.html#h17">toggleFullscreen</a>();
00361     }
00362     <font class="keywordflow">else</font> {
00363         setGeometry( p-&gt;<a class="code" href="class_c_profile.html#a12">geometry</a>() );
00364         m_windowFullscreen_action-&gt;setChecked( <font class="keyword">false</font> );
00365         <a class="code" href="class_bible_time.html#h17">toggleFullscreen</a>();     
00366     }
00367 }
00368 
<a name="l00370"></a><a class="code" href="class_bible_time.html#a7">00370</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#a7">BibleTime::storeProfileSettings</a>( <a class="code" href="class_c_profile.html">CProfile</a>* p ){
00371     p-&gt;<a class="code" href="class_c_profile.html#a9">setFullscreen</a>(m_windowFullscreen_action-&gt;isChecked());
00372     p-&gt;<a class="code" href="class_c_profile.html#a11">setGeometry</a>(geometry());
00373 }
</pre></div><hr><address align="right"><small>Generated on Sun May 12 20:27:11 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
