<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>bibletime_slots.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>bibletime_slots.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                          bibletime_slots.cpp  -  description</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Wed Jan 19 2000</font>
00005 <font class="comment">    copyright            : (C) 2000 by The BibleTime Team</font>
00006 <font class="comment">    email                : Info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="comment">//own includes</font>
00019 <font class="preprocessor">#include "bibletime.h"</font>
00020 <font class="preprocessor">#include "resource.h"</font>
00021 <font class="preprocessor">#include "frontend/ctoolclass.h"</font>
00022 <font class="comment">//#include "frontend/ctipwindow.h"</font>
00023 <font class="preprocessor">#include "frontend/cmdiarea.h"</font>
00024 <font class="preprocessor">#include "frontend/cprofilemgr.h"</font>
00025 <font class="preprocessor">#include "frontend/cprofile.h"</font>
00026 <font class="preprocessor">#include "frontend/cprofilewindow.h"</font>
00027 <font class="preprocessor">#include "backend/cswordversekey.h"</font>
00028 <font class="preprocessor">#include "backend/chtmlentrydisplay.h"</font>
00029 <font class="preprocessor">#include "backend/chtmlchapterdisplay.h"</font>
00030 <font class="preprocessor">#include "printing/cprinter.h"</font>
00031 <font class="preprocessor">#include "frontend/chtmldialog.h"</font>
00032 <font class="preprocessor">#include "frontend/presenters/cswordpresenter.h"</font>
00033 <font class="preprocessor">#include "frontend/groupmanager/cgroupmanager.h"</font>
00034 <font class="preprocessor">#include "frontend/coptionsdialog.h"</font>
00035 <font class="preprocessor">#include "frontend/cbtconfig.h"</font>
00036 <font class="preprocessor">#include "config.h"</font>
00037 
00038 <font class="preprocessor">#include &lt;errno.h&gt;</font>
00039 
00040 <font class="comment">//QT includes</font>
00041 <font class="preprocessor">#include &lt;qprogressdialog.h&gt;</font>
00042 <font class="preprocessor">#include &lt;qlistview.h&gt;</font>
00043 <font class="preprocessor">#include &lt;qwhatsthis.h&gt;</font>
00044 <font class="preprocessor">#include &lt;qvaluelist.h&gt;</font>
00045 <font class="preprocessor">#include &lt;qclipboard.h&gt;</font>
00046 <font class="preprocessor">#include &lt;qxembed.h&gt;</font>
00047 
00048 <font class="comment">//KDE includes</font>
00049 <font class="preprocessor">#include &lt;kaction.h&gt;</font>
00050 <font class="preprocessor">#include &lt;kaboutkde.h&gt;</font>
00051 <font class="preprocessor">#include &lt;kaboutdialog.h&gt;</font>
00052 <font class="preprocessor">#include &lt;kbugreport.h&gt;</font>
00053 <font class="preprocessor">#include &lt;kaboutapplication.h&gt;</font>
00054 <font class="preprocessor">#include &lt;kstddirs.h&gt;</font>
00055 <font class="preprocessor">#include &lt;kmenubar.h&gt;</font>
00056 <font class="preprocessor">#include &lt;kaboutdata.h&gt;</font>
00057 <font class="preprocessor">#include &lt;kglobal.h&gt;</font>
00058 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00059 <font class="preprocessor">#include &lt;kedittoolbar.h&gt;</font>
00060 <font class="preprocessor">#include &lt;kpopupmenu.h&gt;</font>
00061 <font class="preprocessor">#include &lt;khelpmenu.h&gt;</font>
00062 <font class="preprocessor">#include &lt;ktip.h&gt;</font>
00063 
00064 <font class="comment">//Sword includes</font>
00065 <font class="preprocessor">#include &lt;versekey.h&gt;</font>
00066 
<a name="l00068"></a><a class="code" href="class_bible_time.html#h0">00068</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h0">BibleTime::slotFileQuit</a>(){
00069     <a class="code" href="class_bible_time.html#a4">saveSettings</a>();     
00070     <font class="comment">// close the first window, the list makes the next one the first again.</font>
00071     <font class="comment">// This ensures that queryClose() is called on each window to ask for closing</font>
00072     
00073     KMainWindow* w;
00074     <font class="keywordtype">bool</font> ok = <font class="keyword">true</font>;
00075     
00076     <font class="keywordflow">if</font>(memberList){
00077         <font class="keywordflow">for</font>(w = memberList-&gt;first(); w &amp;&amp; ok; w = memberList-&gt;first()){
00078             <font class="comment">// only close the window if the closeEvent is accepted. If the user presses Cancel on the saveModified() dialog,</font>
00079             <font class="comment">// the window and the application stay open.</font>
00080             ok = w-&gt;close();
00081         }
00082     }       
00083     <font class="keywordflow">if</font> (ok)
00084         kapp-&gt;quit();
00085 }
00086 
<a name="l00088"></a><a class="code" href="class_bible_time.html#g1">00088</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g1">BibleTime::slotSettingsOptions</a>(){
00089     <a class="code" href="class_c_options_dialog.html">COptionsDialog</a> *dlg = <font class="keyword">new</font> <a class="code" href="class_c_options_dialog.html">COptionsDialog</a>(<font class="keyword">this</font>, <font class="stringliteral">"COptionsDialog"</font>, m_keyAccel);
00090   connect(dlg, SIGNAL(signalSettingsChanged()), SLOT(<a class="code" href="class_bible_time.html#h18">slotSettingsChanged</a>()) );
00091     
00092     dlg-&gt;exec();
00093     dlg-&gt;delayedDestruct();
00094 }
00095 
<a name="l00097"></a><a class="code" href="class_bible_time.html#h18">00097</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h18">BibleTime::slotSettingsChanged</a>(){
00098 
00099     <font class="keyword">const</font> QString language = CBTConfig::get(CBTConfig::language);
00100     m_backend-&gt;<a class="code" href="class_c_sword_backend.html#a10">booknameLanguage</a>(language);      
00101     <font class="comment">//refresh the bookmark items in the groupmanager        </font>
00102     QListViewItemIterator it( m_groupmanager );
00103     <a class="code" href="class_c_group_manager_item.html">CGroupManagerItem</a>* item = 0;
00104     <font class="keywordflow">for</font> ( ; it.current(); ++it ) {
00105         <font class="keywordflow">if</font> ( (item = dynamic_cast&lt;CGroupManagerItem*&gt;(it.current())) ) {
00106             <font class="keywordflow">if</font> (item-&gt;<a class="code" href="class_c_group_manager_item.html#a13">type</a>() == CGroupManagerItem::Bookmark) {
00107                     <a class="code" href="class_c_sword_verse_key.html">CSwordVerseKey</a>* vKey = dynamic_cast&lt;CSwordVerseKey*&gt;(item-&gt;<a class="code" href="class_c_group_manager_item.html#a10">getBookmarkKey</a>());
00108                     <font class="keywordflow">if</font> ( vKey ) {
00109                         vKey-&gt;setLocale( (<font class="keyword">const</font> <font class="keywordtype">char</font>*)m_backend-&gt;<a class="code" href="class_c_sword_backend.html#a10">booknameLanguage</a>().local8Bit());
00110                         item-&gt;<a class="code" href="class_c_group_manager_item.html#a7">update</a>();
00111                     }
00112             }
00113         }
00114     }           
00115 
00116     <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> index = 0; index &lt; m_mdi-&gt;windowList().count(); index++) {
00117         <a class="code" href="class_c_sword_presenter.html">CSwordPresenter</a>* myPresenter = dynamic_cast&lt;CSwordPresenter*&gt;(m_mdi-&gt;windowList().at(index));
00118         <font class="keywordflow">if</font> (myPresenter)
00119             myPresenter-&gt;<a class="code" href="class_c_sword_presenter.html#a2">refresh</a>();
00120     }
00121 
00122     <font class="comment">//refresh the load profile and save profile menus</font>
00123     m_profileMgr.<a class="code" href="class_c_profile_mgr.html#a8">refresh</a>();
00124     KPopupMenu* savePopup = m_windowSaveProfile_action-&gt;popupMenu();        
00125     KPopupMenu* loadPopup = m_windowLoadProfile_action-&gt;popupMenu();
00126     savePopup-&gt;clear();
00127     loadPopup-&gt;clear();
00128     QList&lt;CProfile&gt; profiles = m_profileMgr.<a class="code" href="class_c_profile_mgr.html#a3">profiles</a>();
00129     <font class="keywordflow">for</font> (<a class="code" href="class_c_profile.html">CProfile</a>* p = profiles.first(); p; p = profiles.next()) {
00130         savePopup-&gt;insertItem(p-&gt;<a class="code" href="class_c_profile.html#a5">name</a>());           
00131         loadPopup-&gt;insertItem(p-&gt;<a class="code" href="class_c_profile.html#a5">name</a>());
00132     }
00133 }
00134 
00135 
<a name="l00137"></a><a class="code" href="class_bible_time.html#g0">00137</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g0">BibleTime::slotHelpTipOfDay</a>(){
00138     KTipDialog::setShowOnStart( CBTConfig::get(CBTConfig::tips) );
00139     KTipDialog::showTip(<font class="keyword">this</font>, <font class="stringliteral">"bibletime/tips"</font>, <font class="keyword">true</font>);  
00140 <font class="comment">//  CTipWindow* tipDlg = new CTipWindow();</font>
00141 <font class="comment">//  tipDlg-&gt;exec();</font>
00142 <font class="comment">//  delete tipDlg;  </font>
00143 }
00144 
00145 
<a name="l00147"></a><a class="code" href="class_bible_time.html#h3">00147</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h3">BibleTime::slotWindowMenuAboutToShow</a>(){
00148     <font class="keywordflow">if</font> (!m_windowMenu)
00149         <font class="keywordflow">return</font>;
00150 
00151     <font class="keywordflow">if</font> ( m_windowSaveProfile_action-&gt;isPlugged() )
00152         m_windowSaveProfile_action-&gt;unplug(m_windowMenu);
00153     <font class="keywordflow">if</font> ( m_windowLoadProfile_action-&gt;isPlugged() )
00154         m_windowLoadProfile_action-&gt;unplug(m_windowMenu);
00155     <font class="keywordflow">if</font> ( m_windowEditProfiles_action-&gt;isPlugged() )
00156         m_windowEditProfiles_action-&gt;unplug(m_windowMenu);
00157     <font class="keywordflow">if</font> ( m_windowFullscreen_action-&gt;isPlugged() )
00158         m_windowFullscreen_action-&gt;unplug(m_windowMenu);
00159                 
00160     <font class="keywordflow">if</font> ( <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;isPlugged() )
00161         <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;unplug(m_windowMenu);
00162     <font class="keywordflow">if</font> ( m_windowTile_action-&gt;isPlugged() )
00163         m_windowTile_action-&gt;unplug(m_windowMenu);
00164     <font class="keywordflow">if</font> ( m_windowAutoCascade_action-&gt;isPlugged() )
00165         m_windowAutoCascade_action-&gt;unplug(m_windowMenu);
00166     <font class="keywordflow">if</font> ( m_windowAutoTile_action-&gt;isPlugged() )
00167         m_windowAutoTile_action-&gt;unplug(m_windowMenu);
00168     <font class="keywordflow">if</font> ( m_windowCloseAll_action-&gt;isPlugged() )
00169         m_windowAutoTile_action-&gt;unplug(m_windowMenu);
00170 
00171     m_windowMenu-&gt;clear();
00172             
00173     m_windowSaveProfile_action-&gt;plug(m_windowMenu); 
00174     m_windowLoadProfile_action-&gt;plug(m_windowMenu); 
00175     m_windowEditProfiles_action-&gt;plug(m_windowMenu);    
00176     m_windowMenu-&gt;insertSeparator();    
00177     m_windowFullscreen_action-&gt;plug(m_windowMenu);              
00178     m_windowMenu-&gt;insertSeparator();    
00179     <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;plug(m_windowMenu);
00180     m_windowTile_action-&gt;plug(m_windowMenu);
00181     m_windowAutoCascade_action-&gt;plug(m_windowMenu);
00182     m_windowAutoTile_action-&gt;plug(m_windowMenu);
00183     m_windowCloseAll_action-&gt;plug(m_windowMenu);    
00184     
00185     <font class="keywordflow">if</font> ( m_mdi-&gt;windowList().isEmpty() ) {
00186         <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;setEnabled(<font class="keyword">false</font>);
00187         m_windowTile_action-&gt;setEnabled(<font class="keyword">false</font>);     
00188         m_windowCloseAll_action-&gt;setEnabled(<font class="keyword">false</font>);     
00189     }
00190     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (m_mdi-&gt;windowList().count() == 1) {
00191         m_windowTile_action-&gt;setEnabled( <font class="keyword">false</font> );
00192         <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;setEnabled( <font class="keyword">false</font> );
00193         m_windowCloseAll_action-&gt;setEnabled( <font class="keyword">true</font> );
00194         m_windowMenu-&gt;insertSeparator();
00195     } <font class="keywordflow">else</font> {
00196         m_windowTile_action-&gt;setEnabled( !m_windowAutoTile_action-&gt;isChecked() );
00197         <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;setEnabled( !m_windowAutoCascade_action-&gt;isChecked() );
00198         m_windowCloseAll_action-&gt;setEnabled( <font class="keyword">true</font> );
00199         m_windowMenu-&gt;insertSeparator();        
00200     }
00201     
00202     QWidgetList windows = m_mdi-&gt;windowList();
00203     <font class="keywordtype">int</font> i, id;
00204     <font class="keywordflow">for</font> ( i = 0; i &lt; int(windows.count()); ++i ) {
00205         id = m_windowMenu-&gt;insertItem(QString::fromLatin1(<font class="stringliteral">"&amp;%1 "</font>).arg(i+1)+windows.at(i)-&gt;caption(),
00206             <font class="keyword">this</font>, SLOT( <a class="code" href="class_bible_time.html#h6">slotWindowMenuActivated</a>( <font class="keywordtype">int</font> ) ) );
00207         m_windowMenu-&gt;setItemParameter( id, i );
00208       m_windowMenu-&gt;setItemChecked( id, m_mdi-&gt;activeWindow() == windows.at(i) );
00209     }
00210 }
00211 
<a name="l00213"></a><a class="code" href="class_bible_time.html#h4">00213</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h4">BibleTime::slotAutoTile</a>(){
00214     <font class="keywordflow">if</font> (m_windowAutoTile_action-&gt;isChecked()) {
00215         m_windowAutoCascade_action-&gt;setChecked(<font class="keyword">false</font>);
00216         m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#a4">setGUIOption</a>( CMDIArea::autoTile );
00217     }
00218     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (!m_windowAutoCascade_action-&gt;isChecked())
00219         m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#a4">setGUIOption</a>( CMDIArea::Nothing );
00220 }
00221 
<a name="l00223"></a><a class="code" href="class_bible_time.html#h5">00223</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h5">BibleTime::slotAutoCascade</a>(){
00224     <font class="keywordflow">if</font> (m_windowAutoCascade_action-&gt;isChecked()) {
00225         m_windowAutoTile_action-&gt;setChecked(<font class="keyword">false</font>);
00226         m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#a4">setGUIOption</a>( CMDIArea::autoCascade );
00227     }
00228     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (!m_windowAutoTile_action-&gt;isChecked())
00229         m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#a4">setGUIOption</a>( CMDIArea::Nothing );
00230 }
00231 
<a name="l00232"></a><a class="code" href="class_bible_time.html#h6">00232</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h6">BibleTime::slotWindowMenuActivated</a>( <font class="keywordtype">int</font> id ) {
00233   <font class="keywordflow">if</font> (!m_windowMenu)
00234     <font class="keywordflow">return</font>;
00235     
00236 <font class="comment">//  QString dummy;</font>
00237   QWidget* w = m_mdi-&gt;windowList().at( id );
00238   <font class="keywordflow">if</font> ( w )
00239         w-&gt;setFocus();
00240 }
00241 
00242 
<a name="l00244"></a><a class="code" href="class_bible_time.html#h7">00244</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h7">BibleTime::slotToggleToolbar</a>(){
00245     <font class="keywordflow">if</font> (<a class="code" href="class_bible_time.html#n4">m_viewToolbar_action</a>-&gt;isChecked())
00246         toolBar(<font class="stringliteral">"mainToolBar"</font>)-&gt;show();
00247     <font class="keywordflow">else</font>
00248         toolBar(<font class="stringliteral">"mainToolBar"</font>)-&gt;hide();
00249 }
00250 
<a name="l00252"></a><a class="code" href="class_bible_time.html#h9">00252</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h9">BibleTime::slotToggleGroupManager</a>() {
00253     <font class="keywordflow">if</font> (m_viewGroupManager_action-&gt;isChecked())
00254         m_groupmanager-&gt;show();
00255     <font class="keywordflow">else</font>
00256         m_groupmanager-&gt;hide();
00257 }
00258 
<a name="l00260"></a><a class="code" href="class_bible_time.html#h8">00260</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h8">BibleTime::slotSettingsToolbar</a>(){  
00261     KEditToolbar dlg(actionCollection());
00262     <font class="keywordflow">if</font> (dlg.exec())
00263         createGUI();
00264 }
00265 
<a name="l00267"></a><a class="code" href="class_bible_time.html#g2">00267</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g2">BibleTime::lastWindowClosed</a>(){
00268 }
00269 
00270 
<a name="l00272"></a><a class="code" href="class_bible_time.html#h10">00272</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h10">BibleTime::slotFilePrint</a>(){
00273     m_printer-&gt;setup(<font class="keyword">this</font>); <font class="comment">//opens the printer dialog</font>
00274 }
00275 
<a name="l00277"></a><a class="code" href="class_bible_time.html#h11">00277</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h11">BibleTime::slotSetPrintingStatus</a>(){
00278     <font class="keyword">const</font> <font class="keywordtype">bool</font> enable = (m_printer-&gt;printQueue().count()&gt;0);
00279     m_filePrint_action-&gt;setEnabled( enable );
00280     <a class="code" href="class_bible_time.html#n2">m_fileClearQueue_action</a>-&gt;setEnabled( enable );
00281 }
00282 
<a name="l00284"></a><a class="code" href="class_bible_time.html#i3">00284</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#i3">BibleTime::slotPrintingStarted</a>(){
00285     m_progress = <font class="keyword">new</font> QProgressDialog(i18n(<font class="stringliteral">"Printing..."</font>), i18n(<font class="stringliteral">"Abort printing"</font>),100,<font class="keyword">this</font>, <font class="stringliteral">"progress"</font>, <font class="keyword">true</font>);
00286     connect(m_progress, SIGNAL(cancelled()), SLOT(<a class="code" href="class_bible_time.html#i2">slotAbortPrinting</a>()));
00287     m_progress-&gt;setProgress(0);
00288     m_progress-&gt;setMinimumDuration(0);
00289     m_progress-&gt;show();
00290 }
00291 
<a name="l00293"></a><a class="code" href="class_bible_time.html#i1">00293</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#i1">BibleTime::slotPrintingFinished</a>(){
00294     <font class="keyword">delete</font> m_progress;
00295     m_progress = 0; 
00296 }
00297 
<a name="l00299"></a><a class="code" href="class_bible_time.html#i0">00299</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#i0">BibleTime::slotPrintedPercent</a>( <font class="keyword">const</font> <font class="keywordtype">int</font> percent ){
00300     <font class="keywordflow">if</font> (m_progress)
00301         m_progress-&gt;setProgress(percent);
00302 }
00303 
<a name="l00305"></a><a class="code" href="class_bible_time.html#i2">00305</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#i2">BibleTime::slotAbortPrinting</a>(){
00306     m_printer-&gt;abort();
00307     <font class="keywordflow">if</font> (m_progress)
00308         <a class="code" href="class_bible_time.html#i1">slotPrintingFinished</a>();
00309 }
00310 
<a name="l00311"></a><a class="code" href="class_bible_time.html#g3">00311</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g3">BibleTime::openOnlineHelp_Handbook</a>() {
00312 <font class="comment">//#ifdef STATIC_BUILD</font>
00313 <font class="comment">//  CHTMLDialog dlg("bibletime/handbook/index.html");</font>
00314 <font class="comment">//  dlg.exec();</font>
00315 <font class="comment">//#else</font>
00316     <font class="keywordflow">if</font> (m_helpMenu)
00317 <font class="comment">//      m_helpMenu-&gt;appHelpActivated();</font>
00318         kapp-&gt;invokeHTMLHelp(<font class="stringliteral">"bibletime/handbook/index.html"</font>);
00319 <font class="comment">//#endif</font>
00320 }
<a name="l00321"></a><a class="code" href="class_bible_time.html#g4">00321</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g4">BibleTime::openOnlineHelp_Install</a>() {
00322 <font class="comment">//#ifdef STATIC_BUILD</font>
00323 <font class="comment">//  CHTMLDialog dlg("bibletime/install/index.html");</font>
00324 <font class="comment">//  dlg.exec();</font>
00325 <font class="comment">//#else</font>
00326     kapp-&gt;invokeHTMLHelp(<font class="stringliteral">"bibletime/install/index.html"</font>);
00327 <font class="comment">//#endif</font>
00328 }
<a name="l00329"></a><a class="code" href="class_bible_time.html#g5">00329</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g5">BibleTime::openOnlineHelp_Howto</a>() {
00330 <font class="comment">//#ifdef STATIC_BUILD</font>
00331 <font class="comment">//  CHTMLDialog dlg("bibletime/howto/index.html");</font>
00332 <font class="comment">//  dlg.exec();</font>
00333 <font class="comment">//#else</font>
00334     kapp-&gt;invokeHTMLHelp(<font class="stringliteral">"bibletime/howto/index.html"</font>);
00335 <font class="comment">//#endif</font>
00336 }
00337 
<a name="l00339"></a><a class="code" href="class_bible_time.html#h12">00339</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h12">BibleTime::saveProfile</a>(<font class="keywordtype">int</font> ID){
00340     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">false</font>);
00341     KPopupMenu* popup = m_windowSaveProfile_action-&gt;popupMenu();
00342     <a class="code" href="class_c_profile.html">CProfile</a>* p = m_profileMgr.<a class="code" href="class_c_profile_mgr.html#a6">profile</a>( popup-&gt;text(ID) );
00343     <font class="keywordflow">if</font> (p)
00344         <a class="code" href="class_bible_time.html#h12">saveProfile</a>(p);
00345 
00346     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">true</font>); 
00347 }
00348 
<a name="l00349"></a><a class="code" href="class_bible_time.html#h13">00349</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h12">BibleTime::saveProfile</a>(<a class="code" href="class_c_profile.html">CProfile</a>* profile){
00350     <font class="keywordflow">if</font> (!profile)
00351         <font class="keywordflow">return</font>;
00352 
00353     <font class="comment">//save mainwindow settings</font>
00354     <a class="code" href="class_bible_time.html#a7">storeProfileSettings</a>(profile);
00355             
00356     QWidgetList windows = m_mdi-&gt;windowList();
00357     QList&lt;CProfileWindow&gt; profileWindows;
00358     <font class="keywordflow">for</font> (QWidget* w = windows.first(); w; w = windows.next()) {
00359         <a class="code" href="class_c_sword_presenter.html">CSwordPresenter</a>* displayWindow = dynamic_cast&lt;CSwordPresenter*&gt;(w);
00360         <font class="keywordflow">if</font> (!displayWindow)
00361             <font class="keywordflow">continue</font>;
00362 
00363         <a class="code" href="class_c_profile_window.html">CProfileWindow</a>* profileWindow = <font class="keyword">new</font> <a class="code" href="class_c_profile_window.html">CProfileWindow</a>();
00364         displayWindow-&gt;<a class="code" href="class_c_sword_presenter.html#a5">storeSettings</a>(profileWindow);
00365         profileWindows.append(profileWindow);
00366     }
00367     profile-&gt;<a class="code" href="class_c_profile.html#a2">save</a>(profileWindows);
00368 
00369 <font class="comment">//clean up memory - delete all created profile windows</font>
00370     profileWindows.setAutoDelete(<font class="keyword">true</font>);
00371     profileWindows.clear();
00372 }
00373 
<a name="l00374"></a><a class="code" href="class_bible_time.html#h15">00374</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h15">BibleTime::loadProfile</a>(<font class="keywordtype">int</font> ID){
00375     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">false</font>);
00376     m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#g1">deleteAll</a>();
00377     
00378     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">false</font>);
00379     KPopupMenu* popup = m_windowLoadProfile_action-&gt;popupMenu();
00380     <a class="code" href="class_c_profile.html">CProfile</a>* p = m_profileMgr.<a class="code" href="class_c_profile_mgr.html#a6">profile</a>( popup-&gt;text(ID) );
00381     <font class="keywordflow">if</font> (p)
00382         <a class="code" href="class_bible_time.html#h15">loadProfile</a>(p);
00383 
00384     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">true</font>); 
00385 }
00386 
<a name="l00387"></a><a class="code" href="class_bible_time.html#h16">00387</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h15">BibleTime::loadProfile</a>(<a class="code" href="class_c_profile.html">CProfile</a>* p){
00388     <font class="keywordflow">if</font> (!p)
00389         <font class="keywordflow">return</font>;     
00390     QList&lt;CProfileWindow&gt; windows = p-&gt;<a class="code" href="class_c_profile.html#a4">load</a>();
00391 
00392     <font class="comment">//load mainwindow setttings</font>
00393     <a class="code" href="class_bible_time.html#a6">applyProfileSettings</a>(p);
00394         
00395     <font class="keywordflow">for</font> (<a class="code" href="class_c_profile_window.html">CProfileWindow</a>* w = windows.first(); w; w = windows.next()) {
00396         <font class="keyword">const</font> QString key = w-&gt;<a class="code" href="class_c_profile_window.html#a9">key</a>();       
00397         QStringList usedModules = w-&gt;<a class="code" href="class_c_profile_window.html#a7">modules</a>();
00398         ListCSwordModuleInfo modules;
00399         <font class="keywordflow">for</font> ( QStringList::Iterator it = usedModules.begin(); it != usedModules.end(); ++it ) {
00400             <a class="code" href="class_c_sword_module_info.html">CSwordModuleInfo</a>* m = m_backend-&gt;<a class="code" href="class_c_sword_backend.html#a12">findModuleByName</a>(*it);
00401             <font class="keywordflow">if</font> (m)
00402                 modules.append(m);
00403         }
00404         <font class="keywordflow">if</font> (!modules.count()) <font class="comment">//are the modules still installed?</font>
00405             <font class="keywordflow">continue</font>;
00406         
00407         <a class="code" href="class_c_sword_presenter.html">CSwordPresenter</a>* displayWindow = <a class="code" href="class_bible_time.html#h1">createNewSwordPresenter</a>(modules, key);
00408         <font class="keywordflow">if</font> (displayWindow) {
00409 <font class="comment">//          qDebug("BibleTime::loadProfile: apply settings");</font>
00410             displayWindow-&gt;<a class="code" href="class_c_sword_presenter.html#a6">applySettings</a>(w);
00411         }
00412     }   
00413     
00414     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">true</font>); 
00415 <font class="comment">//  qWarning("finished");</font>
00416 }
00417 
<a name="l00418"></a><a class="code" href="class_bible_time.html#h17">00418</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h17">BibleTime::toggleFullscreen</a>(){
00419     <font class="keywordflow">if</font> (m_windowFullscreen_action-&gt;isChecked())
00420         showFullScreen();
00421     <font class="keywordflow">else</font>
00422         showNormal();
00423 }
00424 
<a name="l00425"></a><a class="code" href="class_bible_time.html#h14">00425</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h14">BibleTime::editProfiles</a>(){
00426     <a class="code" href="class_c_options_dialog.html">COptionsDialog</a> *dlg = <font class="keyword">new</font> <a class="code" href="class_c_options_dialog.html">COptionsDialog</a>(<font class="keyword">this</font>, <font class="stringliteral">"COptionsDialog"</font>, m_keyAccel);
00427   connect(dlg, SIGNAL(signalSettingsChanged()), SLOT(<a class="code" href="class_bible_time.html#h18">slotSettingsChanged</a>()) );
00428     dlg-&gt;<a class="code" href="class_c_options_dialog.html#a1">showPart</a>(COptionsDialog::ViewProfiles);    
00429     dlg-&gt;exec();
00430 
00431     dlg-&gt;delayedDestruct(); 
00432 }
</pre></div><hr><address><small>Generated on Sun Mar 10 22:12:45 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
