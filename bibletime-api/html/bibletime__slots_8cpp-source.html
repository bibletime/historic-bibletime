<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>bibletime_slots.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>bibletime_slots.cpp</h1><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment">                          bibletime_slots.cpp  -  description</font>
00003 <font class="comment">                             -------------------</font>
00004 <font class="comment">    begin                : Wed Jan 19 2000</font>
00005 <font class="comment">    copyright            : (C) 2000 by The BibleTime Team</font>
00006 <font class="comment">    email                : Info@bibletime.de</font>
00007 <font class="comment"> ***************************************************************************/</font>
00008 
00009 <font class="comment">/***************************************************************************</font>
00010 <font class="comment"> *                                                                         *</font>
00011 <font class="comment"> *   This program is free software; you can redistribute it and/or modify  *</font>
00012 <font class="comment"> *   it under the terms of the GNU General Public License as published by  *</font>
00013 <font class="comment"> *   the Free Software Foundation; either version 2 of the License, or     *</font>
00014 <font class="comment"> *   (at your option) any later version.                                   *</font>
00015 <font class="comment"> *                                                                         *</font>
00016 <font class="comment"> ***************************************************************************/</font>
00017 
00018 <font class="comment">//own includes</font>
00019 <font class="preprocessor">#include "bibletime.h"</font>
00020 <font class="preprocessor">#include "resource.h"</font>
00021 <font class="preprocessor">#include "config.h"</font>
00022 
00023 <font class="preprocessor">#include "frontend/ctoolclass.h"</font>
00024 <font class="preprocessor">#include "frontend/cmdiarea.h"</font>
00025 <font class="preprocessor">#include "frontend/cprofilemgr.h"</font>
00026 <font class="preprocessor">#include "frontend/cprofile.h"</font>
00027 <font class="preprocessor">#include "frontend/cprofilewindow.h"</font>
00028 <font class="preprocessor">#include "frontend/chtmldialog.h"</font>
00029 <font class="preprocessor">#include "frontend/displaywindow/cdisplaywindow.h"</font>
00030 <font class="comment">//#include "frontend/presenters/cswordpresenter.h"</font>
00031 <font class="preprocessor">#include "frontend/groupmanager/cgroupmanager.h"</font>
00032 <font class="preprocessor">#include "frontend/coptionsdialog.h"</font>
00033 <font class="preprocessor">#include "frontend/cbtconfig.h"</font>
00034 <font class="preprocessor">#include "backend/cswordversekey.h"</font>
00035 <font class="comment">//#include "backend/chtmlentrydisplay.h"</font>
00036 <font class="comment">//#include "backend/chtmlchapterdisplay.h"</font>
00037 <font class="preprocessor">#include "printing/cprinter.h"</font>
00038 
00039 <font class="preprocessor">#include &lt;errno.h&gt;</font>
00040 
00041 <font class="comment">//QT includes</font>
00042 <font class="preprocessor">#include &lt;qprogressdialog.h&gt;</font>
00043 <font class="preprocessor">#include &lt;qlistview.h&gt;</font>
00044 <font class="preprocessor">#include &lt;qwhatsthis.h&gt;</font>
00045 <font class="preprocessor">#include &lt;qvaluelist.h&gt;</font>
00046 <font class="preprocessor">#include &lt;qclipboard.h&gt;</font>
00047 <font class="preprocessor">#include &lt;qxembed.h&gt;</font>
00048 
00049 <font class="comment">//KDE includes</font>
00050 <font class="preprocessor">#include &lt;kaction.h&gt;</font>
00051 <font class="preprocessor">#include &lt;kapplication.h&gt;</font>
00052 <font class="preprocessor">#include &lt;kaboutkde.h&gt;</font>
00053 <font class="preprocessor">#include &lt;kaboutdialog.h&gt;</font>
00054 <font class="preprocessor">#include &lt;kbugreport.h&gt;</font>
00055 <font class="preprocessor">#include &lt;kaboutapplication.h&gt;</font>
00056 <font class="preprocessor">#include &lt;kstandarddirs.h&gt;</font>
00057 <font class="preprocessor">#include &lt;kmenubar.h&gt;</font>
00058 <font class="preprocessor">#include &lt;kaboutdata.h&gt;</font>
00059 <font class="preprocessor">#include &lt;kglobal.h&gt;</font>
00060 <font class="preprocessor">#include &lt;klocale.h&gt;</font>
00061 <font class="preprocessor">#include &lt;kedittoolbar.h&gt;</font>
00062 <font class="preprocessor">#include &lt;kpopupmenu.h&gt;</font>
00063 <font class="preprocessor">#include &lt;khelpmenu.h&gt;</font>
00064 <font class="preprocessor">#include &lt;ktip.h&gt;</font>
00065 
00066 <font class="comment">//Sword includes</font>
00067 <font class="preprocessor">#include &lt;versekey.h&gt;</font>
00068 
<a name="l00070"></a><a class="code" href="class_bible_time.html#h0">00070</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h0">BibleTime::slotFileQuit</a>(){
00071     <a class="code" href="class_bible_time.html#a4">saveSettings</a>();     
00072     KApplication::kApplication()-&gt;quit();
00073 }
00074 
<a name="l00076"></a><a class="code" href="class_bible_time.html#g1">00076</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g1">BibleTime::slotSettingsOptions</a>(){
00077     <a class="code" href="class_c_options_dialog.html">COptionsDialog</a> *dlg = <font class="keyword">new</font> <a class="code" href="class_c_options_dialog.html">COptionsDialog</a>(<font class="keyword">this</font>, <font class="stringliteral">"COptionsDialog"</font>, m_keyAccel);
00078   connect(dlg, SIGNAL(signalSettingsChanged()), SLOT(<a class="code" href="class_bible_time.html#h18">slotSettingsChanged</a>()) );
00079     
00080     dlg-&gt;exec();
00081     dlg-&gt;delayedDestruct();
00082 }
00083 
<a name="l00085"></a><a class="code" href="class_bible_time.html#h18">00085</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h18">BibleTime::slotSettingsChanged</a>(){
00086 
00087     <font class="keyword">const</font> QString language = CBTConfig::get(CBTConfig::language);
00088     m_backend-&gt;<a class="code" href="class_c_sword_backend.html#a9">booknameLanguage</a>(language);      
00089     <font class="comment">//refresh the bookmark items in the groupmanager        </font>
00090     QListViewItemIterator it( m_groupmanager );
00091     <a class="code" href="class_c_group_manager_item.html">CGroupManagerItem</a>* item = 0;
00092     <font class="keywordflow">for</font> ( ; it.current(); ++it ) {
00093         <font class="keywordflow">if</font> ( (item = dynamic_cast&lt;CGroupManagerItem*&gt;(it.current())) ) {
00094             <font class="keywordflow">if</font> (item-&gt;<a class="code" href="class_c_group_manager_item.html#a13">type</a>() == CGroupManagerItem::Bookmark) {
00095                     <a class="code" href="class_c_sword_verse_key.html">CSwordVerseKey</a>* vKey = dynamic_cast&lt;CSwordVerseKey*&gt;(item-&gt;<a class="code" href="class_c_group_manager_item.html#a10">getBookmarkKey</a>());
00096                     <font class="keywordflow">if</font> ( vKey ) {
00097                         vKey-&gt;setLocale( (<font class="keyword">const</font> <font class="keywordtype">char</font>*)m_backend-&gt;<a class="code" href="class_c_sword_backend.html#a9">booknameLanguage</a>().local8Bit());
00098                         item-&gt;<a class="code" href="class_c_group_manager_item.html#a7">update</a>();
00099                     }
00100             }
00101         }
00102     }           
00103 
00104     <font class="keywordflow">for</font> ( <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> index = 0; index &lt; m_mdi-&gt;windowList().count(); index++) {
00105         <a class="code" href="class_c_display_window.html">CDisplayWindow</a>* displayWindow = dynamic_cast&lt;CDisplayWindow*&gt;(m_mdi-&gt;windowList().at(index));
00106         <font class="keywordflow">if</font> (displayWindow)
00107             displayWindow-&gt;<a class="code" href="class_c_display_window.html#a6">refresh</a>();
00108     }
00109 
00110     <font class="comment">//refresh the load profile and save profile menus</font>
00111     m_profileMgr.<a class="code" href="class_c_profile_mgr.html#a8">refresh</a>();
00112     KPopupMenu* savePopup = m_windowSaveProfile_action-&gt;popupMenu();        
00113     KPopupMenu* loadPopup = m_windowLoadProfile_action-&gt;popupMenu();
00114     savePopup-&gt;clear();
00115     loadPopup-&gt;clear();
00116     QPtrList&lt;CProfile&gt; profiles = m_profileMgr.<a class="code" href="class_c_profile_mgr.html#a3">profiles</a>();
00117     <font class="keywordflow">for</font> (<a class="code" href="class_c_profile.html">CProfile</a>* p = profiles.first(); p; p = profiles.next()) {
00118         savePopup-&gt;insertItem(p-&gt;<a class="code" href="class_c_profile.html#a5">name</a>());           
00119         loadPopup-&gt;insertItem(p-&gt;<a class="code" href="class_c_profile.html#a5">name</a>());
00120     }
00121 }
00122 
00123 
<a name="l00125"></a><a class="code" href="class_bible_time.html#g0">00125</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g0">BibleTime::slotHelpTipOfDay</a>(){
00126     KTipDialog::setShowOnStart( CBTConfig::get(CBTConfig::tips) );
00127     KTipDialog::showTip(<font class="keyword">this</font>, <font class="stringliteral">"bibletime/tips"</font>, <font class="keyword">true</font>);  
00128 <font class="comment">//  CTipWindow* tipDlg = new CTipWindow();</font>
00129 <font class="comment">//  tipDlg-&gt;exec();</font>
00130 <font class="comment">//  delete tipDlg;  </font>
00131 }
00132 
00133 
<a name="l00135"></a><a class="code" href="class_bible_time.html#h3">00135</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h3">BibleTime::slotWindowMenuAboutToShow</a>(){
00136     <font class="keywordflow">if</font> (!m_windowMenu)
00137         <font class="keywordflow">return</font>;
00138 
00139     <font class="keywordflow">if</font> ( m_windowSaveProfile_action-&gt;isPlugged() )
00140         m_windowSaveProfile_action-&gt;unplug(m_windowMenu);
00141     <font class="keywordflow">if</font> ( m_windowLoadProfile_action-&gt;isPlugged() )
00142         m_windowLoadProfile_action-&gt;unplug(m_windowMenu);
00143     <font class="keywordflow">if</font> ( m_windowEditProfiles_action-&gt;isPlugged() )
00144         m_windowEditProfiles_action-&gt;unplug(m_windowMenu);
00145     <font class="keywordflow">if</font> ( m_windowFullscreen_action-&gt;isPlugged() )
00146         m_windowFullscreen_action-&gt;unplug(m_windowMenu);
00147                 
00148     <font class="keywordflow">if</font> ( <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;isPlugged() )
00149         <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;unplug(m_windowMenu);
00150     <font class="keywordflow">if</font> ( m_windowTile_action-&gt;isPlugged() )
00151         m_windowTile_action-&gt;unplug(m_windowMenu);
00152     <font class="keywordflow">if</font> ( m_windowAutoCascade_action-&gt;isPlugged() )
00153         m_windowAutoCascade_action-&gt;unplug(m_windowMenu);
00154     <font class="keywordflow">if</font> ( m_windowAutoTile_action-&gt;isPlugged() )
00155         m_windowAutoTile_action-&gt;unplug(m_windowMenu);
00156     <font class="keywordflow">if</font> ( m_windowCloseAll_action-&gt;isPlugged() )
00157         m_windowAutoTile_action-&gt;unplug(m_windowMenu);
00158 
00159     m_windowMenu-&gt;clear();
00160             
00161     m_windowSaveProfile_action-&gt;plug(m_windowMenu); 
00162     m_windowLoadProfile_action-&gt;plug(m_windowMenu); 
00163     m_windowEditProfiles_action-&gt;plug(m_windowMenu);    
00164     m_windowMenu-&gt;insertSeparator();    
00165     m_windowFullscreen_action-&gt;plug(m_windowMenu);              
00166     m_windowMenu-&gt;insertSeparator();    
00167     <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;plug(m_windowMenu);
00168     m_windowTile_action-&gt;plug(m_windowMenu);
00169     m_windowAutoCascade_action-&gt;plug(m_windowMenu);
00170     m_windowAutoTile_action-&gt;plug(m_windowMenu);
00171     m_windowCloseAll_action-&gt;plug(m_windowMenu);    
00172     
00173     <font class="keywordflow">if</font> ( m_mdi-&gt;windowList().isEmpty() ) {
00174         <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;setEnabled(<font class="keyword">false</font>);
00175         m_windowTile_action-&gt;setEnabled(<font class="keyword">false</font>);     
00176         m_windowCloseAll_action-&gt;setEnabled(<font class="keyword">false</font>);     
00177     }
00178     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (m_mdi-&gt;windowList().count() == 1) {
00179         m_windowTile_action-&gt;setEnabled( <font class="keyword">false</font> );
00180         <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;setEnabled( <font class="keyword">false</font> );
00181         m_windowCloseAll_action-&gt;setEnabled( <font class="keyword">true</font> );
00182         m_windowMenu-&gt;insertSeparator();
00183     } <font class="keywordflow">else</font> {
00184         m_windowTile_action-&gt;setEnabled( !m_windowAutoTile_action-&gt;isChecked() );
00185         <a class="code" href="class_bible_time.html#n6">m_windowCascade_action</a>-&gt;setEnabled( !m_windowAutoCascade_action-&gt;isChecked() );
00186         m_windowCloseAll_action-&gt;setEnabled( <font class="keyword">true</font> );
00187         m_windowMenu-&gt;insertSeparator();        
00188     }
00189     
00190     QWidgetList windows = m_mdi-&gt;windowList();
00191     <font class="keywordtype">int</font> i, id;
00192     <font class="keywordflow">for</font> ( i = 0; i &lt; int(windows.count()); ++i ) {
00193         id = m_windowMenu-&gt;insertItem(QString::fromLatin1(<font class="stringliteral">"&amp;%1 "</font>).arg(i+1)+windows.at(i)-&gt;caption(),
00194             <font class="keyword">this</font>, SLOT( <a class="code" href="class_bible_time.html#h6">slotWindowMenuActivated</a>( <font class="keywordtype">int</font> ) ) );
00195         m_windowMenu-&gt;setItemParameter( id, i );
00196       m_windowMenu-&gt;setItemChecked( id, m_mdi-&gt;activeWindow() == windows.at(i) );
00197     }
00198 }
00199 
<a name="l00201"></a><a class="code" href="class_bible_time.html#h4">00201</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h4">BibleTime::slotAutoTile</a>(){
00202     <font class="keywordflow">if</font> (m_windowAutoTile_action-&gt;isChecked()) {
00203         m_windowAutoCascade_action-&gt;setChecked(<font class="keyword">false</font>);
00204         m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#a4">setGUIOption</a>( CMDIArea::autoTile );
00205     }
00206     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (!m_windowAutoCascade_action-&gt;isChecked())
00207         m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#a4">setGUIOption</a>( CMDIArea::Nothing );
00208 }
00209 
<a name="l00211"></a><a class="code" href="class_bible_time.html#h5">00211</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h5">BibleTime::slotAutoCascade</a>(){
00212     <font class="keywordflow">if</font> (m_windowAutoCascade_action-&gt;isChecked()) {
00213         m_windowAutoTile_action-&gt;setChecked(<font class="keyword">false</font>);
00214         m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#a4">setGUIOption</a>( CMDIArea::autoCascade );
00215     }
00216     <font class="keywordflow">else</font> <font class="keywordflow">if</font> (!m_windowAutoTile_action-&gt;isChecked())
00217         m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#a4">setGUIOption</a>( CMDIArea::Nothing );
00218 }
00219 
<a name="l00220"></a><a class="code" href="class_bible_time.html#h6">00220</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h6">BibleTime::slotWindowMenuActivated</a>( <font class="keywordtype">int</font> id ) {
00221   <font class="keywordflow">if</font> (!m_windowMenu)
00222     <font class="keywordflow">return</font>;
00223     
00224 <font class="comment">//  QString dummy;</font>
00225   QWidget* w = m_mdi-&gt;windowList().at( id );
00226   <font class="keywordflow">if</font> ( w )
00227         w-&gt;setFocus();
00228 }
00229 
00230 
<a name="l00232"></a><a class="code" href="class_bible_time.html#h7">00232</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h7">BibleTime::slotToggleToolbar</a>(){
00233     <font class="keywordflow">if</font> (<a class="code" href="class_bible_time.html#n4">m_viewToolbar_action</a>-&gt;isChecked())
00234         toolBar(<font class="stringliteral">"mainToolBar"</font>)-&gt;show();
00235     <font class="keywordflow">else</font>
00236         toolBar(<font class="stringliteral">"mainToolBar"</font>)-&gt;hide();
00237 }
00238 
<a name="l00240"></a><a class="code" href="class_bible_time.html#h9">00240</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h9">BibleTime::slotToggleGroupManager</a>() {
00241     <font class="keywordflow">if</font> (m_viewGroupManager_action-&gt;isChecked())
00242         m_groupmanager-&gt;show();
00243     <font class="keywordflow">else</font>
00244         m_groupmanager-&gt;hide();
00245 }
00246 
<a name="l00248"></a><a class="code" href="class_bible_time.html#h8">00248</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h8">BibleTime::slotSettingsToolbar</a>(){  
00249     KEditToolbar dlg(actionCollection());
00250     <font class="keywordflow">if</font> (dlg.exec())
00251         createGUI();
00252 }
00253 
<a name="l00255"></a><a class="code" href="class_bible_time.html#g2">00255</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g2">BibleTime::lastWindowClosed</a>(){
00256 }
00257 
00258 
<a name="l00260"></a><a class="code" href="class_bible_time.html#h10">00260</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h10">BibleTime::slotFilePrint</a>(){
00261     m_printer-&gt;setup(<font class="keyword">this</font>); <font class="comment">//opens the printer dialog</font>
00262 }
00263 
<a name="l00265"></a><a class="code" href="class_bible_time.html#h11">00265</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h11">BibleTime::slotSetPrintingStatus</a>(){
00266     <font class="keyword">const</font> <font class="keywordtype">bool</font> enable = (m_printer-&gt;printQueue().count()&gt;0);
00267     m_filePrint_action-&gt;setEnabled( enable );
00268     <a class="code" href="class_bible_time.html#n2">m_fileClearQueue_action</a>-&gt;setEnabled( enable );
00269 }
00270 
<a name="l00272"></a><a class="code" href="class_bible_time.html#i3">00272</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#i3">BibleTime::slotPrintingStarted</a>(){
00273     m_progress = <font class="keyword">new</font> QProgressDialog(i18n(<font class="stringliteral">"Printing..."</font>), i18n(<font class="stringliteral">"Abort printing"</font>),100,<font class="keyword">this</font>, <font class="stringliteral">"progress"</font>, <font class="keyword">true</font>);
00274     connect(m_progress, SIGNAL(cancelled()), SLOT(<a class="code" href="class_bible_time.html#i2">slotAbortPrinting</a>()));
00275     m_progress-&gt;setProgress(0);
00276     m_progress-&gt;setMinimumDuration(0);
00277     m_progress-&gt;show();
00278 }
00279 
<a name="l00281"></a><a class="code" href="class_bible_time.html#i1">00281</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#i1">BibleTime::slotPrintingFinished</a>(){
00282     <font class="keyword">delete</font> m_progress;
00283     m_progress = 0; 
00284 }
00285 
<a name="l00287"></a><a class="code" href="class_bible_time.html#i0">00287</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#i0">BibleTime::slotPrintedPercent</a>( <font class="keyword">const</font> <font class="keywordtype">int</font> percent ){
00288     <font class="keywordflow">if</font> (m_progress)
00289         m_progress-&gt;setProgress(percent);
00290 }
00291 
<a name="l00293"></a><a class="code" href="class_bible_time.html#i2">00293</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#i2">BibleTime::slotAbortPrinting</a>(){
00294     m_printer-&gt;abort();
00295     <font class="keywordflow">if</font> (m_progress)
00296         <a class="code" href="class_bible_time.html#i1">slotPrintingFinished</a>();
00297 }
00298 
<a name="l00299"></a><a class="code" href="class_bible_time.html#g3">00299</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g3">BibleTime::openOnlineHelp_Handbook</a>() {
00300 <font class="comment">//#ifdef STATIC_BUILD</font>
00301 <font class="comment">//  CHTMLDialog dlg("bibletime/handbook/index.html");</font>
00302 <font class="comment">//  dlg.exec();</font>
00303 <font class="comment">//#else</font>
00304     <font class="keywordflow">if</font> (m_helpMenu)
00305 <font class="comment">//      m_helpMenu-&gt;appHelpActivated();</font>
00306         kapp-&gt;invokeHTMLHelp(<font class="stringliteral">"bibletime/handbook/index.html"</font>);
00307 <font class="comment">//#endif</font>
00308 }
<a name="l00309"></a><a class="code" href="class_bible_time.html#g4">00309</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g4">BibleTime::openOnlineHelp_Install</a>() {
00310 <font class="comment">//#ifdef STATIC_BUILD</font>
00311 <font class="comment">//  CHTMLDialog dlg("bibletime/install/index.html");</font>
00312 <font class="comment">//  dlg.exec();</font>
00313 <font class="comment">//#else</font>
00314     kapp-&gt;invokeHTMLHelp(<font class="stringliteral">"bibletime/install/index.html"</font>);
00315 <font class="comment">//#endif</font>
00316 }
<a name="l00317"></a><a class="code" href="class_bible_time.html#g5">00317</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#g5">BibleTime::openOnlineHelp_Howto</a>() {
00318 <font class="comment">//#ifdef STATIC_BUILD</font>
00319 <font class="comment">//  CHTMLDialog dlg("bibletime/howto/index.html");</font>
00320 <font class="comment">//  dlg.exec();</font>
00321 <font class="comment">//#else</font>
00322     kapp-&gt;invokeHTMLHelp(<font class="stringliteral">"bibletime/howto/index.html"</font>);
00323 <font class="comment">//#endif</font>
00324 }
00325 
<a name="l00327"></a><a class="code" href="class_bible_time.html#h12">00327</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h12">BibleTime::saveProfile</a>(<font class="keywordtype">int</font> ID){
00328     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">false</font>);
00329     KPopupMenu* popup = m_windowSaveProfile_action-&gt;popupMenu();
00330     <a class="code" href="class_c_profile.html">CProfile</a>* p = m_profileMgr.<a class="code" href="class_c_profile_mgr.html#a6">profile</a>( popup-&gt;text(ID) );
00331     <font class="keywordflow">if</font> (p)
00332         <a class="code" href="class_bible_time.html#h12">saveProfile</a>(p);
00333 
00334     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">true</font>); 
00335 }
00336 
<a name="l00337"></a><a class="code" href="class_bible_time.html#h13">00337</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h12">BibleTime::saveProfile</a>(<a class="code" href="class_c_profile.html">CProfile</a>* profile){
00338     <font class="keywordflow">if</font> (!profile)
00339         <font class="keywordflow">return</font>;
00340 
00341     <font class="comment">//save mainwindow settings</font>
00342     <a class="code" href="class_bible_time.html#a7">storeProfileSettings</a>(profile);
00343             
00344     QWidgetList windows = m_mdi-&gt;windowList();
00345     QPtrList&lt;CProfileWindow&gt; profileWindows;
00346     <font class="keywordflow">for</font> (QWidget* w = windows.first(); w; w = windows.next()) {
00347         <a class="code" href="class_c_display_window.html">CDisplayWindow</a>* displayWindow = dynamic_cast&lt;CDisplayWindow*&gt;(w);
00348         <font class="keywordflow">if</font> (!displayWindow)
00349             <font class="keywordflow">continue</font>;
00350 
00351         <a class="code" href="class_c_profile_window.html">CProfileWindow</a>* profileWindow = <font class="keyword">new</font> <a class="code" href="class_c_profile_window.html">CProfileWindow</a>();
00352         displayWindow-&gt;<a class="code" href="class_c_display_window.html#a3">storeProfileSettings</a>(profileWindow);
00353         profileWindows.append(profileWindow);
00354     }
00355     profile-&gt;<a class="code" href="class_c_profile.html#a2">save</a>(profileWindows);
00356 
00357 <font class="comment">//clean up memory - delete all created profile windows</font>
00358     profileWindows.setAutoDelete(<font class="keyword">true</font>);
00359     profileWindows.clear();
00360 }
00361 
<a name="l00362"></a><a class="code" href="class_bible_time.html#h15">00362</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h15">BibleTime::loadProfile</a>(<font class="keywordtype">int</font> ID){
00363     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">false</font>);
00364     m_mdi-&gt;<a class="code" href="class_c_m_d_i_area.html#g1">deleteAll</a>();
00365     
00366     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">false</font>);
00367     KPopupMenu* popup = m_windowLoadProfile_action-&gt;popupMenu();
00368     <a class="code" href="class_c_profile.html">CProfile</a>* p = m_profileMgr.<a class="code" href="class_c_profile_mgr.html#a6">profile</a>( popup-&gt;text(ID) );
00369     <font class="keywordflow">if</font> (p)
00370         <a class="code" href="class_bible_time.html#h15">loadProfile</a>(p);
00371 
00372     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">true</font>); 
00373 }
00374 
<a name="l00375"></a><a class="code" href="class_bible_time.html#h16">00375</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h15">BibleTime::loadProfile</a>(<a class="code" href="class_c_profile.html">CProfile</a>* p){
00376     <font class="keywordflow">if</font> (!p)
00377         <font class="keywordflow">return</font>;     
00378     QPtrList&lt;CProfileWindow&gt; windows = p-&gt;<a class="code" href="class_c_profile.html#a4">load</a>();
00379 
00380     <font class="comment">//load mainwindow setttings</font>
00381     <a class="code" href="class_bible_time.html#a6">applyProfileSettings</a>(p);
00382         
00383     <font class="keywordflow">for</font> (<a class="code" href="class_c_profile_window.html">CProfileWindow</a>* w = windows.first(); w; w = windows.next()) {
00384         <font class="keyword">const</font> QString key = w-&gt;<a class="code" href="class_c_profile_window.html#a9">key</a>();       
00385         QStringList usedModules = w-&gt;<a class="code" href="class_c_profile_window.html#a7">modules</a>();
00386         ListCSwordModuleInfo modules;
00387         <font class="keywordflow">for</font> ( QStringList::Iterator it = usedModules.begin(); it != usedModules.end(); ++it ) {
00388             <a class="code" href="class_c_sword_module_info.html">CSwordModuleInfo</a>* m = m_backend-&gt;<a class="code" href="class_c_sword_backend.html#a11">findModuleByName</a>(*it);
00389             <font class="keywordflow">if</font> (m)
00390                 modules.append(m);
00391         }
00392         <font class="keywordflow">if</font> (!modules.count()) <font class="comment">//are the modules still installed?</font>
00393             <font class="keywordflow">continue</font>;       
00394         
00395         <font class="keywordflow">if</font> (<a class="code" href="class_c_display_window.html">CDisplayWindow</a>* displayWindow = <a class="code" href="class_bible_time.html#h1">createDisplayWindow</a>(modules, key)) {
00396             displayWindow-&gt;<a class="code" href="class_c_display_window.html#a4">applyProfileSettings</a>(w);
00397         }
00398     }   
00399     
00400     m_mdi-&gt;setUpdatesEnabled(<font class="keyword">true</font>); 
00401 }
00402 
<a name="l00403"></a><a class="code" href="class_bible_time.html#h17">00403</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h17">BibleTime::toggleFullscreen</a>(){
00404     <font class="keywordflow">if</font> (m_windowFullscreen_action-&gt;isChecked())
00405         showFullScreen();
00406     <font class="keywordflow">else</font>
00407         showNormal();
00408 }
00409 
<a name="l00410"></a><a class="code" href="class_bible_time.html#h14">00410</a> <font class="keywordtype">void</font> <a class="code" href="class_bible_time.html#h14">BibleTime::editProfiles</a>(){
00411     <a class="code" href="class_c_options_dialog.html">COptionsDialog</a> *dlg = <font class="keyword">new</font> <a class="code" href="class_c_options_dialog.html">COptionsDialog</a>(<font class="keyword">this</font>, <font class="stringliteral">"COptionsDialog"</font>, m_keyAccel);
00412   connect(dlg, SIGNAL(signalSettingsChanged()), SLOT(<a class="code" href="class_bible_time.html#h18">slotSettingsChanged</a>()) );
00413     dlg-&gt;<a class="code" href="class_c_options_dialog.html#a1">showPart</a>(COptionsDialog::ViewProfiles);    
00414     dlg-&gt;exec();
00415 
00416     dlg-&gt;delayedDestruct(); 
00417 }
</pre></div><hr><address align="right"><small>Generated on Tue Jul 16 13:53:08 2002 for BibleTime by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
